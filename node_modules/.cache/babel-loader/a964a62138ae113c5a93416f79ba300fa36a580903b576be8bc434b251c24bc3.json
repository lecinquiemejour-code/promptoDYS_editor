{"ast":null,"code":"// Utilitaires pour le collapse des donnÃ©es Base64\n/**\n * DÃ©tecte et extrait les donnÃ©es Base64 dans le contenu\n * @param {string} content - Contenu Ã  analyser\n * @returns {Array} - Tableau d'objets {index, match, start, end, type, size}\n */export const detectBase64=content=>{const base64Regex=/data:image\\/([^;]+);base64,([A-Za-z0-9+/=]{100,})/g;const matches=[];let match;let index=0;while((match=base64Regex.exec(content))!==null){const[fullMatch,imageType,base64Data]=match;matches.push({index:index++,match:fullMatch,start:match.index,end:match.index+fullMatch.length,type:imageType,size:base64Data.length,base64Data});}return matches;};/**\n * GÃ©nÃ¨re la version collapsÃ©e d'une donnÃ©e Base64\n * @param {Object} base64Info - Information sur la donnÃ©e Base64\n * @param {boolean} isExpanded - Ã‰tat d'expansion\n * @returns {string} - Version collapsÃ©e ou complÃ¨te\n */export const generateCollapsedBase64=function(base64Info){let isExpanded=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(isExpanded){return base64Info.match;}const preview=base64Info.base64Data.substring(0,50);return\"data:image/\".concat(base64Info.type,\";base64,\").concat(preview,\"[...\").concat(base64Info.size,\" caract\\xE8res...] \\uD83D\\uDC41\\uFE0F Voir\");};/**\n * Applique le collapse Ã  tout le contenu\n * @param {string} content - Contenu original\n * @param {Object} expandedStates - Ã‰tats d'expansion {index: boolean}\n * @returns {string} - Contenu avec base64 collapsÃ©s\n */export const applyBase64Collapse=function(content){let expandedStates=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const base64Matches=detectBase64(content);if(base64Matches.length===0){return content;}// Traiter les matches de la fin vers le dÃ©but pour prÃ©server les indices\nlet result=content;for(let i=base64Matches.length-1;i>=0;i--){const base64Info=base64Matches[i];const isExpanded=expandedStates[base64Info.index]||false;const replacement=generateCollapsedBase64(base64Info,isExpanded);result=result.substring(0,base64Info.start)+replacement+result.substring(base64Info.end);}return result;};/**\n * Extrait l'index du Base64 Ã  partir du texte cliquÃ©\n * @param {string} text - Texte contenant potentiellement un marqueur de Base64\n * @returns {number|null} - Index du Base64 ou null\n */export const extractBase64Index=text=>{// Recherche dans le contexte proche du clic\nconst base64Pattern=/data:image\\/[^;]+;base64,[A-Za-z0-9+/]{0,50}\\[\\.\\.\\.(\\d+) caractÃ¨res\\.\\.\\.\\] ðŸ‘ï¸ Voir/;const matches=detectBase64(text);// Pour l'instant, on retourne l'index basÃ© sur l'ordre d'apparition\n// Cette logique peut Ãªtre amÃ©liorÃ©e selon les besoins\nreturn matches.length>0?0:null;};","map":{"version":3,"names":["detectBase64","content","base64Regex","matches","match","index","exec","fullMatch","imageType","base64Data","push","start","end","length","type","size","generateCollapsedBase64","base64Info","isExpanded","arguments","undefined","preview","substring","concat","applyBase64Collapse","expandedStates","base64Matches","result","i","replacement","extractBase64Index","text","base64Pattern"],"sources":["C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/src/utils/base64Collapse.js"],"sourcesContent":["// Utilitaires pour le collapse des donnÃ©es Base64\n\n/**\n * DÃ©tecte et extrait les donnÃ©es Base64 dans le contenu\n * @param {string} content - Contenu Ã  analyser\n * @returns {Array} - Tableau d'objets {index, match, start, end, type, size}\n */\nexport const detectBase64 = (content) => {\n  const base64Regex = /data:image\\/([^;]+);base64,([A-Za-z0-9+/=]{100,})/g;\n  const matches = [];\n  let match;\n  let index = 0;\n\n  while ((match = base64Regex.exec(content)) !== null) {\n    const [fullMatch, imageType, base64Data] = match;\n    matches.push({\n      index: index++,\n      match: fullMatch,\n      start: match.index,\n      end: match.index + fullMatch.length,\n      type: imageType,\n      size: base64Data.length,\n      base64Data\n    });\n  }\n\n  return matches;\n};\n\n/**\n * GÃ©nÃ¨re la version collapsÃ©e d'une donnÃ©e Base64\n * @param {Object} base64Info - Information sur la donnÃ©e Base64\n * @param {boolean} isExpanded - Ã‰tat d'expansion\n * @returns {string} - Version collapsÃ©e ou complÃ¨te\n */\nexport const generateCollapsedBase64 = (base64Info, isExpanded = false) => {\n  if (isExpanded) {\n    return base64Info.match;\n  }\n\n  const preview = base64Info.base64Data.substring(0, 50);\n  return `data:image/${base64Info.type};base64,${preview}[...${base64Info.size} caractÃ¨res...] ðŸ‘ï¸ Voir`;\n};\n\n/**\n * Applique le collapse Ã  tout le contenu\n * @param {string} content - Contenu original\n * @param {Object} expandedStates - Ã‰tats d'expansion {index: boolean}\n * @returns {string} - Contenu avec base64 collapsÃ©s\n */\nexport const applyBase64Collapse = (content, expandedStates = {}) => {\n  const base64Matches = detectBase64(content);\n  \n  if (base64Matches.length === 0) {\n    return content;\n  }\n\n  // Traiter les matches de la fin vers le dÃ©but pour prÃ©server les indices\n  let result = content;\n  for (let i = base64Matches.length - 1; i >= 0; i--) {\n    const base64Info = base64Matches[i];\n    const isExpanded = expandedStates[base64Info.index] || false;\n    const replacement = generateCollapsedBase64(base64Info, isExpanded);\n    \n    result = result.substring(0, base64Info.start) + \n             replacement + \n             result.substring(base64Info.end);\n  }\n\n  return result;\n};\n\n/**\n * Extrait l'index du Base64 Ã  partir du texte cliquÃ©\n * @param {string} text - Texte contenant potentiellement un marqueur de Base64\n * @returns {number|null} - Index du Base64 ou null\n */\nexport const extractBase64Index = (text) => {\n  // Recherche dans le contexte proche du clic\n  const base64Pattern = /data:image\\/[^;]+;base64,[A-Za-z0-9+/]{0,50}\\[\\.\\.\\.(\\d+) caractÃ¨res\\.\\.\\.\\] ðŸ‘ï¸ Voir/;\n  const matches = detectBase64(text);\n  \n  // Pour l'instant, on retourne l'index basÃ© sur l'ordre d'apparition\n  // Cette logique peut Ãªtre amÃ©liorÃ©e selon les besoins\n  return matches.length > 0 ? 0 : null;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}