{"ast":null,"code":"import _objectSpread from\"C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useState}from'react';import EditorContext from'../contexts/EditorContext';import{markdownToHtml,htmlToMarkdown}from'../utils/markdownConverter';import{useImageStorage}from'../hooks/useImageStorage';// Removed PromptoDYS imports - using simplified project management\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Toolbar=()=>{const{content,editorRef,currentFormat,onFormatChange,onViewModeChange,viewMode,changeViewMode,onThemeSettingsToggle,onContentChange,ignoreSelectionChangeRef}=useContext(EditorContext);// Hook pour g√©rer le stockage d'images dans IndexedDB\nconst{storeImage,convertBlobUrlsToIndexed,loadImage}=useImageStorage();// √âtats pour la modal de sauvegarde\nconst[showSaveModal,setShowSaveModal]=useState(false);const[projectName,setProjectName]=useState('MonProjet');const[isSaving,setIsSaving]=useState(false);// V√©rifier le support File System Access API\nconst isFileSystemAccessSupported=()=>{return'showDirectoryPicker'in window&&'showOpenFilePicker'in window;};// Fonctions pour les fichiers Markdown\nconst handleCopyMarkdown=async()=>{const editor=document.querySelector('.editor-scroll .prose');if(!editor)return;const markdown=htmlToMarkdown(content);try{await navigator.clipboard.writeText(markdown);console.log('Markdown copi√© dans le presse-papier');}catch(err){console.error('Erreur lors de la copie:',err);}};// G√©n√©rer un nom de fichier unique avec timestamp\nconst generateImageFileName=(originalName,extension)=>{const now=new Date();const timestamp=now.getFullYear().toString()+String(now.getMonth()+1).padStart(2,'0')+String(now.getDate()).padStart(2,'0')+'_'+String(now.getHours()).padStart(2,'0')+String(now.getMinutes()).padStart(2,'0')+String(now.getSeconds()).padStart(2,'0');const baseName=originalName.replace(/\\.[^/.]+$/,\"\")||'image';return\"\".concat(baseName,\"_\").concat(timestamp,\".\").concat(extension);};// Extraire et sauvegarder les images blob\nconst extractAndSaveImages=async(htmlContent,projectDir)=>{console.log('üîç extractAndSaveImages appel√©e avec HTML:',htmlContent.substring(0,200)+'...');// Parser le HTML avec DOMParser\nconst parser=new DOMParser();const doc=parser.parseFromString(htmlContent,'text/html');// Trouver toutes les images avec src blob: ou indexed://\nconst images=doc.querySelectorAll('img[src^=\"blob:\"], img[src^=\"indexed://\"]');console.log('üîç Nombre d\\'images trouv√©es:',images.length);images.forEach((img,i)=>{console.log(\"\\uD83D\\uDD0D Image \".concat(i+1,\":\"),img.src,'|',img.alt);});if(images.length===0){console.log('‚ùå Aucune image trouv√©e - HTML:',htmlContent);return htmlContent;// Pas d'images √† traiter\n}// Cr√©er le dossier images\nconst imagesDir=await projectDir.getDirectoryHandle('images',{create:true});// D√©duplication : tracker les URLs d√©j√† trait√©es\nconst processedUrls=new Set();const urlToFileName=new Map();for(const img of images){const imageUrl=img.src;const altText=img.alt||'image';// V√©rifier si cette URL a d√©j√† √©t√© trait√©e\nif(processedUrls.has(imageUrl)){// R√©utiliser le nom de fichier existant\nconst existingFileName=urlToFileName.get(imageUrl);img.src=\"./images/\".concat(existingFileName);console.log('‚ôªÔ∏è Image dupliqu√©e r√©utilis√©e:',existingFileName);continue;}try{var _imageData;let blob;let extension='jpg';let imageData=null;// D√©claration de la variable dans la port√©e appropri√©e\nif(imageUrl.startsWith('blob:')){// R√©cup√©rer l'image depuis l'URL blob\nconst response=await fetch(imageUrl);blob=await response.blob();extension=blob.type.split('/')[1]||'jpg';}else if(imageUrl.startsWith('indexed://')){// R√©cup√©rer l'image depuis IndexedDB\nconst imageId=imageUrl.replace('indexed://','');imageData=await loadImage(imageId);if(!imageData){console.error('‚ùå Image IndexedDB non trouv√©e:',imageId);continue;}// Fetch le blob depuis la blobUrl retourn√©e par loadImage\nconst response=await fetch(imageData.blobUrl);blob=await response.blob();// Extraire l'extension depuis le nom de fichier original\nextension=imageData.fileName?imageData.fileName.split('.').pop().toLowerCase():'jpg';}if(!blob){console.error('‚ùå Impossible de r√©cup√©rer l\\'image:',imageUrl);continue;}// Utiliser le nom original de l'image depuis IndexedDB si disponible\nconst originalName=((_imageData=imageData)===null||_imageData===void 0?void 0:_imageData.fileName)||altText||'image';const fileName=generateImageFileName(originalName,extension);// Sauvegarder l'image\nconst imageHandle=await imagesDir.getFileHandle(fileName,{create:true});const writable=await imageHandle.createWritable();await writable.write(blob);await writable.close();// Marquer cette URL comme trait√©e et stocker le nom de fichier\nprocessedUrls.add(imageUrl);urlToFileName.set(imageUrl,fileName);// Remplacer le src dans l'√©l√©ment DOM\nconst relativePath=\"./images/\".concat(fileName);img.src=relativePath;console.log('‚úÖ Image sauvegard√©e:',fileName);}catch(imageError){console.error('‚ùå Erreur sauvegarde image:',imageError);}}// Retourner le HTML modifi√© depuis le DOM\nreturn doc.body.innerHTML;};// Trouver un nom de dossier disponible (gestion des collisions)\nconst findAvailableDirectoryName=async(parentDir,baseName)=>{let finalName=baseName;let counter=1;while(true){try{// Tenter d'acc√©der au dossier (si √ßa marche, il existe d√©j√†)\nawait parentDir.getDirectoryHandle(finalName);// Le dossier existe, essayer le suivant\nfinalName=\"\".concat(baseName,\" (\").concat(counter,\")\");counter++;}catch(error){// Le dossier n'existe pas, on peut l'utiliser\nbreak;}}return finalName;};// Fonction pour ouvrir la modal de sauvegarde\nconst handleSaveMarkdown=async()=>{console.log('üî• DEBUG: handleSaveMarkdown appel√©e');if(!isFileSystemAccessSupported()){console.log('‚ùå DEBUG: File System Access API non support√©e');alert('‚ùå Votre navigateur ne supporte pas l\\'acc√®s aux fichiers.');return;}console.log('‚úÖ DEBUG: File System Access API support√©e');// Ouvrir la modal pour demander le nom du projet\nsetShowSaveModal(true);};// Fonction pour effectuer la sauvegarde avec le nom choisi\nconst performSave=async chosenProjectName=>{setIsSaving(true);try{var _editorRef$current;const htmlContent=((_editorRef$current=editorRef.current)===null||_editorRef$current===void 0?void 0:_editorRef$current.innerHTML)||content;console.log('üìù DEBUG: htmlContent r√©cup√©r√©:',htmlContent===null||htmlContent===void 0?void 0:htmlContent.length,'caract√®res');console.log('üìù DEBUG: projectName choisi:',chosenProjectName);// S√©lectionner le r√©pertoire parent\nconst parentDirectoryHandle=await window.showDirectoryPicker({mode:'readwrite'});// Trouver un nom de dossier disponible (√©viter les collisions)\nconst availableProjectName=await findAvailableDirectoryName(parentDirectoryHandle,chosenProjectName.trim());// Cr√©er le dossier du projet avec le nom disponible\nconst projectDir=await parentDirectoryHandle.getDirectoryHandle(availableProjectName,{create:true});// Convertir les blob URLs vers indexed:// URLs pour pr√©server les images IndexedDB\nconst htmlWithIndexedUrls=convertBlobUrlsToIndexed(htmlContent);// Extraire et sauvegarder les images, puis mettre √† jour le HTML\nconst updatedHtmlContent=await extractAndSaveImages(htmlWithIndexedUrls,projectDir);// Convertir en markdown avec les nouveaux chemins d'images\nconst markdownContent=htmlToMarkdown(updatedHtmlContent);// Sauvegarder le fichier markdown (utiliser le nom disponible)\nconst fileName=\"\".concat(availableProjectName,\".md\");const fileHandle=await projectDir.getFileHandle(fileName,{create:true});const writable=await fileHandle.createWritable();await writable.write(markdownContent);await writable.close();const imageCount=(updatedHtmlContent.match(/src=[\"']\\.\\/images\\/[^\"']+[\"']/g)||[]).length;const message=imageCount>0?\"\\u2705 Projet sauvegard\\xE9 avec succ\\xE8s :\\n\".concat(fileName,\" + \").concat(imageCount,\" image(s) dans \").concat(availableProjectName,\"/\"):\"\\u2705 Projet sauvegard\\xE9 avec succ\\xE8s :\\n\".concat(fileName,\" dans \").concat(availableProjectName,\"/\");alert(message);setShowSaveModal(false);}catch(error){console.error('‚ùå Erreur sauvegarde:',error);if(error.name==='AbortError'){setShowSaveModal(false);return;}alert(\"\\u274C Erreur lors de la sauvegarde :\\n\".concat(error.message));}finally{setIsSaving(false);}};// Fonction pour confirmer la sauvegarde avec le nom choisi\nconst handleConfirmSave=()=>{if(projectName.trim()==='')return;performSave(projectName);};const handleOpenProject=async()=>{if(!isFileSystemAccessSupported()){alert('‚ùå Votre navigateur ne supporte pas l\\'acc√®s aux fichiers.');return;}try{// S√©lectionner le r√©pertoire du projet\nconst directoryHandle=await window.showDirectoryPicker({mode:'read'});// Chercher le fichier .md correspondant au nom du r√©pertoire\nconst projectName=directoryHandle.name;const fileName=\"\".concat(projectName,\".md\");try{const fileHandle=await directoryHandle.getFileHandle(fileName);const file=await fileHandle.getFile();const content=await file.text();let htmlContent=markdownToHtml(content);// Charger les images locales et les convertir en blob URLs\nhtmlContent=await loadLocalImages(htmlContent,directoryHandle);if(editorRef.current){editorRef.current.innerHTML=htmlContent;// D√©clencher l'√©v√©nement de changement pour mettre √† jour l'√©tat\nconst inputEvent=new Event('input',{bubbles:true});editorRef.current.dispatchEvent(inputEvent);}// Basculer en mode WYSIWYG apr√®s le chargement\nonViewModeChange('wysiwyg');const imageCount=(htmlContent.match(/src=[\"']blob:[^\"']+[\"']/g)||[]).length;const message=imageCount>0?\"\\u2705 Projet ouvert avec succ\\xE8s :\\n\".concat(fileName,\" + \").concat(imageCount,\" image(s) charg\\xE9e(s)\"):\"\\u2705 Projet ouvert avec succ\\xE8s :\\n\".concat(fileName);alert(message);}catch(fileError){// Si le fichier n'existe pas, proposer de le cr√©er\nconst createFile=window.confirm(\"Le fichier \".concat(fileName,\" n'existe pas dans ce r\\xE9pertoire.\\n\\nVoulez-vous cr\\xE9er un nouveau projet ?\"));if(createFile){const newContent=\"# \".concat(projectName,\"\\n\\nContenu de votre projet...\");const htmlContent=markdownToHtml(newContent);if(editorRef.current){editorRef.current.innerHTML=htmlContent;const inputEvent=new Event('input',{bubbles:true});editorRef.current.dispatchEvent(inputEvent);}// Basculer en mode WYSIWYG apr√®s le chargement\nonViewModeChange('wysiwyg');alert(\"\\uD83D\\uDCDD Nouveau projet cr\\xE9\\xE9 : \".concat(projectName,\"\\n\\nUtilisez \\\"Sauvegarder\\\" pour l'enregistrer.\"));}}}catch(error){console.error('‚ùå Erreur ouverture projet:',error);if(error.name==='AbortError'){// L'utilisateur a annul√©\nreturn;}alert(\"\\u274C Erreur lors de l'ouverture du projet :\\n\".concat(error.message));}};const loadLocalImages=async(htmlContent,projectDir)=>{// Trouver toutes les images avec src=\"./images/*\"\nconst localImageRegex=/<img[^>]+src=[\"']\\.\\/(images\\/[^\"']+)[\"'][^>]*>/g;const matches=[...htmlContent.matchAll(localImageRegex)];if(matches.length===0){return htmlContent;// Pas d'images locales\n}let updatedHtml=htmlContent;try{// V√©rifier si le dossier images existe\nconst imagesDir=await projectDir.getDirectoryHandle('images');for(const match of matches){const[fullMatch,imagePath]=match;const fileName=imagePath.split('/')[1];// R√©cup√©rer juste le nom du fichier\ntry{// Charger l'image depuis le dossier\nconst imageHandle=await imagesDir.getFileHandle(fileName);const imageFile=await imageHandle.getFile();// Cr√©er une blob URL pour l'affichage\nconst blobUrl=URL.createObjectURL(imageFile);// Remplacer dans le HTML\nupdatedHtml=updatedHtml.replace(\"\\\"./\".concat(imagePath,\"\\\"\"),\"\\\"\".concat(blobUrl,\"\\\"\"));console.log('‚úÖ Image locale charg√©e:',fileName);}catch(imageError){console.error('‚ùå Image introuvable:',fileName,imageError);}}}catch(dirError){console.log('‚ÑπÔ∏è Dossier images non trouv√©');}return updatedHtml;};const handleLoadMarkdown=event=>{const file=event.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=e=>{try{const markdownContent=e.target.result;const htmlContent=markdownToHtml(markdownContent);if(editorRef.current){editorRef.current.innerHTML=htmlContent;// D√©clencher l'√©v√©nement de changement pour mettre √† jour l'√©tat\nconst inputEvent=new Event('input',{bubbles:true});editorRef.current.dispatchEvent(inputEvent);}// Basculer en mode WYSIWYG apr√®s le chargement\nonViewModeChange('wysiwyg');alert('Fichier Markdown charg√© avec succ√®s !');}catch(error){console.error('Erreur lors du chargement:',error);alert('Erreur lors du chargement du fichier');}};reader.readAsText(file);// Reset l'input pour permettre de recharger le m√™me fichier\nevent.target.value='';};const colors=[{name:'Noir',value:'#000000'},{name:'Bleu',value:'#3399ff'},{name:'Vert',value:'#00cc00'},{name:'Rouge',value:'#ff0000'},{name:'Orange',value:'#ff9900'},{name:'Violet',value:'#ff00ff'}];const execCommand=function(command){let value=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(viewMode!=='wysiwyg'||!editorRef.current)return;editorRef.current.focus();// Traitement uniforme - √âtat d'abord, DOM apr√®s\nconst newFormat=_objectSpread({},currentFormat);if(command==='bold'){newFormat.bold=!currentFormat.bold;document.execCommand('bold',false,null);}else if(command==='italic'){newFormat.italic=!currentFormat.italic;document.execCommand('italic',false,null);}else if(command==='normal'){// √âtat Normal imm√©diat - FORCE tout √† false\nnewFormat.bold=false;newFormat.italic=false;newFormat.color='#000000';newFormat.fontSize='16px';newFormat.fontFamily='system-ui';newFormat.heading=null;newFormat.list=null;// Force d√©sactivation DOM - toujours ex√©cuter m√™me si d√©j√† off\nif(document.queryCommandState('bold')){document.execCommand('bold',false,null);}if(document.queryCommandState('italic')){document.execCommand('italic',false,null);}document.execCommand('removeFormat',false,null);document.execCommand('formatBlock',false,'p');}else if(command==='foreColor'){newFormat.color=value;document.execCommand('foreColor',false,value);}else{document.execCommand(command,false,value);}// Mise √† jour imm√©diate AVEC force refresh\nonFormatChange(newFormat);// Pour le bouton Normal, forcer une deuxi√®me mise √† jour apr√®s DOM\nif(command==='normal'){setTimeout(()=>{onFormatChange({bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:'system-ui',heading:null,list:null});},10);}// Ignore court pour tous les boutons\nignoreSelectionChangeRef.current=true;setTimeout(()=>{ignoreSelectionChangeRef.current=false;},100);};const handleHeading=level=>{if(viewMode!=='wysiwyg'||!editorRef.current)return;editorRef.current.focus();// Nettoyer le formatage existant avant d'appliquer le titre\ndocument.execCommand('removeFormat',false,null);// Appliquer le titre\ndocument.execCommand('formatBlock',false,level);onFormatChange({bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:'system-ui',heading:level,list:null});};const handleList=type=>{if(viewMode!=='wysiwyg'||!editorRef.current)return;editorRef.current.focus();if(type==='bullet'){document.execCommand('insertUnorderedList',false,null);}else if(type==='number'){document.execCommand('insertOrderedList',false,null);}else if(type==='letter'){document.execCommand('insertOrderedList',false,null);// Appliquer le style alphab√©tique √† la liste cr√©√©e\nconst selection=window.getSelection();if(selection.rangeCount>0){let element=selection.getRangeAt(0).commonAncestorContainer;while(element&&element.nodeType!==1){element=element.parentNode;}while(element&&element.tagName!=='OL'){element=element.parentNode;}if(element&&element.tagName==='OL'){element.style.listStyleType='lower-alpha';}}}onFormatChange({bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:'system-ui',heading:null,list:type});};const handleClearAll=()=>{if(viewMode!=='wysiwyg'||!editorRef.current)return;editorRef.current.focus();// S√©lectionner tout le contenu puis le supprimer\ndocument.execCommand('selectAll',false,null);document.execCommand('delete',false,null);onFormatChange({bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:'system-ui',heading:null,list:null});};const handleCopy=()=>{if(viewMode!=='wysiwyg'||!editorRef.current)return;editorRef.current.focus();document.execCommand('copy',false,null);};const handlePaste=()=>{if(viewMode!=='wysiwyg'||!editorRef.current)return;editorRef.current.focus();document.execCommand('paste',false,null);// Forcer la mise √† jour apr√®s collage\nsetTimeout(()=>onFormatChange(),10);};const handleImageUpload=async event=>{const file=event.target.files[0];if(!file||!file.type.startsWith('image/')){alert('Veuillez s√©lectionner un fichier image valide.');return;}// Ins√©rer l'image directement dans l'√©diteur\nif(viewMode==='wysiwyg'&&editorRef.current){try{// Cr√©er une URL blob temporaire pour l'affichage imm√©diat\nconst tempBlobUrl=URL.createObjectURL(file);// Stocker l'image dans IndexedDB et r√©cup√©rer l'ID\nconst imageId=await storeImage(tempBlobUrl,file.name);// Ins√©rer DIRECTEMENT avec indexed:// pour √©viter les blob URLs invalides\neditorRef.current.focus();const imgHtml=\"<img src=\\\"indexed://\".concat(imageId,\"\\\" style=\\\"max-width: 100%; height: auto; margin: 0.5em 0;\\\" alt=\\\"\").concat(file.name,\"\\\" data-image-id=\\\"\").concat(imageId,\"\\\" />\");document.execCommand('insertHTML',false,imgHtml);onFormatChange({bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:'system-ui',heading:null,list:null});console.log('‚úÖ Image ins√©r√©e avec indexed://',file.name,imageId);// SAUVEGARDER IMM√âDIATEMENT pour persistance F5/restart\nsetTimeout(()=>{console.log('üíæ Sauvegarde imm√©diate post-upload pour persistance');// D√©clencher la sauvegarde via un √©v√©nement custom\nwindow.dispatchEvent(new CustomEvent('immediateContentSave'));},500);event.target.value='';// Lib√©rer la blob URL temporaire imm√©diatement\nURL.revokeObjectURL(tempBlobUrl);}catch(error){console.error('‚ùå Erreur insertion image:',error);alert('Erreur lors de l\\'insertion de l\\'image');}}};return/*#__PURE__*/_jsxs(\"div\",{className:\"border-4 border-blue-600 rounded-lg bg-blue-100 py-3 shadow-lg w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-start space-x-6 mb-2 w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:\"Format:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>execCommand('normal'),className:\"px-2 py-0.5 text-xs rounded \".concat(!currentFormat.bold&&!currentFormat.italic&&!currentFormat.heading&&!currentFormat.list?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"Normal\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>execCommand('bold'),className:\"px-2 py-0.5 text-xs rounded font-bold \".concat(currentFormat.bold?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"Gras\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>execCommand('italic'),className:\"px-2 py-0.5 text-xs rounded italic \".concat(currentFormat.italic?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"Italique\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-1\",children:colors.map((color,index)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>execCommand('foreColor',color.value),className:\"w-4 h-4 rounded-full border-2 \".concat(currentFormat.color===color.value?'border-blue-500 ring-2 ring-blue-300':'border-gray-300 hover:border-gray-500'),style:{backgroundColor:color.value},disabled:viewMode!=='wysiwyg',title:color.name},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Mode:\"}),/*#__PURE__*/_jsxs(\"select\",{value:viewMode,onChange:e=>onViewModeChange(e.target.value),className:\"px-3 py-1 text-sm rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"wysiwyg\",children:\"\\uD83D\\uDCDD \\xC9diteur visuel\"}),/*#__PURE__*/_jsx(\"option\",{value:\"markdown\",children:\"#\\uFE0F\\u20E3 Code Markdown\"}),/*#__PURE__*/_jsx(\"option\",{value:\"html\",children:\"\\uD83C\\uDF10 Code HTML\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Fichier:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{console.log('üî¥ DEBUG: Bouton Sauvegarder cliqu√©!');handleSaveMarkdown();},className:\"border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 px-2 py-1 text-xs rounded\",title:\"Sauvegarder le projet\",children:\"\\uD83D\\uDCBE Sauvegarder\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Sauvegarder en .md\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleOpenProject,className:\"border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 px-2 py-1 text-xs rounded\",title:\"Ouvrir un projet\",children:\"\\uD83D\\uDCC1 Ouvrir projet\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Charger un fichier .md\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(editorRef.current){editorRef.current.innerHTML='<h1>Nouveau projet</h1><p>Commencez √† √©crire...</p>';const inputEvent=new Event('input',{bubbles:true});editorRef.current.dispatchEvent(inputEvent);}onViewModeChange('wysiwyg');alert('‚úÖ Nouveau projet cr√©√©. Utilisez \"Sauvegarder\" pour l\\'enregistrer.');},className:\"border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 px-2 py-1 text-xs rounded\",title:\"Commencer un nouveau projet\",children:\"\\uD83C\\uDD95 Nouveau\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Nouveau projet\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-2 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onThemeSettingsToggle,className:\"px-3 py-1 text-sm rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 font-medium\",children:\"\\uD83C\\uDFA8 Th\\xE8me\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Param\\xE8tres du th\\xE8me\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-start space-x-6 w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:\"Titres:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>execCommand('normal'),className:\"px-2 py-0.5 text-xs rounded \".concat(!currentFormat.heading&&!currentFormat.list?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"Texte\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleHeading('h1'),className:\"px-2 py-0.5 text-xs rounded \".concat(currentFormat.heading==='h1'?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"Titre 1\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleHeading('h2'),className:\"px-2 py-0.5 text-xs rounded \".concat(currentFormat.heading==='h2'?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"Titre 2\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleHeading('h3'),className:\"px-2 py-0.5 text-xs rounded \".concat(currentFormat.heading==='h3'?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"Titre 3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:\"Listes:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleList('bullet'),className:\"px-2 py-0.5 text-xs rounded \".concat(currentFormat.list==='bullet'?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"\\u2022 Puces\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleList('number'),className:\"px-2 py-0.5 text-xs rounded \".concat(currentFormat.list==='number'?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"1. Num\\xE9ros\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleList('letter'),className:\"px-2 py-0.5 text-xs rounded \".concat(currentFormat.list==='letter'?'border-2 border-blue-500 bg-blue-50 text-blue-700':'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'),disabled:viewMode!=='wysiwyg',children:\"a. Lettres\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"\\xC9dition:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>document.execCommand('undo',false,null),className:\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\",disabled:viewMode!=='wysiwyg',children:\"\\u21B6\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Annuler (Ctrl+Z)\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>document.execCommand('redo',false,null),className:\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\",disabled:viewMode!=='wysiwyg',children:\"\\u21B7\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"R\\xE9tablir (Ctrl+Y)\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleCopy,className:\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\",disabled:viewMode!=='wysiwyg',children:\"\\uD83D\\uDCC4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Copier (Ctrl+C)\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handlePaste,className:\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\",disabled:viewMode!=='wysiwyg',children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Coller (Ctrl+V)\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>document.getElementById('image-input').click(),className:\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\",disabled:viewMode!=='wysiwyg',children:\"\\uD83D\\uDCF7\"}),/*#__PURE__*/_jsx(\"input\",{id:\"image-input\",type:\"file\",accept:\"image/*\",onChange:handleImageUpload,className:\"hidden\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Ins\\xE9rer une image\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleClearAll,className:\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\",disabled:viewMode!=='wysiwyg',children:\"\\uD83E\\uDDFD\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Effacer tout\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleCopyMarkdown,className:\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\",children:\"\\uD83D\\uDCDD\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\",children:[\"Copier en Markdown\",/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"})]})]})]})]}),showSaveModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 w-96 max-w-[90vw] shadow-xl\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"\\uD83D\\uDCBE Sauvegarder le projet\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"project-name\",className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Nom du projet :\"}),/*#__PURE__*/_jsx(\"input\",{id:\"project-name\",type:\"text\",value:projectName,onChange:e=>setProjectName(e.target.value),onKeyPress:e=>{if(e.key==='Enter'&&!isSaving){handleConfirmSave();}if(e.key==='Escape'){setShowSaveModal(false);}},className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\",placeholder:\"MonProjet\",autoFocus:true,disabled:isSaving}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Si le nom existe d\\xE9j\\xE0, (1), (2), etc. seront ajout\\xE9s automatiquement\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowSaveModal(false),disabled:isSaving,className:\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50\",children:\"Annuler\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleConfirmSave,disabled:isSaving||projectName.trim()==='',className:\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\",children:isSaving?'‚è≥ Sauvegarde...':'üíæ Sauvegarder'})]})]})})]});};export default Toolbar;","map":{"version":3,"names":["React","useContext","useState","EditorContext","markdownToHtml","htmlToMarkdown","useImageStorage","jsx","_jsx","jsxs","_jsxs","Toolbar","content","editorRef","currentFormat","onFormatChange","onViewModeChange","viewMode","changeViewMode","onThemeSettingsToggle","onContentChange","ignoreSelectionChangeRef","storeImage","convertBlobUrlsToIndexed","loadImage","showSaveModal","setShowSaveModal","projectName","setProjectName","isSaving","setIsSaving","isFileSystemAccessSupported","window","handleCopyMarkdown","editor","document","querySelector","markdown","navigator","clipboard","writeText","console","log","err","error","generateImageFileName","originalName","extension","now","Date","timestamp","getFullYear","toString","String","getMonth","padStart","getDate","getHours","getMinutes","getSeconds","baseName","replace","concat","extractAndSaveImages","htmlContent","projectDir","substring","parser","DOMParser","doc","parseFromString","images","querySelectorAll","length","forEach","img","i","src","alt","imagesDir","getDirectoryHandle","create","processedUrls","Set","urlToFileName","Map","imageUrl","altText","has","existingFileName","get","_imageData","blob","imageData","startsWith","response","fetch","type","split","imageId","blobUrl","fileName","pop","toLowerCase","imageHandle","getFileHandle","writable","createWritable","write","close","add","set","relativePath","imageError","body","innerHTML","findAvailableDirectoryName","parentDir","finalName","counter","handleSaveMarkdown","alert","performSave","chosenProjectName","_editorRef$current","current","parentDirectoryHandle","showDirectoryPicker","mode","availableProjectName","trim","htmlWithIndexedUrls","updatedHtmlContent","markdownContent","fileHandle","imageCount","match","message","name","handleConfirmSave","handleOpenProject","directoryHandle","file","getFile","text","loadLocalImages","inputEvent","Event","bubbles","dispatchEvent","fileError","createFile","confirm","newContent","localImageRegex","matches","matchAll","updatedHtml","fullMatch","imagePath","imageFile","URL","createObjectURL","dirError","handleLoadMarkdown","event","target","files","reader","FileReader","onload","e","result","readAsText","value","colors","execCommand","command","arguments","undefined","focus","newFormat","_objectSpread","bold","italic","color","fontSize","fontFamily","heading","list","queryCommandState","setTimeout","handleHeading","level","handleList","selection","getSelection","rangeCount","element","getRangeAt","commonAncestorContainer","nodeType","parentNode","tagName","style","listStyleType","handleClearAll","handleCopy","handlePaste","handleImageUpload","tempBlobUrl","imgHtml","CustomEvent","revokeObjectURL","className","children","onClick","disabled","map","index","backgroundColor","title","onChange","getElementById","click","id","accept","htmlFor","onKeyPress","key","placeholder","autoFocus"],"sources":["C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/src/components/Toolbar.js"],"sourcesContent":["import React, { useContext, useState } from 'react';\nimport EditorContext from '../contexts/EditorContext';\nimport { markdownToHtml, htmlToMarkdown } from '../utils/markdownConverter';\nimport { useImageStorage } from '../hooks/useImageStorage';\n// Removed PromptoDYS imports - using simplified project management\n\nconst Toolbar = () => {\n  const {\n    content,\n    editorRef,\n    currentFormat,\n    onFormatChange,\n    onViewModeChange,\n    viewMode,\n    changeViewMode,\n    onThemeSettingsToggle,\n    onContentChange,\n    ignoreSelectionChangeRef\n  } = useContext(EditorContext);\n\n  // Hook pour g√©rer le stockage d'images dans IndexedDB\n  const { storeImage, convertBlobUrlsToIndexed, loadImage } = useImageStorage();\n\n  // √âtats pour la modal de sauvegarde\n  const [showSaveModal, setShowSaveModal] = useState(false);\n  const [projectName, setProjectName] = useState('MonProjet');\n  const [isSaving, setIsSaving] = useState(false);\n\n  // V√©rifier le support File System Access API\n  const isFileSystemAccessSupported = () => {\n    return 'showDirectoryPicker' in window && 'showOpenFilePicker' in window;\n  };\n\n  // Fonctions pour les fichiers Markdown\n  const handleCopyMarkdown = async () => {\n    const editor = document.querySelector('.editor-scroll .prose');\n    if (!editor) return;\n    \n    const markdown = htmlToMarkdown(content);\n    \n    try {\n      await navigator.clipboard.writeText(markdown);\n      console.log('Markdown copi√© dans le presse-papier');\n    } catch (err) {\n      console.error('Erreur lors de la copie:', err);\n    }\n  };\n\n  // G√©n√©rer un nom de fichier unique avec timestamp\n  const generateImageFileName = (originalName, extension) => {\n    const now = new Date();\n    const timestamp = now.getFullYear().toString() + \n                     String(now.getMonth() + 1).padStart(2, '0') +\n                     String(now.getDate()).padStart(2, '0') + '_' +\n                     String(now.getHours()).padStart(2, '0') +\n                     String(now.getMinutes()).padStart(2, '0') +\n                     String(now.getSeconds()).padStart(2, '0');\n    \n    const baseName = originalName.replace(/\\.[^/.]+$/, \"\") || 'image';\n    return `${baseName}_${timestamp}.${extension}`;\n  };\n\n  // Extraire et sauvegarder les images blob\n  const extractAndSaveImages = async (htmlContent, projectDir) => {\n    console.log('üîç extractAndSaveImages appel√©e avec HTML:', htmlContent.substring(0, 200) + '...');\n    \n    // Parser le HTML avec DOMParser\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(htmlContent, 'text/html');\n    \n    // Trouver toutes les images avec src blob: ou indexed://\n    const images = doc.querySelectorAll('img[src^=\"blob:\"], img[src^=\"indexed://\"]');\n    \n    console.log('üîç Nombre d\\'images trouv√©es:', images.length);\n    images.forEach((img, i) => {\n      console.log(`üîç Image ${i + 1}:`, img.src, '|', img.alt);\n    });\n    \n    if (images.length === 0) {\n      console.log('‚ùå Aucune image trouv√©e - HTML:', htmlContent);\n      return htmlContent; // Pas d'images √† traiter\n    }\n\n    // Cr√©er le dossier images\n    const imagesDir = await projectDir.getDirectoryHandle('images', { create: true });\n    \n    // D√©duplication : tracker les URLs d√©j√† trait√©es\n    const processedUrls = new Set();\n    const urlToFileName = new Map();\n    \n    for (const img of images) {\n      const imageUrl = img.src;\n      const altText = img.alt || 'image';\n      \n      // V√©rifier si cette URL a d√©j√† √©t√© trait√©e\n      if (processedUrls.has(imageUrl)) {\n        // R√©utiliser le nom de fichier existant\n        const existingFileName = urlToFileName.get(imageUrl);\n        img.src = `./images/${existingFileName}`;\n        console.log('‚ôªÔ∏è Image dupliqu√©e r√©utilis√©e:', existingFileName);\n        continue;\n      }\n      \n      try {\n        let blob;\n        let extension = 'jpg';\n        let imageData = null; // D√©claration de la variable dans la port√©e appropri√©e\n        \n        if (imageUrl.startsWith('blob:')) {\n          // R√©cup√©rer l'image depuis l'URL blob\n          const response = await fetch(imageUrl);\n          blob = await response.blob();\n          extension = blob.type.split('/')[1] || 'jpg';\n        } else if (imageUrl.startsWith('indexed://')) {\n          // R√©cup√©rer l'image depuis IndexedDB\n          const imageId = imageUrl.replace('indexed://', '');\n          imageData = await loadImage(imageId);\n          \n          if (!imageData) {\n            console.error('‚ùå Image IndexedDB non trouv√©e:', imageId);\n            continue;\n          }\n          \n          // Fetch le blob depuis la blobUrl retourn√©e par loadImage\n          const response = await fetch(imageData.blobUrl);\n          blob = await response.blob();\n          \n          // Extraire l'extension depuis le nom de fichier original\n          extension = imageData.fileName ? imageData.fileName.split('.').pop().toLowerCase() : 'jpg';\n        }\n        \n        if (!blob) {\n          console.error('‚ùå Impossible de r√©cup√©rer l\\'image:', imageUrl);\n          continue;\n        }\n        \n        // Utiliser le nom original de l'image depuis IndexedDB si disponible\n        const originalName = imageData?.fileName || (altText || 'image');\n        const fileName = generateImageFileName(originalName, extension);\n        \n        // Sauvegarder l'image\n        const imageHandle = await imagesDir.getFileHandle(fileName, { create: true });\n        const writable = await imageHandle.createWritable();\n        await writable.write(blob);\n        await writable.close();\n        \n        // Marquer cette URL comme trait√©e et stocker le nom de fichier\n        processedUrls.add(imageUrl);\n        urlToFileName.set(imageUrl, fileName);\n        \n        // Remplacer le src dans l'√©l√©ment DOM\n        const relativePath = `./images/${fileName}`;\n        img.src = relativePath;\n        \n        console.log('‚úÖ Image sauvegard√©e:', fileName);\n      } catch (imageError) {\n        console.error('‚ùå Erreur sauvegarde image:', imageError);\n      }\n    }\n    \n    // Retourner le HTML modifi√© depuis le DOM\n    return doc.body.innerHTML;\n  };\n\n  // Trouver un nom de dossier disponible (gestion des collisions)\n  const findAvailableDirectoryName = async (parentDir, baseName) => {\n    let finalName = baseName;\n    let counter = 1;\n    \n    while (true) {\n      try {\n        // Tenter d'acc√©der au dossier (si √ßa marche, il existe d√©j√†)\n        await parentDir.getDirectoryHandle(finalName);\n        // Le dossier existe, essayer le suivant\n        finalName = `${baseName} (${counter})`;\n        counter++;\n      } catch (error) {\n        // Le dossier n'existe pas, on peut l'utiliser\n        break;\n      }\n    }\n    \n    return finalName;\n  };\n\n  // Fonction pour ouvrir la modal de sauvegarde\n  const handleSaveMarkdown = async () => {\n    console.log('üî• DEBUG: handleSaveMarkdown appel√©e');\n    \n    if (!isFileSystemAccessSupported()) {\n      console.log('‚ùå DEBUG: File System Access API non support√©e');\n      alert('‚ùå Votre navigateur ne supporte pas l\\'acc√®s aux fichiers.');\n      return;\n    }\n    console.log('‚úÖ DEBUG: File System Access API support√©e');\n\n    // Ouvrir la modal pour demander le nom du projet\n    setShowSaveModal(true);\n  };\n\n  // Fonction pour effectuer la sauvegarde avec le nom choisi\n  const performSave = async (chosenProjectName) => {\n    setIsSaving(true);\n    try {\n      const htmlContent = editorRef.current?.innerHTML || content;\n      console.log('üìù DEBUG: htmlContent r√©cup√©r√©:', htmlContent?.length, 'caract√®res');\n      console.log('üìù DEBUG: projectName choisi:', chosenProjectName);\n\n      // S√©lectionner le r√©pertoire parent\n      const parentDirectoryHandle = await window.showDirectoryPicker({\n        mode: 'readwrite'\n      });\n\n      // Trouver un nom de dossier disponible (√©viter les collisions)\n      const availableProjectName = await findAvailableDirectoryName(\n        parentDirectoryHandle, \n        chosenProjectName.trim()\n      );\n\n      // Cr√©er le dossier du projet avec le nom disponible\n      const projectDir = await parentDirectoryHandle.getDirectoryHandle(\n        availableProjectName, \n        { create: true }\n      );\n\n      // Convertir les blob URLs vers indexed:// URLs pour pr√©server les images IndexedDB\n      const htmlWithIndexedUrls = convertBlobUrlsToIndexed(htmlContent);\n      \n      // Extraire et sauvegarder les images, puis mettre √† jour le HTML\n      const updatedHtmlContent = await extractAndSaveImages(htmlWithIndexedUrls, projectDir);\n      \n      // Convertir en markdown avec les nouveaux chemins d'images\n      const markdownContent = htmlToMarkdown(updatedHtmlContent);\n\n      // Sauvegarder le fichier markdown (utiliser le nom disponible)\n      const fileName = `${availableProjectName}.md`;\n      const fileHandle = await projectDir.getFileHandle(fileName, { create: true });\n      const writable = await fileHandle.createWritable();\n      await writable.write(markdownContent);\n      await writable.close();\n      \n      const imageCount = (updatedHtmlContent.match(/src=[\"']\\.\\/images\\/[^\"']+[\"']/g) || []).length;\n      const message = imageCount > 0 \n        ? `‚úÖ Projet sauvegard√© avec succ√®s :\\n${fileName} + ${imageCount} image(s) dans ${availableProjectName}/`\n        : `‚úÖ Projet sauvegard√© avec succ√®s :\\n${fileName} dans ${availableProjectName}/`;\n\n      alert(message);\n      setShowSaveModal(false);\n    } catch (error) {\n      console.error('‚ùå Erreur sauvegarde:', error);\n      if (error.name === 'AbortError') {\n        setShowSaveModal(false);\n        return;\n      }\n      alert(`‚ùå Erreur lors de la sauvegarde :\\n${error.message}`);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  // Fonction pour confirmer la sauvegarde avec le nom choisi\n  const handleConfirmSave = () => {\n    if (projectName.trim() === '') return;\n    performSave(projectName);\n  };\n\n  const handleOpenProject = async () => {\n    if (!isFileSystemAccessSupported()) {\n      alert('‚ùå Votre navigateur ne supporte pas l\\'acc√®s aux fichiers.');\n      return;\n    }\n\n    try {\n      // S√©lectionner le r√©pertoire du projet\n      const directoryHandle = await window.showDirectoryPicker({\n        mode: 'read'\n      });\n\n      // Chercher le fichier .md correspondant au nom du r√©pertoire\n      const projectName = directoryHandle.name;\n      const fileName = `${projectName}.md`;\n      \n      try {\n        const fileHandle = await directoryHandle.getFileHandle(fileName);\n        const file = await fileHandle.getFile();\n        const content = await file.text();\n        let htmlContent = markdownToHtml(content);\n        \n        // Charger les images locales et les convertir en blob URLs\n        htmlContent = await loadLocalImages(htmlContent, directoryHandle);\n        \n        if (editorRef.current) {\n          editorRef.current.innerHTML = htmlContent;\n          // D√©clencher l'√©v√©nement de changement pour mettre √† jour l'√©tat\n          const inputEvent = new Event('input', { bubbles: true });\n          editorRef.current.dispatchEvent(inputEvent);\n        }\n        \n        // Basculer en mode WYSIWYG apr√®s le chargement\n        onViewModeChange('wysiwyg');\n        \n        const imageCount = (htmlContent.match(/src=[\"']blob:[^\"']+[\"']/g) || []).length;\n        const message = imageCount > 0 \n          ? `‚úÖ Projet ouvert avec succ√®s :\\n${fileName} + ${imageCount} image(s) charg√©e(s)`\n          : `‚úÖ Projet ouvert avec succ√®s :\\n${fileName}`;\n          \n        alert(message);\n      } catch (fileError) {\n        // Si le fichier n'existe pas, proposer de le cr√©er\n        const createFile = window.confirm(`Le fichier ${fileName} n'existe pas dans ce r√©pertoire.\\n\\nVoulez-vous cr√©er un nouveau projet ?`);\n        if (createFile) {\n          const newContent = `# ${projectName}\\n\\nContenu de votre projet...`;\n          const htmlContent = markdownToHtml(newContent);\n          \n          if (editorRef.current) {\n            editorRef.current.innerHTML = htmlContent;\n            const inputEvent = new Event('input', { bubbles: true });\n            editorRef.current.dispatchEvent(inputEvent);\n          }\n          \n          // Basculer en mode WYSIWYG apr√®s le chargement\n          onViewModeChange('wysiwyg');\n          alert(`üìù Nouveau projet cr√©√© : ${projectName}\\n\\nUtilisez \"Sauvegarder\" pour l'enregistrer.`);\n        }\n      }\n    } catch (error) {\n      console.error('‚ùå Erreur ouverture projet:', error);\n      if (error.name === 'AbortError') {\n        // L'utilisateur a annul√©\n        return;\n      }\n      alert(`‚ùå Erreur lors de l'ouverture du projet :\\n${error.message}`);\n    }\n  };\n\n  const loadLocalImages = async (htmlContent, projectDir) => {\n    // Trouver toutes les images avec src=\"./images/*\"\n    const localImageRegex = /<img[^>]+src=[\"']\\.\\/(images\\/[^\"']+)[\"'][^>]*>/g;\n    const matches = [...htmlContent.matchAll(localImageRegex)];\n    \n    if (matches.length === 0) {\n      return htmlContent; // Pas d'images locales\n    }\n\n    let updatedHtml = htmlContent;\n    \n    try {\n      // V√©rifier si le dossier images existe\n      const imagesDir = await projectDir.getDirectoryHandle('images');\n      \n      for (const match of matches) {\n        const [fullMatch, imagePath] = match;\n        const fileName = imagePath.split('/')[1]; // R√©cup√©rer juste le nom du fichier\n        \n        try {\n          // Charger l'image depuis le dossier\n          const imageHandle = await imagesDir.getFileHandle(fileName);\n          const imageFile = await imageHandle.getFile();\n          \n          // Cr√©er une blob URL pour l'affichage\n          const blobUrl = URL.createObjectURL(imageFile);\n          \n          // Remplacer dans le HTML\n          updatedHtml = updatedHtml.replace(`\"./${imagePath}\"`, `\"${blobUrl}\"`);\n          \n          console.log('‚úÖ Image locale charg√©e:', fileName);\n        } catch (imageError) {\n          console.error('‚ùå Image introuvable:', fileName, imageError);\n        }\n      }\n    } catch (dirError) {\n      console.log('‚ÑπÔ∏è Dossier images non trouv√©');\n    }\n    \n    return updatedHtml;\n  };\n\n  const handleLoadMarkdown = (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      try {\n        const markdownContent = e.target.result;\n        const htmlContent = markdownToHtml(markdownContent);\n        \n        if (editorRef.current) {\n          editorRef.current.innerHTML = htmlContent;\n          // D√©clencher l'√©v√©nement de changement pour mettre √† jour l'√©tat\n          const inputEvent = new Event('input', { bubbles: true });\n          editorRef.current.dispatchEvent(inputEvent);\n        }\n        \n        // Basculer en mode WYSIWYG apr√®s le chargement\n        onViewModeChange('wysiwyg');\n        alert('Fichier Markdown charg√© avec succ√®s !');\n      } catch (error) {\n        console.error('Erreur lors du chargement:', error);\n        alert('Erreur lors du chargement du fichier');\n      }\n    };\n    \n    reader.readAsText(file);\n    // Reset l'input pour permettre de recharger le m√™me fichier\n    event.target.value = '';\n  };\n  \n  const colors = [\n    { name: 'Noir', value: '#000000' },\n    { name: 'Bleu', value: '#3399ff' },\n    { name: 'Vert', value: '#00cc00' },\n    { name: 'Rouge', value: '#ff0000' },\n    { name: 'Orange', value: '#ff9900' },\n    { name: 'Violet', value: '#ff00ff' }\n  ];\n\n\n  const execCommand = (command, value = null) => {\n    if (viewMode !== 'wysiwyg' || !editorRef.current) return;\n    \n    editorRef.current.focus();\n    \n    // Traitement uniforme - √âtat d'abord, DOM apr√®s\n    const newFormat = { ...currentFormat };\n    \n    if (command === 'bold') {\n      newFormat.bold = !currentFormat.bold;\n      document.execCommand('bold', false, null);\n    } else if (command === 'italic') {\n      newFormat.italic = !currentFormat.italic;\n      document.execCommand('italic', false, null);\n    } else if (command === 'normal') {\n      // √âtat Normal imm√©diat - FORCE tout √† false\n      newFormat.bold = false;\n      newFormat.italic = false;\n      newFormat.color = '#000000';\n      newFormat.fontSize = '16px';\n      newFormat.fontFamily = 'system-ui';\n      newFormat.heading = null;\n      newFormat.list = null;\n      \n      // Force d√©sactivation DOM - toujours ex√©cuter m√™me si d√©j√† off\n      if (document.queryCommandState('bold')) {\n        document.execCommand('bold', false, null);\n      }\n      if (document.queryCommandState('italic')) {\n        document.execCommand('italic', false, null);\n      }\n      document.execCommand('removeFormat', false, null);\n      document.execCommand('formatBlock', false, 'p');\n    } else if (command === 'foreColor') {\n      newFormat.color = value;\n      document.execCommand('foreColor', false, value);\n    } else {\n      document.execCommand(command, false, value);\n    }\n    \n    // Mise √† jour imm√©diate AVEC force refresh\n    onFormatChange(newFormat);\n    \n    // Pour le bouton Normal, forcer une deuxi√®me mise √† jour apr√®s DOM\n    if (command === 'normal') {\n      setTimeout(() => {\n        onFormatChange({\n          bold: false,\n          italic: false,\n          color: '#000000',\n          fontSize: '16px',\n          fontFamily: 'system-ui',\n          heading: null,\n          list: null\n        });\n      }, 10);\n    }\n    \n    // Ignore court pour tous les boutons\n    ignoreSelectionChangeRef.current = true;\n    setTimeout(() => {\n      ignoreSelectionChangeRef.current = false;\n    }, 100);\n  };\n\n  const handleHeading = (level) => {\n    if (viewMode !== 'wysiwyg' || !editorRef.current) return;\n    \n    editorRef.current.focus();\n    \n    // Nettoyer le formatage existant avant d'appliquer le titre\n    document.execCommand('removeFormat', false, null);\n    \n    // Appliquer le titre\n    document.execCommand('formatBlock', false, level);\n    \n    onFormatChange({ bold: false, italic: false, color: '#000000', fontSize: '16px', fontFamily: 'system-ui', heading: level, list: null });\n  };\n\n\n  const handleList = (type) => {\n    if (viewMode !== 'wysiwyg' || !editorRef.current) return;\n    \n    editorRef.current.focus();\n    \n    if (type === 'bullet') {\n      document.execCommand('insertUnorderedList', false, null);\n    } else if (type === 'number') {\n      document.execCommand('insertOrderedList', false, null);\n    } else if (type === 'letter') {\n      document.execCommand('insertOrderedList', false, null);\n      // Appliquer le style alphab√©tique √† la liste cr√©√©e\n      const selection = window.getSelection();\n      if (selection.rangeCount > 0) {\n        let element = selection.getRangeAt(0).commonAncestorContainer;\n        while (element && element.nodeType !== 1) {\n          element = element.parentNode;\n        }\n        while (element && element.tagName !== 'OL') {\n          element = element.parentNode;\n        }\n        if (element && element.tagName === 'OL') {\n          element.style.listStyleType = 'lower-alpha';\n        }\n      }\n    }\n    \n    onFormatChange({ bold: false, italic: false, color: '#000000', fontSize: '16px', fontFamily: 'system-ui', heading: null, list: type });\n  };\n\n  const handleClearAll = () => {\n    if (viewMode !== 'wysiwyg' || !editorRef.current) return;\n    \n    editorRef.current.focus();\n    \n    // S√©lectionner tout le contenu puis le supprimer\n    document.execCommand('selectAll', false, null);\n    document.execCommand('delete', false, null);\n    \n    onFormatChange({ bold: false, italic: false, color: '#000000', fontSize: '16px', fontFamily: 'system-ui', heading: null, list: null });\n  };\n\n  const handleCopy = () => {\n    if (viewMode !== 'wysiwyg' || !editorRef.current) return;\n    \n    editorRef.current.focus();\n    document.execCommand('copy', false, null);\n  };\n\n  const handlePaste = () => {\n    if (viewMode !== 'wysiwyg' || !editorRef.current) return;\n    \n    editorRef.current.focus();\n    document.execCommand('paste', false, null);\n    \n    // Forcer la mise √† jour apr√®s collage\n    setTimeout(() => onFormatChange(), 10);\n  };\n\n  const handleImageUpload = async (event) => {\n    const file = event.target.files[0];\n    if (!file || !file.type.startsWith('image/')) {\n      alert('Veuillez s√©lectionner un fichier image valide.');\n      return;\n    }\n    \n    // Ins√©rer l'image directement dans l'√©diteur\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      try {\n        // Cr√©er une URL blob temporaire pour l'affichage imm√©diat\n        const tempBlobUrl = URL.createObjectURL(file);\n        \n        // Stocker l'image dans IndexedDB et r√©cup√©rer l'ID\n        const imageId = await storeImage(tempBlobUrl, file.name);\n        \n        // Ins√©rer DIRECTEMENT avec indexed:// pour √©viter les blob URLs invalides\n        editorRef.current.focus();\n        const imgHtml = `<img src=\"indexed://${imageId}\" style=\"max-width: 100%; height: auto; margin: 0.5em 0;\" alt=\"${file.name}\" data-image-id=\"${imageId}\" />`;\n        document.execCommand('insertHTML', false, imgHtml);\n        onFormatChange({ bold: false, italic: false, color: '#000000', fontSize: '16px', fontFamily: 'system-ui', heading: null, list: null });\n        \n        console.log('‚úÖ Image ins√©r√©e avec indexed://', file.name, imageId);\n        \n        // SAUVEGARDER IMM√âDIATEMENT pour persistance F5/restart\n        setTimeout(() => {\n          console.log('üíæ Sauvegarde imm√©diate post-upload pour persistance');\n          // D√©clencher la sauvegarde via un √©v√©nement custom\n          window.dispatchEvent(new CustomEvent('immediateContentSave'));\n        }, 500);\n        event.target.value = '';\n        \n        // Lib√©rer la blob URL temporaire imm√©diatement\n        URL.revokeObjectURL(tempBlobUrl);\n        \n      } catch (error) {\n        console.error('‚ùå Erreur insertion image:', error);\n        alert('Erreur lors de l\\'insertion de l\\'image');\n      }\n    }\n  };\n\n\n  return (\n    <div className=\"border-4 border-blue-600 rounded-lg bg-blue-100 py-3 shadow-lg w-full\">\n      {/* Ligne 1 - Format + Couleurs + Mode */}\n      <div className=\"flex items-center justify-start space-x-6 mb-2 w-full\">\n        {/* Format buttons */}\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"text-sm font-medium\">Format:</span>\n          <button\n            onClick={() => execCommand('normal')}\n            className={`px-2 py-0.5 text-xs rounded ${\n              !currentFormat.bold && !currentFormat.italic && !currentFormat.heading && !currentFormat.list\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            Normal\n          </button>\n          <button\n            onClick={() => execCommand('bold')}\n            className={`px-2 py-0.5 text-xs rounded font-bold ${\n              currentFormat.bold\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            Gras\n          </button>\n          <button\n            onClick={() => execCommand('italic')}\n            className={`px-2 py-0.5 text-xs rounded italic ${\n              currentFormat.italic\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            Italique\n          </button>\n        </div>\n\n        {/* Colors (sans libell√©) */}\n        <div className=\"flex space-x-1\">\n          {colors.map((color, index) => (\n            <button\n              key={index}\n              onClick={() => execCommand('foreColor', color.value)}\n              className={`w-4 h-4 rounded-full border-2 ${\n                currentFormat.color === color.value\n                  ? 'border-blue-500 ring-2 ring-blue-300'\n                  : 'border-gray-300 hover:border-gray-500'\n              }`}\n              style={{ backgroundColor: color.value }}\n              disabled={viewMode !== 'wysiwyg'}\n              title={color.name}\n            />\n          ))}\n        </div>\n\n\n        {/* Mode selection menu */}\n        <div className=\"flex items-center space-x-2 mb-4\">\n          <span className=\"text-sm font-medium text-gray-700\">Mode:</span>\n          <select\n            value={viewMode}\n            onChange={(e) => onViewModeChange(e.target.value)}\n            className=\"px-3 py-1 text-sm rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          >\n            <option value=\"wysiwyg\">üìù √âditeur visuel</option>\n            <option value=\"markdown\">#Ô∏è‚É£ Code Markdown</option>\n            <option value=\"html\">üåê Code HTML</option>\n          </select>\n        </div>\n\n        {/* Fichiers Markdown */}\n        <div className=\"flex items-center space-x-2 mb-4\">\n          <span className=\"text-sm font-medium text-gray-700\">Fichier:</span>\n          <div className=\"relative group\">\n            <button\n              onClick={() => {\n                console.log('üî¥ DEBUG: Bouton Sauvegarder cliqu√©!');\n                handleSaveMarkdown();\n              }}\n              className=\"border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 px-2 py-1 text-xs rounded\"\n              title=\"Sauvegarder le projet\"\n            >\n              üíæ Sauvegarder\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Sauvegarder en .md\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n          <div className=\"relative group\">\n            <button\n              onClick={handleOpenProject}\n              className=\"border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 px-2 py-1 text-xs rounded\"\n              title=\"Ouvrir un projet\"\n            >\n              üìÅ Ouvrir projet\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Charger un fichier .md\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n          <div className=\"relative group\">\n            <button\n              onClick={() => {\n                if (editorRef.current) {\n                  editorRef.current.innerHTML = '<h1>Nouveau projet</h1><p>Commencez √† √©crire...</p>';\n                  const inputEvent = new Event('input', { bubbles: true });\n                  editorRef.current.dispatchEvent(inputEvent);\n                }\n                onViewModeChange('wysiwyg');\n                alert('‚úÖ Nouveau projet cr√©√©. Utilisez \"Sauvegarder\" pour l\\'enregistrer.');\n              }}\n              className=\"border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 px-2 py-1 text-xs rounded\"\n              title=\"Commencer un nouveau projet\"\n            >\n              üÜï Nouveau\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Nouveau projet\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n        </div>\n\n        {/* Bouton Th√®me */}\n        <div className=\"flex items-center space-x-2 mb-4\">\n          <div className=\"relative group\">\n            <button\n              onClick={onThemeSettingsToggle}\n              className=\"px-3 py-1 text-sm rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500 font-medium\"\n            >\n              üé® Th√®me\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Param√®tres du th√®me\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n\n          {/* Section simplifi√©e - plus de connexion PromptoDYS */}\n        </div>\n\n      </div>\n\n      {/* Ligne 2 - Titres + Listes + √âdition */}\n      <div className=\"flex items-center justify-start space-x-6 w-full\">\n        {/* Headings */}\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"text-sm font-medium\">Titres:</span>\n          <button\n            onClick={() => execCommand('normal')}\n            className={`px-2 py-0.5 text-xs rounded ${\n              !currentFormat.heading && !currentFormat.list\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            Texte\n          </button>\n          <button\n            onClick={() => handleHeading('h1')}\n            className={`px-2 py-0.5 text-xs rounded ${\n              currentFormat.heading === 'h1'\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            Titre 1\n          </button>\n          <button\n            onClick={() => handleHeading('h2')}\n            className={`px-2 py-0.5 text-xs rounded ${\n              currentFormat.heading === 'h2'\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            Titre 2\n          </button>\n          <button\n            onClick={() => handleHeading('h3')}\n            className={`px-2 py-0.5 text-xs rounded ${\n              currentFormat.heading === 'h3'\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            Titre 3\n          </button>\n        </div>\n\n        {/* Lists */}\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"text-sm font-medium\">Listes:</span>\n          <button\n            onClick={() => handleList('bullet')}\n            className={`px-2 py-0.5 text-xs rounded ${\n              currentFormat.list === 'bullet'\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            ‚Ä¢ Puces\n          </button>\n          <button\n            onClick={() => handleList('number')}\n            className={`px-2 py-0.5 text-xs rounded ${\n              currentFormat.list === 'number'\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            1. Num√©ros\n          </button>\n          <button\n            onClick={() => handleList('letter')}\n            className={`px-2 py-0.5 text-xs rounded ${\n              currentFormat.list === 'letter'\n                ? 'border-2 border-blue-500 bg-blue-50 text-blue-700'\n                : 'border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500'\n            }`}\n            disabled={viewMode !== 'wysiwyg'}\n          >\n            a. Lettres\n          </button>\n        </div>\n\n        {/* Boutons Undo/Redo + Copier */}\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"text-sm font-medium text-gray-700\">√âdition:</span>\n          <div className=\"relative group\">\n            <button\n              onClick={() => document.execCommand('undo', false, null)}\n              className=\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\"\n              disabled={viewMode !== 'wysiwyg'}\n            >\n              ‚Ü∂\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Annuler (Ctrl+Z)\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n          <div className=\"relative group\">\n            <button\n              onClick={() => document.execCommand('redo', false, null)}\n              className=\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\"\n              disabled={viewMode !== 'wysiwyg'}\n            >\n              ‚Ü∑\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              R√©tablir (Ctrl+Y)\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n          <div className=\"relative group\">\n            <button\n              onClick={handleCopy}\n              className=\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\"\n              disabled={viewMode !== 'wysiwyg'}\n            >\n              üìÑ\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Copier (Ctrl+C)\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n          <div className=\"relative group\">\n            <button\n              onClick={handlePaste}\n              className=\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\"\n              disabled={viewMode !== 'wysiwyg'}\n            >\n              üìã\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Coller (Ctrl+V)\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n          <div className=\"relative group\">\n            <button\n              onClick={() => document.getElementById('image-input').click()}\n              className=\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\"\n              disabled={viewMode !== 'wysiwyg'}\n            >\n              üì∑\n            </button>\n            <input\n              id=\"image-input\"\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={handleImageUpload}\n              className=\"hidden\"\n            />\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Ins√©rer une image\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n          <div className=\"relative group\">\n            <button\n              onClick={handleClearAll}\n              className=\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\"\n              disabled={viewMode !== 'wysiwyg'}\n            >\n              üßΩ\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Effacer tout\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n          <div className=\"relative group\">\n            <button\n              onClick={handleCopyMarkdown}\n              className=\"px-2 py-0.5 text-xs rounded border border-gray-400 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-500\"\n            >\n              üìù\n            </button>\n            <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50\">\n              Copier en Markdown\n              <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Modal de sauvegarde */}\n      {showSaveModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100]\">\n          <div className=\"bg-white rounded-lg p-6 w-96 max-w-[90vw] shadow-xl\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n              üíæ Sauvegarder le projet\n            </h3>\n            \n            <div className=\"mb-4\">\n              <label htmlFor=\"project-name\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Nom du projet :\n              </label>\n              <input\n                id=\"project-name\"\n                type=\"text\"\n                value={projectName}\n                onChange={(e) => setProjectName(e.target.value)}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && !isSaving) {\n                    handleConfirmSave();\n                  }\n                  if (e.key === 'Escape') {\n                    setShowSaveModal(false);\n                  }\n                }}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                placeholder=\"MonProjet\"\n                autoFocus\n                disabled={isSaving}\n              />\n              <p className=\"text-xs text-gray-500 mt-1\">\n                Si le nom existe d√©j√†, (1), (2), etc. seront ajout√©s automatiquement\n              </p>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3\">\n              <button\n                onClick={() => setShowSaveModal(false)}\n                disabled={isSaving}\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50\"\n              >\n                Annuler\n              </button>\n              <button\n                onClick={handleConfirmSave}\n                disabled={isSaving || projectName.trim() === ''}\n                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {isSaving ? '‚è≥ Sauvegarde...' : 'üíæ Sauvegarder'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Toolbar;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}