{"ast":null,"code":"import _asyncIterator from\"C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/node_modules/@babel/runtime/helpers/esm/asyncIterator.js\";/**\n * Gestionnaire pour le systÃ¨me de fichiers PromptoDYS\n * GÃ¨re l'organisation des documents et images dans une structure cohÃ©rente\n *//**\n * VÃ©rifie si la File System Access API est disponible\n */export const isFileSystemAccessSupported=()=>{return typeof window!=='undefined'&&'showDirectoryPicker'in window;};/**\n * GÃ©nÃ¨re un nom de dossier basÃ© sur un timestamp\n * Format: Document_YYYYMMDD_HHMM\n */export const generateTimestampFolderName=()=>{const now=new Date();const year=now.getFullYear();const month=String(now.getMonth()+1).padStart(2,'0');const day=String(now.getDate()).padStart(2,'0');const hours=String(now.getHours()).padStart(2,'0');const minutes=String(now.getMinutes()).padStart(2,'0');return\"Document_\".concat(year).concat(month).concat(day,\"_\").concat(hours).concat(minutes);};/**\n * GÃ©nÃ¨re un nom de fichier image unique avec timestamp\n */export const generateImageFileName=(originalName,extension)=>{const now=new Date();const timestamp=now.getFullYear().toString()+String(now.getMonth()+1).padStart(2,'0')+String(now.getDate()).padStart(2,'0')+'_'+String(now.getHours()).padStart(2,'0')+String(now.getMinutes()).padStart(2,'0')+String(now.getSeconds()).padStart(2,'0');const baseName=originalName.replace(/\\.[^/.]+$/,\"\")||'image';return\"\".concat(baseName,\"_\").concat(timestamp,\".\").concat(extension);};/**\n * Ã‰tat global du rÃ©pertoire de travail actuel\n */let currentProjectDirectory=null;let currentProjectName=null;/**\n * DÃ©finit le projet PromptoDYS actuel\n */export const setCurrentProject=(projectHandle,projectName)=>{currentProjectDirectory=projectHandle;currentProjectName=projectName;// Sauvegarder en localStorage pour persistance\nif(projectName){localStorage.setItem('currentPromptoDysProject',projectName);localStorage.setItem('promptoDysConnected','true');console.log('ðŸ’¾ Projet sauvÃ© en localStorage:',projectName);}};/**\n * RÃ©cupÃ¨re le projet PromptoDYS actuel\n */export const getCurrentProject=()=>{return{directory:currentProjectDirectory,name:currentProjectName};};/**\n * RÃ©cupÃ¨re le nom du dernier workspace PromptoDYS utilisÃ©\n */export const getLastWorkspaceName=()=>{try{const savedWorkspace=localStorage.getItem('promptoDysWorkspaceHandle');if(savedWorkspace){const workspace=JSON.parse(savedWorkspace);return workspace.name||null;}}catch(error){console.error('âŒ Erreur rÃ©cupÃ©ration nom workspace:',error);}return null;};/**\n * Initialise le workspace PromptoDYS\n * Demande Ã  l'utilisateur de sÃ©lectionner le dossier PromptoDYS\n */export const initializePromptoDysWorkspace=async function(){let skipDialog=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!isFileSystemAccessSupported()){throw new Error('File System Access API non supportÃ©e');}// Si skipDialog est true, essayer de restaurer le workspace existant\nif(skipDialog){console.log('ðŸ” Tentative restauration workspace silencieuse...');// Pour skipDialog, on ne peut pas demander de nouvelle sÃ©lection\n// On retourne null pour signaler l'Ã©chec de restauration silencieuse\nreturn null;}try{// Demander Ã  l'utilisateur de sÃ©lectionner le dossier PromptoDYS\nconsole.log('ðŸ—‚ï¸ SÃ©lection du dossier PromptoDYS...');const promptoDysHandle=await window.showDirectoryPicker({mode:'readwrite',startIn:'documents'});// Sauvegarder la rÃ©fÃ©rence du workspace (sans crÃ©er de projet)\nlocalStorage.setItem('promptoDysWorkspaceHandle',JSON.stringify({name:promptoDysHandle.name,timestamp:new Date().toISOString()}));console.log('âœ… Workspace PromptoDYS configurÃ©:',promptoDysHandle.name);return promptoDysHandle;}catch(error){if(error.name==='AbortError'){throw new Error('SÃ©lection du dossier PromptoDYS annulÃ©e.');}else{console.error('âŒ Erreur initialisation PromptoDYS:',error);throw error;}}};/**\n * CrÃ©e un nouveau projet PromptoDYS avec un nom timestamp\n */export const createPromptoDysProject=async promptoDysDirectory=>{if(!promptoDysDirectory){// Tenter de rÃ©cupÃ©rer le workspace depuis initializePromptoDysWorkspace\ntry{const workspace=await initializePromptoDysWorkspace();promptoDysDirectory=workspace;}catch(error){console.error('âŒ Impossible d\\'initialiser le workspace:',error);return null;}}try{const projectName=generateTimestampFolderName();// CrÃ©er le dossier du projet\nconst projectHandle=await promptoDysDirectory.getDirectoryHandle(projectName,{create:true});// CrÃ©er le dossier assets\nawait projectHandle.getDirectoryHandle('assets',{create:true});// DÃ©finir comme projet actuel\nsetCurrentProject(projectHandle,projectName);console.log('âœ… Nouveau projet PromptoDYS crÃ©Ã©:',projectName);return projectHandle;}catch(error){console.error('âŒ Erreur crÃ©ation projet PromptoDYS:',error);return null;}};/**\n * CrÃ©e ou rÃ©cupÃ¨re un projet PromptoDYS avec un nom personnalisÃ©\n */export const createOrGetPromptoDysProject=async(promptoDysDirectory,projectName)=>{if(!promptoDysDirectory){// Tenter de rÃ©cupÃ©rer le workspace depuis initializePromptoDysWorkspace\ntry{const workspace=await initializePromptoDysWorkspace();promptoDysDirectory=workspace;}catch(error){console.error('âŒ Impossible d\\'initialiser le workspace:',error);return null;}}try{// CrÃ©er ou rÃ©cupÃ©rer le dossier du projet\nconst projectHandle=await promptoDysDirectory.getDirectoryHandle(projectName,{create:true});// CrÃ©er le dossier assets s'il n'existe pas\nawait projectHandle.getDirectoryHandle('assets',{create:true});// DÃ©finir comme projet actuel\nsetCurrentProject(projectHandle,projectName);console.log('âœ… Projet PromptoDYS configurÃ©:',projectName);return projectHandle;}catch(error){console.error('âŒ Erreur configuration projet PromptoDYS:',error);return null;}};/**\n * Sauvegarde une image dans le dossier assets du projet actuel\n */export const saveImageToPromptoDys=async(imageFile,projectDirectory)=>{if(!projectDirectory)return null;try{// Obtenir le dossier assets\nconst assetsHandle=await projectDirectory.getDirectoryHandle('assets',{create:true});// GÃ©nÃ©rer un nom de fichier unique\nconst fileExtension=imageFile.name.split('.').pop().toLowerCase();const fileName=generateImageFileName(imageFile.name,fileExtension);// CrÃ©er le fichier image\nconst fileHandle=await assetsHandle.getFileHandle(fileName,{create:true});// Ã‰crire les donnÃ©es\nconst writable=await fileHandle.createWritable();await writable.write(imageFile);await writable.close();console.log('âœ… Image sauvegardÃ©e:',fileName);// Retourner le chemin relatif pour Markdown\nconst relativePath=\"./assets/\".concat(fileName);console.log('ðŸ“ Image sauvÃ©e avec chemin relatif:',relativePath);return relativePath;}catch(error){console.error('âŒ Erreur sauvegarde image:',error);return null;}};/**\n * Sauvegarde le fichier Markdown dans le projet PromptoDYS\n */export const saveMarkdownToPromptoDys=async(content,projectDirectory,fileName)=>{if(!projectDirectory)return false;try{const mdFileName=fileName.endsWith('.md')?fileName:\"\".concat(fileName,\".md\");const fileHandle=await projectDirectory.getFileHandle(mdFileName,{create:true});const writable=await fileHandle.createWritable();await writable.write(content);await writable.close();console.log('âœ… Fichier Markdown sauvegardÃ©:',mdFileName);return true;}catch(error){console.error('âŒ Erreur sauvegarde Markdown:',error);return false;}};/**\n * Liste les projets PromptoDYS disponibles\n */export const listPromptoDysProjects=async promptoDysDirectory=>{if(!promptoDysDirectory)return[];try{const projects=[];var _iteratorAbruptCompletion=false;var _didIteratorError=false;var _iteratorError;try{for(var _iterator=_asyncIterator(promptoDysDirectory.entries()),_step;_iteratorAbruptCompletion=!(_step=await _iterator.next()).done;_iteratorAbruptCompletion=false){const[name,handle]=_step.value;{if(handle.kind==='directory'&&name.startsWith('Document_')){// VÃ©rifier s'il y a un fichier .md dans le dossier\ntry{let hasMarkdown=false;var _iteratorAbruptCompletion2=false;var _didIteratorError2=false;var _iteratorError2;try{for(var _iterator2=_asyncIterator(handle.entries()),_step2;_iteratorAbruptCompletion2=!(_step2=await _iterator2.next()).done;_iteratorAbruptCompletion2=false){const[fileName,fileHandle]=_step2.value;{if(fileHandle.kind==='file'&&fileName.endsWith('.md')){hasMarkdown=true;break;}}}}catch(err){_didIteratorError2=true;_iteratorError2=err;}finally{try{if(_iteratorAbruptCompletion2&&_iterator2.return!=null){await _iterator2.return();}}finally{if(_didIteratorError2){throw _iteratorError2;}}}if(hasMarkdown){projects.push({name,handle,displayName:name.replace('Document_','').replace(/_/g,'/')});}}catch(error){// Ignorer les dossiers inaccessibles\n}}}}// Trier par nom (plus rÃ©cent en premier)\n}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(_iteratorAbruptCompletion&&_iterator.return!=null){await _iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}return projects.sort((a,b)=>b.name.localeCompare(a.name));}catch(error){console.error('âŒ Erreur liste projets:',error);return[];}};/**\n * RÃ©initialise le projet actuel (pour nouveau document)\n */export const resetCurrentProject=()=>{currentProjectDirectory=null;currentProjectName=null;localStorage.removeItem('currentPromptoDysProject');localStorage.removeItem('promptoDysConnected');console.log('ðŸ”„ Projet PromptoDYS rÃ©initialisÃ©');};/**\n * VÃ©rifie si PromptoDYS Ã©tait connectÃ© prÃ©cÃ©demment\n */export const isPromptoDysConnected=()=>{return localStorage.getItem('promptoDysConnected')==='true';};/**\n * Tente de restaurer le workspace et projet depuis localStorage\n */export const restorePromptoDysState=async()=>{if(!isPromptoDysConnected()){return{workspace:null,project:null};}try{// Restaurer le workspace\nconst workspace=await initializePromptoDysWorkspace();if(!workspace){return{workspace:null,project:null};}// Restaurer le projet actuel\nconst savedProjectName=localStorage.getItem('currentPromptoDysProject');if(savedProjectName){try{const projectHandle=await workspace.getDirectoryHandle(savedProjectName);setCurrentProject(projectHandle,savedProjectName);console.log('âœ… Projet PromptoDYS restaurÃ©:',savedProjectName);return{workspace,project:projectHandle};}catch(error){console.warn('âš ï¸ Projet sauvÃ© introuvable, en crÃ©er un nouveau:',savedProjectName);}}return{workspace,project:null};}catch(error){console.error('âŒ Erreur restauration PromptoDYS:',error);// Nettoyer localStorage si restauration Ã©choue\nlocalStorage.removeItem('promptoDysConnected');localStorage.removeItem('currentPromptoDysProject');return{workspace:null,project:null};}};/**\n * CrÃ©e automatiquement un projet aprÃ¨s connexion workspace\n */export const ensureCurrentProject=async workspace=>{if(!workspace)return null;// VÃ©rifier si on a dÃ©jÃ  un projet actuel\nconst current=getCurrentProject();if(current.directory){return current.directory;}// CrÃ©er un nouveau projet\nreturn await createPromptoDysProject(workspace);};/**\n * Obtient une rÃ©fÃ©rence au workspace PromptoDYS principal\n */export const getPromptoDysWorkspace=async()=>{try{return await initializePromptoDysWorkspace();}catch(error){console.error('âŒ Impossible d\\'obtenir le workspace PromptoDYS:',error);return null;}};/**\n * Convertit une URL relative PromptoDYS en Blob URL pour affichage\n */export const convertPromptoDysUrlToBlob=async(relativeUrl,projectDirectory)=>{if(!relativeUrl||!projectDirectory||!relativeUrl.startsWith('./assets/')){return relativeUrl;// Retourner l'URL originale si pas une URL PromptoDYS\n}try{// Extraire le nom de fichier depuis l'URL relative\nconst fileName=relativeUrl.replace('./assets/','');// AccÃ©der au dossier assets\nconst assetsHandle=await projectDirectory.getDirectoryHandle('assets');// RÃ©cupÃ©rer le fichier\nconst fileHandle=await assetsHandle.getFileHandle(fileName);const file=await fileHandle.getFile();// CrÃ©er une Blob URL temporaire\nconst blobUrl=URL.createObjectURL(file);console.log(\"\\u2705 Blob URL cr\\xE9\\xE9e: \".concat(fileName,\" -> \").concat(blobUrl));return blobUrl;}catch(error){console.error(\"\\u274C Erreur conversion Blob URL pour \".concat(relativeUrl,\":\"),error);return relativeUrl;// Fallback sur l'URL originale\n}};/**\n * Convertit toutes les URLs relatives PromptoDYS en Blob URLs dans un contenu HTML\n */export const convertAllPromptoDysUrlsToBlobs=async(htmlContent,projectDirectory)=>{if(!htmlContent||!projectDirectory){return htmlContent;}// Regex pour trouver toutes les URLs d'images PromptoDYS\nconst imageRegex=/<img[^>]+src=[\"']\\.\\/assets\\/([^\"']+)[\"'][^>]*>/g;const matches=[...htmlContent.matchAll(imageRegex)];if(matches.length===0){return htmlContent;// Pas d'images PromptoDYS trouvÃ©es\n}let updatedContent=htmlContent;// Traiter chaque image trouvÃ©e\nfor(const match of matches){const fullMatch=match[0];const fileName=match[1];const relativeUrl=\"./assets/\".concat(fileName);// Convertir en Blob URL\nconst blobUrl=await convertPromptoDysUrlToBlob(relativeUrl,projectDirectory);// Remplacer dans le contenu si la conversion a rÃ©ussi\nif(blobUrl!==relativeUrl){const updatedImg=fullMatch.replace(relativeUrl,blobUrl);updatedContent=updatedContent.replace(fullMatch,updatedImg);}}return updatedContent;};/**\n * VÃ©rifie si PromptoDYS est supportÃ©\n */export const isPromptoDysSupported=()=>{return isFileSystemAccessSupported();};","map":{"version":3,"names":["isFileSystemAccessSupported","window","generateTimestampFolderName","now","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","concat","generateImageFileName","originalName","extension","timestamp","toString","getSeconds","baseName","replace","currentProjectDirectory","currentProjectName","setCurrentProject","projectHandle","projectName","localStorage","setItem","console","log","getCurrentProject","directory","name","getLastWorkspaceName","savedWorkspace","getItem","workspace","JSON","parse","error","initializePromptoDysWorkspace","skipDialog","arguments","length","undefined","Error","promptoDysHandle","showDirectoryPicker","mode","startIn","stringify","toISOString","createPromptoDysProject","promptoDysDirectory","getDirectoryHandle","create","createOrGetPromptoDysProject","saveImageToPromptoDys","imageFile","projectDirectory","assetsHandle","fileExtension","split","pop","toLowerCase","fileName","fileHandle","getFileHandle","writable","createWritable","write","close","relativePath","saveMarkdownToPromptoDys","content","mdFileName","endsWith","listPromptoDysProjects","projects","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","_asyncIterator","entries","_step","next","done","handle","value","kind","startsWith","hasMarkdown","_iteratorAbruptCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","err","return","push","displayName","sort","a","b","localeCompare","resetCurrentProject","removeItem","isPromptoDysConnected","restorePromptoDysState","project","savedProjectName","warn","ensureCurrentProject","current","getPromptoDysWorkspace","convertPromptoDysUrlToBlob","relativeUrl","file","getFile","blobUrl","URL","createObjectURL","convertAllPromptoDysUrlsToBlobs","htmlContent","imageRegex","matches","matchAll","updatedContent","match","fullMatch","updatedImg","isPromptoDysSupported"],"sources":["C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/src/utils/promptoDysManager.js"],"sourcesContent":["/**\n * Gestionnaire pour le systÃ¨me de fichiers PromptoDYS\n * GÃ¨re l'organisation des documents et images dans une structure cohÃ©rente\n */\n\n/**\n * VÃ©rifie si la File System Access API est disponible\n */\nexport const isFileSystemAccessSupported = () => {\n  return typeof window !== 'undefined' && 'showDirectoryPicker' in window;\n};\n\n/**\n * GÃ©nÃ¨re un nom de dossier basÃ© sur un timestamp\n * Format: Document_YYYYMMDD_HHMM\n */\nexport const generateTimestampFolderName = () => {\n  const now = new Date();\n  const year = now.getFullYear();\n  const month = String(now.getMonth() + 1).padStart(2, '0');\n  const day = String(now.getDate()).padStart(2, '0');\n  const hours = String(now.getHours()).padStart(2, '0');\n  const minutes = String(now.getMinutes()).padStart(2, '0');\n  \n  return `Document_${year}${month}${day}_${hours}${minutes}`;\n};\n\n/**\n * GÃ©nÃ¨re un nom de fichier image unique avec timestamp\n */\nexport const generateImageFileName = (originalName, extension) => {\n  const now = new Date();\n  const timestamp = now.getFullYear().toString() + \n                   String(now.getMonth() + 1).padStart(2, '0') +\n                   String(now.getDate()).padStart(2, '0') + '_' +\n                   String(now.getHours()).padStart(2, '0') +\n                   String(now.getMinutes()).padStart(2, '0') +\n                   String(now.getSeconds()).padStart(2, '0');\n  \n  const baseName = originalName.replace(/\\.[^/.]+$/, \"\") || 'image';\n  return `${baseName}_${timestamp}.${extension}`;\n};\n\n/**\n * Ã‰tat global du rÃ©pertoire de travail actuel\n */\nlet currentProjectDirectory = null;\nlet currentProjectName = null;\n\n/**\n * DÃ©finit le projet PromptoDYS actuel\n */\nexport const setCurrentProject = (projectHandle, projectName) => {\n  currentProjectDirectory = projectHandle;\n  currentProjectName = projectName;\n  \n  // Sauvegarder en localStorage pour persistance\n  if (projectName) {\n    localStorage.setItem('currentPromptoDysProject', projectName);\n    localStorage.setItem('promptoDysConnected', 'true');\n    console.log('ðŸ’¾ Projet sauvÃ© en localStorage:', projectName);\n  }\n};\n\n/**\n * RÃ©cupÃ¨re le projet PromptoDYS actuel\n */\nexport const getCurrentProject = () => {\n  return {\n    directory: currentProjectDirectory,\n    name: currentProjectName\n  };\n};\n\n/**\n * RÃ©cupÃ¨re le nom du dernier workspace PromptoDYS utilisÃ©\n */\nexport const getLastWorkspaceName = () => {\n  try {\n    const savedWorkspace = localStorage.getItem('promptoDysWorkspaceHandle');\n    if (savedWorkspace) {\n      const workspace = JSON.parse(savedWorkspace);\n      return workspace.name || null;\n    }\n  } catch (error) {\n    console.error('âŒ Erreur rÃ©cupÃ©ration nom workspace:', error);\n  }\n  return null;\n};\n\n/**\n * Initialise le workspace PromptoDYS\n * Demande Ã  l'utilisateur de sÃ©lectionner le dossier PromptoDYS\n */\nexport const initializePromptoDysWorkspace = async (skipDialog = false) => {\n  if (!isFileSystemAccessSupported()) {\n    throw new Error('File System Access API non supportÃ©e');\n  }\n\n  // Si skipDialog est true, essayer de restaurer le workspace existant\n  if (skipDialog) {\n    console.log('ðŸ” Tentative restauration workspace silencieuse...');\n    // Pour skipDialog, on ne peut pas demander de nouvelle sÃ©lection\n    // On retourne null pour signaler l'Ã©chec de restauration silencieuse\n    return null;\n  }\n\n  try {\n    // Demander Ã  l'utilisateur de sÃ©lectionner le dossier PromptoDYS\n    console.log('ðŸ—‚ï¸ SÃ©lection du dossier PromptoDYS...');\n    const promptoDysHandle = await window.showDirectoryPicker({\n      mode: 'readwrite',\n      startIn: 'documents'\n    });\n\n    // Sauvegarder la rÃ©fÃ©rence du workspace (sans crÃ©er de projet)\n    localStorage.setItem('promptoDysWorkspaceHandle', JSON.stringify({\n      name: promptoDysHandle.name,\n      timestamp: new Date().toISOString()\n    }));\n\n    console.log('âœ… Workspace PromptoDYS configurÃ©:', promptoDysHandle.name);\n    return promptoDysHandle;\n  } catch (error) {\n    if (error.name === 'AbortError') {\n      throw new Error('SÃ©lection du dossier PromptoDYS annulÃ©e.');\n    } else {\n      console.error('âŒ Erreur initialisation PromptoDYS:', error);\n      throw error;\n    }\n  }\n};\n\n/**\n * CrÃ©e un nouveau projet PromptoDYS avec un nom timestamp\n */\nexport const createPromptoDysProject = async (promptoDysDirectory) => {\n  if (!promptoDysDirectory) {\n    // Tenter de rÃ©cupÃ©rer le workspace depuis initializePromptoDysWorkspace\n    try {\n      const workspace = await initializePromptoDysWorkspace();\n      promptoDysDirectory = workspace;\n    } catch (error) {\n      console.error('âŒ Impossible d\\'initialiser le workspace:', error);\n      return null;\n    }\n  }\n\n  try {\n    const projectName = generateTimestampFolderName();\n    \n    // CrÃ©er le dossier du projet\n    const projectHandle = await promptoDysDirectory.getDirectoryHandle(projectName, {\n      create: true\n    });\n    \n    // CrÃ©er le dossier assets\n    await projectHandle.getDirectoryHandle('assets', {\n      create: true\n    });\n    \n    // DÃ©finir comme projet actuel\n    setCurrentProject(projectHandle, projectName);\n    \n    console.log('âœ… Nouveau projet PromptoDYS crÃ©Ã©:', projectName);\n    return projectHandle;\n  } catch (error) {\n    console.error('âŒ Erreur crÃ©ation projet PromptoDYS:', error);\n    return null;\n  }\n};\n\n/**\n * CrÃ©e ou rÃ©cupÃ¨re un projet PromptoDYS avec un nom personnalisÃ©\n */\nexport const createOrGetPromptoDysProject = async (promptoDysDirectory, projectName) => {\n  if (!promptoDysDirectory) {\n    // Tenter de rÃ©cupÃ©rer le workspace depuis initializePromptoDysWorkspace\n    try {\n      const workspace = await initializePromptoDysWorkspace();\n      promptoDysDirectory = workspace;\n    } catch (error) {\n      console.error('âŒ Impossible d\\'initialiser le workspace:', error);\n      return null;\n    }\n  }\n\n  try {\n    // CrÃ©er ou rÃ©cupÃ©rer le dossier du projet\n    const projectHandle = await promptoDysDirectory.getDirectoryHandle(projectName, {\n      create: true\n    });\n    \n    // CrÃ©er le dossier assets s'il n'existe pas\n    await projectHandle.getDirectoryHandle('assets', {\n      create: true\n    });\n    \n    // DÃ©finir comme projet actuel\n    setCurrentProject(projectHandle, projectName);\n    \n    console.log('âœ… Projet PromptoDYS configurÃ©:', projectName);\n    return projectHandle;\n  } catch (error) {\n    console.error('âŒ Erreur configuration projet PromptoDYS:', error);\n    return null;\n  }\n};\n\n/**\n * Sauvegarde une image dans le dossier assets du projet actuel\n */\nexport const saveImageToPromptoDys = async (imageFile, projectDirectory) => {\n  if (!projectDirectory) return null;\n\n  try {\n    // Obtenir le dossier assets\n    const assetsHandle = await projectDirectory.getDirectoryHandle('assets', {\n      create: true\n    });\n    \n    // GÃ©nÃ©rer un nom de fichier unique\n    const fileExtension = imageFile.name.split('.').pop().toLowerCase();\n    const fileName = generateImageFileName(imageFile.name, fileExtension);\n    \n    // CrÃ©er le fichier image\n    const fileHandle = await assetsHandle.getFileHandle(fileName, {\n      create: true\n    });\n    \n    // Ã‰crire les donnÃ©es\n    const writable = await fileHandle.createWritable();\n    await writable.write(imageFile);\n    await writable.close();\n    \n    console.log('âœ… Image sauvegardÃ©e:', fileName);\n    \n    // Retourner le chemin relatif pour Markdown\n    const relativePath = `./assets/${fileName}`;\n    \n    console.log('ðŸ“ Image sauvÃ©e avec chemin relatif:', relativePath);\n    return relativePath;\n  } catch (error) {\n    console.error('âŒ Erreur sauvegarde image:', error);\n    return null;\n  }\n};\n\n/**\n * Sauvegarde le fichier Markdown dans le projet PromptoDYS\n */\nexport const saveMarkdownToPromptoDys = async (content, projectDirectory, fileName) => {\n  if (!projectDirectory) return false;\n\n  try {\n    const mdFileName = fileName.endsWith('.md') ? fileName : `${fileName}.md`;\n    \n    const fileHandle = await projectDirectory.getFileHandle(mdFileName, {\n      create: true\n    });\n    \n    const writable = await fileHandle.createWritable();\n    await writable.write(content);\n    await writable.close();\n    \n    console.log('âœ… Fichier Markdown sauvegardÃ©:', mdFileName);\n    return true;\n  } catch (error) {\n    console.error('âŒ Erreur sauvegarde Markdown:', error);\n    return false;\n  }\n};\n\n/**\n * Liste les projets PromptoDYS disponibles\n */\nexport const listPromptoDysProjects = async (promptoDysDirectory) => {\n  if (!promptoDysDirectory) return [];\n\n  try {\n    const projects = [];\n    \n    for await (const [name, handle] of promptoDysDirectory.entries()) {\n      if (handle.kind === 'directory' && name.startsWith('Document_')) {\n        // VÃ©rifier s'il y a un fichier .md dans le dossier\n        try {\n          let hasMarkdown = false;\n          for await (const [fileName, fileHandle] of handle.entries()) {\n            if (fileHandle.kind === 'file' && fileName.endsWith('.md')) {\n              hasMarkdown = true;\n              break;\n            }\n          }\n          \n          if (hasMarkdown) {\n            projects.push({\n              name,\n              handle,\n              displayName: name.replace('Document_', '').replace(/_/g, '/')\n            });\n          }\n        } catch (error) {\n          // Ignorer les dossiers inaccessibles\n        }\n      }\n    }\n    \n    // Trier par nom (plus rÃ©cent en premier)\n    return projects.sort((a, b) => b.name.localeCompare(a.name));\n  } catch (error) {\n    console.error('âŒ Erreur liste projets:', error);\n    return [];\n  }\n};\n\n/**\n * RÃ©initialise le projet actuel (pour nouveau document)\n */\nexport const resetCurrentProject = () => {\n  currentProjectDirectory = null;\n  currentProjectName = null;\n  localStorage.removeItem('currentPromptoDysProject');\n  localStorage.removeItem('promptoDysConnected');\n  console.log('ðŸ”„ Projet PromptoDYS rÃ©initialisÃ©');\n};\n\n/**\n * VÃ©rifie si PromptoDYS Ã©tait connectÃ© prÃ©cÃ©demment\n */\nexport const isPromptoDysConnected = () => {\n  return localStorage.getItem('promptoDysConnected') === 'true';\n};\n\n/**\n * Tente de restaurer le workspace et projet depuis localStorage\n */\nexport const restorePromptoDysState = async () => {\n  if (!isPromptoDysConnected()) {\n    return { workspace: null, project: null };\n  }\n\n  try {\n    // Restaurer le workspace\n    const workspace = await initializePromptoDysWorkspace();\n    if (!workspace) {\n      return { workspace: null, project: null };\n    }\n\n    // Restaurer le projet actuel\n    const savedProjectName = localStorage.getItem('currentPromptoDysProject');\n    if (savedProjectName) {\n      try {\n        const projectHandle = await workspace.getDirectoryHandle(savedProjectName);\n        setCurrentProject(projectHandle, savedProjectName);\n        console.log('âœ… Projet PromptoDYS restaurÃ©:', savedProjectName);\n        return { workspace, project: projectHandle };\n      } catch (error) {\n        console.warn('âš ï¸ Projet sauvÃ© introuvable, en crÃ©er un nouveau:', savedProjectName);\n      }\n    }\n\n    return { workspace, project: null };\n  } catch (error) {\n    console.error('âŒ Erreur restauration PromptoDYS:', error);\n    // Nettoyer localStorage si restauration Ã©choue\n    localStorage.removeItem('promptoDysConnected');\n    localStorage.removeItem('currentPromptoDysProject');\n    return { workspace: null, project: null };\n  }\n};\n\n/**\n * CrÃ©e automatiquement un projet aprÃ¨s connexion workspace\n */\nexport const ensureCurrentProject = async (workspace) => {\n  if (!workspace) return null;\n  \n  // VÃ©rifier si on a dÃ©jÃ  un projet actuel\n  const current = getCurrentProject();\n  if (current.directory) {\n    return current.directory;\n  }\n\n  // CrÃ©er un nouveau projet\n  return await createPromptoDysProject(workspace);\n};\n\n/**\n * Obtient une rÃ©fÃ©rence au workspace PromptoDYS principal\n */\nexport const getPromptoDysWorkspace = async () => {\n  try {\n    return await initializePromptoDysWorkspace();\n  } catch (error) {\n    console.error('âŒ Impossible d\\'obtenir le workspace PromptoDYS:', error);\n    return null;\n  }\n};\n\n/**\n * Convertit une URL relative PromptoDYS en Blob URL pour affichage\n */\nexport const convertPromptoDysUrlToBlob = async (relativeUrl, projectDirectory) => {\n  if (!relativeUrl || !projectDirectory || !relativeUrl.startsWith('./assets/')) {\n    return relativeUrl; // Retourner l'URL originale si pas une URL PromptoDYS\n  }\n\n  try {\n    // Extraire le nom de fichier depuis l'URL relative\n    const fileName = relativeUrl.replace('./assets/', '');\n    \n    // AccÃ©der au dossier assets\n    const assetsHandle = await projectDirectory.getDirectoryHandle('assets');\n    \n    // RÃ©cupÃ©rer le fichier\n    const fileHandle = await assetsHandle.getFileHandle(fileName);\n    const file = await fileHandle.getFile();\n    \n    // CrÃ©er une Blob URL temporaire\n    const blobUrl = URL.createObjectURL(file);\n    \n    console.log(`âœ… Blob URL crÃ©Ã©e: ${fileName} -> ${blobUrl}`);\n    return blobUrl;\n  } catch (error) {\n    console.error(`âŒ Erreur conversion Blob URL pour ${relativeUrl}:`, error);\n    return relativeUrl; // Fallback sur l'URL originale\n  }\n};\n\n/**\n * Convertit toutes les URLs relatives PromptoDYS en Blob URLs dans un contenu HTML\n */\nexport const convertAllPromptoDysUrlsToBlobs = async (htmlContent, projectDirectory) => {\n  if (!htmlContent || !projectDirectory) {\n    return htmlContent;\n  }\n\n  // Regex pour trouver toutes les URLs d'images PromptoDYS\n  const imageRegex = /<img[^>]+src=[\"']\\.\\/assets\\/([^\"']+)[\"'][^>]*>/g;\n  const matches = [...htmlContent.matchAll(imageRegex)];\n  \n  if (matches.length === 0) {\n    return htmlContent; // Pas d'images PromptoDYS trouvÃ©es\n  }\n\n  let updatedContent = htmlContent;\n  \n  // Traiter chaque image trouvÃ©e\n  for (const match of matches) {\n    const fullMatch = match[0];\n    const fileName = match[1];\n    const relativeUrl = `./assets/${fileName}`;\n    \n    // Convertir en Blob URL\n    const blobUrl = await convertPromptoDysUrlToBlob(relativeUrl, projectDirectory);\n    \n    // Remplacer dans le contenu si la conversion a rÃ©ussi\n    if (blobUrl !== relativeUrl) {\n      const updatedImg = fullMatch.replace(relativeUrl, blobUrl);\n      updatedContent = updatedContent.replace(fullMatch, updatedImg);\n    }\n  }\n  \n  return updatedContent;\n};\n\n/**\n * VÃ©rifie si PromptoDYS est supportÃ©\n */\nexport const isPromptoDysSupported = () => {\n  return isFileSystemAccessSupported();\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}