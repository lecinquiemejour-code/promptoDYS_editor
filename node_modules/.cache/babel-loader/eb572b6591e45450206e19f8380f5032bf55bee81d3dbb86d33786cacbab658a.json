{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\JEAN-NOELLEFEBVRE-SA\\\\CascadeProjects\\\\editor\\\\src\\\\components\\\\Editor.js\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { detectBase64, applyBase64Collapse } from '../utils/base64Collapse';\nimport { convertAllPromptoDysUrlsToBlobs, getCurrentProject } from '../utils/promptoDysManager';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Editor = ({\n  viewMode,\n  content,\n  editorRef,\n  onInput,\n  onSelectionChange,\n  currentFormat\n}) => {\n  _s();\n  // √âtat pour g√©rer l'expansion des donn√©es Base64\n  const [expandedBase64, setExpandedBase64] = useState({});\n\n  // Gestionnaire pour l'auto-redimensionnement (toujours d√©clar√©)\n  const handleTextareaResize = useCallback(textarea => {\n    if (textarea) {\n      textarea.style.height = 'auto';\n      textarea.style.height = Math.max(384, textarea.scrollHeight) + 'px';\n    }\n  }, []);\n\n  // Gestionnaire pour toggle Base64\n  const handleBase64Toggle = useCallback(e => {\n    const clickedText = e.target.value;\n    const cursorPos = e.target.selectionStart;\n\n    // Chercher si on a cliqu√© sur un bouton \"üëÅÔ∏è Voir\"\n    const beforeCursor = clickedText.substring(Math.max(0, cursorPos - 100), cursorPos + 20);\n    const toggleMatch = beforeCursor.match(/üëÅÔ∏è Voir/);\n    if (toggleMatch) {\n      // Trouver l'index du Base64 correspondant\n      const base64Matches = detectBase64(content);\n\n      // Pour simplifier, on toggle le premier Base64 trouv√©\n      // Dans une version plus avanc√©e, on pourrait calculer l'index exact\n      if (base64Matches.length > 0) {\n        const toggleIndex = 0; // Simplifi√© pour cette version\n        setExpandedBase64(prev => ({\n          ...prev,\n          [toggleIndex]: !prev[toggleIndex]\n        }));\n      }\n    }\n  }, [content]);\n\n  // Fonction pour obtenir le contenu avec Base64 collaps√©s\n  const getCollapsedContent = useCallback(originalContent => {\n    if (viewMode === 'wysiwyg') {\n      return originalContent; // Pas de collapse en WYSIWYG\n    }\n    return applyBase64Collapse(originalContent, expandedBase64);\n  }, [viewMode, expandedBase64]);\n\n  // Fonction pour formater le HTML avec des retours √† la ligne et indentation\n  const formatHtmlForSource = useCallback(html => {\n    let indentLevel = 0;\n    const indentSize = 2; // 2 espaces par niveau\n\n    return html.replace(/<br\\s*\\/?>/gi, '<br>\\n').replace(/<\\/?(h[1-6]|p|div|ul|ol|li|strong|em|span)[^>]*>/gi, match => {\n      if (match.startsWith('</')) {\n        // Balise fermante : diminuer l'indentation puis ajouter la balise\n        indentLevel = Math.max(0, indentLevel - 1);\n        return match + '\\n';\n      } else {\n        // Balise ouvrante : ajouter la balise puis augmenter l'indentation\n        const result = '\\n' + ' '.repeat(indentLevel * indentSize) + match;\n        // Augmenter l'indentation pour les balises conteneurs\n        if (match.match(/<(ul|ol|li|div|p|h[1-6])[^>]*>/i)) {\n          indentLevel++;\n        }\n        return result;\n      }\n    }).split('\\n').map((line, index) => {\n      if (index === 0) return line.trim(); // Premi√®re ligne sans indentation\n      if (line.trim() === '') return ''; // Ligne vide\n      if (line.trim().startsWith('</')) {\n        // Balise fermante : r√©duire l'indentation\n        const currentIndent = Math.max(0, indentLevel - 1);\n        return ' '.repeat(currentIndent * indentSize) + line.trim();\n      }\n      // Contenu texte : utiliser l'indentation actuelle\n      return line.startsWith(' ') ? line : ' '.repeat(indentLevel * indentSize) + line.trim();\n    }).join('\\n').replace(/^\\n+/, '') // Supprimer les retours √† la ligne en d√©but\n    .replace(/\\n{2,}/g, '\\n') // Supprimer toutes les lignes vides multiples\n    .trim();\n  }, []);\n\n  // Gestionnaire unifi√© pour tous les changements\n  const handleChange = useCallback(e => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      // Nettoyer les spans vides et les &nbsp; en trop\n      const cleanContent = html => {\n        return html.replace(/<span(?![^>]*style=\"[^\"]*color:)[^>]*>\\s*<\\/span>/g, '') // Supprimer spans vides SAUF les spans color√©s\n        .replace(/(&nbsp;\\s*){2,}/g, '&nbsp;') // R√©duire les &nbsp; multiples\n        .replace(/<font[^>]*color=\"([^\"]*)\"[^>]*>(.*?)<\\/font>/g, '<span style=\"color: $1;\">$2</span>') // Convertir font en span\n        .replace(/<b\\b[^>]*>(.*?)<\\/b>/g, '<strong>$1</strong>') // Convertir b en strong\n        .replace(/<i\\b[^>]*>(.*?)<\\/i>/g, '<em>$1</em>'); // Convertir i en em\n      };\n      const newContent = cleanContent(editorRef.current.innerHTML);\n\n      // √âviter les boucles infinies avec une v√©rification plus stricte\n      if (newContent !== content && newContent.trim() !== content.trim()) {\n        onInput({\n          target: {\n            innerHTML: newContent,\n            value: newContent\n          }\n        });\n      }\n\n      // Re-rendre MathJax apr√®s modification du contenu\n      if (window.MathJax && window.MathJax.typesetPromise) {\n        window.MathJax.typesetPromise([editorRef.current]).catch(err => {\n          console.warn('Erreur MathJax:', err);\n        });\n      }\n\n      // Mettre √† jour l'√©tat de formatage avec un d√©lai pour √©viter les conflits\n      requestAnimationFrame(() => {\n        if (document.activeElement === editorRef.current) {\n          onSelectionChange();\n        }\n      });\n    }\n  }, [viewMode, editorRef, onInput, onSelectionChange, content]);\n\n  // Gestionnaire pour les √©v√©nements de s√©lection/curseur\n  const handleSelectionChange = useCallback(() => {\n    if (viewMode === 'wysiwyg' && document.activeElement === editorRef.current) {\n      onSelectionChange();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, onSelectionChange]);\n\n  // Initialiser le contenu uniquement si n√©cessaire\n  useEffect(() => {\n    if (viewMode === 'wysiwyg' && editorRef.current && editorRef.current.innerHTML !== content) {\n      // Ne pas modifier le contenu si l'utilisateur interagit activement\n      const hasFocus = document.activeElement === editorRef.current;\n      const hasSelection = window.getSelection().rangeCount > 0;\n\n      // √âviter les mises √† jour pendant l'interaction utilisateur\n      if (hasFocus && hasSelection) {\n        return; // Ne pas perturber l'utilisateur\n      }\n\n      // Mise √† jour simple sans restauration de curseur\n      editorRef.current.innerHTML = content;\n\n      // Re-rendre MathJax apr√®s mise √† jour du contenu\n      if (window.MathJax && window.MathJax.typesetPromise) {\n        window.MathJax.typesetPromise([editorRef.current]).catch(err => {\n          console.warn('Erreur MathJax:', err);\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, content]);\n\n  // Gestionnaire pour la copie - convertir HTML en texte propre\n  const handleCopy = useCallback(e => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      const selection = window.getSelection();\n      if (selection.rangeCount > 0) {\n        const range = selection.getRangeAt(0);\n        const selectedContent = range.cloneContents();\n        const tempDiv = document.createElement('div');\n        tempDiv.appendChild(selectedContent);\n\n        // Convertir HTML en texte avec retours √† la ligne pr√©serv√©s\n        const htmlContent = tempDiv.innerHTML;\n        const textContent = htmlContent.replace(/<div[^>]*>/gi, '').replace(/<\\/div>/gi, '\\n').replace(/<br\\s*\\/?>/gi, '\\n').replace(/<p[^>]*>/gi, '').replace(/<\\/p>/gi, '\\n').replace(/<[^>]+>/g, '') // Supprimer toutes les autres balises\n        .replace(/&nbsp;/g, ' ').replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&#39;/g, \"'\").replace(/\\n+$/, ''); // Supprimer les retours √† la ligne en fin\n\n        // Mettre le texte propre dans le presse-papier\n        e.clipboardData.setData('text/plain', textContent);\n        e.preventDefault();\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode]);\n\n  // √âcouter les changements de s√©lection et la copie\n  useEffect(() => {\n    if (viewMode === 'wysiwyg') {\n      var _editorRef$current;\n      document.addEventListener('selectionchange', handleSelectionChange);\n      (_editorRef$current = editorRef.current) === null || _editorRef$current === void 0 ? void 0 : _editorRef$current.addEventListener('copy', handleCopy);\n      return () => {\n        var _editorRef$current2;\n        document.removeEventListener('selectionchange', handleSelectionChange);\n        (_editorRef$current2 = editorRef.current) === null || _editorRef$current2 === void 0 ? void 0 : _editorRef$current2.removeEventListener('copy', handleCopy);\n      };\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, handleSelectionChange, handleCopy]);\n\n  // Effect pour redimensionner au changement de contenu (toujours d√©clar√©)\n  useEffect(() => {\n    if (viewMode !== 'wysiwyg' && editorRef.current) {\n      handleTextareaResize(editorRef.current);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [content, viewMode, handleTextareaResize]);\n\n  // Effect pour ajouter les poign√©es de redimensionnement aux images\n  useEffect(() => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      const addResizeHandlesToImages = () => {\n        const images = editorRef.current.querySelectorAll('img:not([data-resizable])');\n        images.forEach(img => {\n          img.setAttribute('data-resizable', 'true');\n\n          // Wrapper l'image dans un conteneur redimensionnable\n          const wrapper = document.createElement('div');\n          wrapper.className = 'resizable-image';\n          wrapper.style.width = img.offsetWidth + 'px';\n          wrapper.style.height = img.offsetHeight + 'px';\n\n          // Ins√©rer le wrapper\n          img.parentNode.insertBefore(wrapper, img);\n          wrapper.appendChild(img);\n\n          // Cr√©er les 4 poign√©es\n          ['nw', 'ne', 'sw', 'se'].forEach(corner => {\n            const handle = document.createElement('div');\n            handle.className = `resize-handle ${corner}`;\n            handle.dataset.corner = corner;\n            handle.addEventListener('mousedown', e => {\n              e.preventDefault();\n              e.stopPropagation();\n              const startX = e.clientX;\n              const startY = e.clientY;\n              const startWidth = wrapper.offsetWidth;\n              const startHeight = wrapper.offsetHeight;\n              const aspectRatio = startWidth / startHeight;\n              const handleMouseMove = e => {\n                const deltaX = e.clientX - startX;\n                const deltaY = e.clientY - startY;\n                let newWidth = startWidth;\n                let newHeight = startHeight;\n\n                // Calculer les nouvelles dimensions selon le coin\n                switch (corner) {\n                  case 'se':\n                    // Sud-Est\n                    newWidth = Math.max(50, startWidth + deltaX);\n                    newHeight = newWidth / aspectRatio;\n                    break;\n                  case 'sw':\n                    // Sud-Ouest\n                    newWidth = Math.max(50, startWidth - deltaX);\n                    newHeight = newWidth / aspectRatio;\n                    break;\n                  case 'ne':\n                    // Nord-Est\n                    newWidth = Math.max(50, startWidth + deltaX);\n                    newHeight = newWidth / aspectRatio;\n                    break;\n                  case 'nw':\n                    // Nord-Ouest\n                    newWidth = Math.max(50, startWidth - deltaX);\n                    newHeight = newWidth / aspectRatio;\n                    break;\n                }\n\n                // Appliquer les nouvelles dimensions\n                wrapper.style.width = newWidth + 'px';\n                wrapper.style.height = newHeight + 'px';\n                img.style.width = '100%';\n                img.style.height = '100%';\n\n                // Ajouter les attributs HTML width/height pour persistance lors des conversions\n                img.setAttribute('width', Math.round(newWidth) + 'px');\n                img.setAttribute('height', Math.round(newHeight) + 'px');\n              };\n              const handleMouseUp = () => {\n                document.removeEventListener('mousemove', handleMouseMove);\n                document.removeEventListener('mouseup', handleMouseUp);\n\n                // D√©clencher l'√©v√©nement de changement pour sauvegarder\n                if (onInput) {\n                  const event = new Event('input', {\n                    bubbles: true\n                  });\n                  editorRef.current.dispatchEvent(event);\n                }\n              };\n              document.addEventListener('mousemove', handleMouseMove);\n              document.addEventListener('mouseup', handleMouseUp);\n            });\n            wrapper.appendChild(handle);\n          });\n        });\n      };\n\n      // Observer les mutations DOM pour les nouvelles images\n      const observer = new MutationObserver(() => {\n        setTimeout(addResizeHandlesToImages, 100);\n      });\n      observer.observe(editorRef.current, {\n        childList: true,\n        subtree: true\n      });\n\n      // Ajouter les poign√©es aux images existantes\n      setTimeout(addResizeHandlesToImages, 100);\n      return () => observer.disconnect();\n    }\n  }, [viewMode, content, onInput]);\n\n  // Rendu conditionnel avec switch/case pour garantir une seule vue\n  console.log('üîÑ Editor.js - Rendu switch/case, viewMode:', viewMode);\n  switch (viewMode) {\n    case 'wysiwyg':\n      console.log('üéØ SWITCH - Vue WYSIWYG');\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"style\", {\n          children: `\n            .editor-content h1 { \n              font-size: 2em; \n              font-weight: bold; \n              margin: 0.67em 0; \n              line-height: 1.2;\n            }\n            .editor-content h2 { \n              font-size: 1.5em; \n              font-weight: bold; \n              margin: 0.75em 0; \n              line-height: 1.3;\n            }\n            .editor-content h3 { \n              font-size: 1.17em; \n              font-weight: bold; \n              margin: 0.83em 0; \n              line-height: 1.4;\n            }\n            .editor-content p {\n              margin: 0.5em 0;\n            }\n            .editor-content ul {\n              margin: 0.5em 0;\n              padding-left: 2em;\n              list-style-type: disc;\n            }\n            .editor-content ol {\n              margin: 0.5em 0;\n              padding-left: 2em;\n              list-style-type: decimal;\n            }\n            .editor-content ol[style*=\"lower-alpha\"] {\n              list-style-type: lower-alpha;\n            }\n            .editor-content li {\n              margin: 0.25em 0;\n            }\n            \n            /* Styles pour images redimensionnables */\n            .editor-content img {\n              max-width: 100%;\n              height: auto;\n              position: relative;\n              cursor: pointer;\n            }\n            \n            .resizable-image {\n              position: relative;\n              display: inline-block;\n              border: 2px solid transparent;\n            }\n            \n            .resizable-image:hover {\n              border: 2px solid #3b82f6;\n            }\n            \n            .resizable-image .resize-handle {\n              position: absolute;\n              width: 10px;\n              height: 10px;\n              background: #3b82f6;\n              border: 2px solid white;\n              border-radius: 50%;\n              opacity: 0;\n              cursor: nw-resize;\n              transition: opacity 0.2s;\n            }\n            \n            .resizable-image:hover .resize-handle {\n              opacity: 1;\n            }\n            \n            .resize-handle.nw { top: -6px; left: -6px; cursor: nw-resize; }\n            .resize-handle.ne { top: -6px; right: -6px; cursor: ne-resize; }\n            .resize-handle.sw { bottom: -6px; left: -6px; cursor: sw-resize; }\n            .resize-handle.se { bottom: -6px; right: -6px; cursor: se-resize; }\n          `\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: editorRef,\n          contentEditable: true,\n          spellCheck: false,\n          onInput: handleChange,\n          suppressContentEditableWarning: true,\n          className: \"editor-content p-2 focus:outline-none h-full\",\n          style: {\n            fontFamily: 'var(--dys-font-family)',\n            fontSize: 'var(--dys-font-size)',\n            lineHeight: 'var(--dys-line-height)',\n            color: 'var(--dys-text-color)',\n            backgroundColor: 'var(--dys-bg-color)',\n            overflow: 'auto',\n            wordWrap: 'break-word',\n            whiteSpace: 'pre-wrap',\n            border: '1px solid #e5e7eb',\n            paddingBottom: '2rem'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }, this)]\n      }, \"wysiwyg\", true, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this);\n    case 'markdown':\n      {\n        console.log('üìù SWITCH - Vue MARKDOWN');\n        const displayContent = getCollapsedContent(content);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative\",\n          children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n            ref: el => {\n              editorRef.current = el;\n            },\n            value: displayContent,\n            onChange: e => {\n              const newValue = e.target.value;\n              const originalWithCollapse = getCollapsedContent(content);\n              if (newValue !== originalWithCollapse) {\n                onInput({\n                  ...e,\n                  target: {\n                    ...e.target,\n                    value: newValue\n                  }\n                });\n              }\n            },\n            onClick: handleBase64Toggle,\n            className: \"editor-content p-2 w-full h-full border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\",\n            style: {\n              fontFamily: 'var(--dys-font-family)',\n              fontSize: 'var(--dys-font-size)',\n              lineHeight: 'var(--dys-line-height)',\n              color: 'var(--dys-text-color)',\n              backgroundColor: 'var(--dys-bg-color)',\n              overflow: 'auto',\n              wordWrap: 'break-word',\n              whiteSpace: 'pre-wrap',\n              paddingBottom: '2rem'\n            },\n            placeholder: \"\\xC9crivez en Markdown... # Titre 1\\n## Titre 2\\n### Titre 3 **Gras** *Italique* - Liste \\xE0 puces\\n1. Liste num\\xE9rot\\xE9e\\na. Liste alphab\\xE9tique $E = mc^2$ (formule inline)\\n$$\\\\\\\\int_{-\\\\\\\\infty}^{\\\\\\\\infty} e^{-x^2} dx = \\\\\\\\sqrt{\\\\\\\\pi}$$ (formule block)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 11\n          }, this), detectBase64(content).length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-2 right-2 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\",\n            children: [\"\\uD83D\\uDCF7 \", detectBase64(content).length, \" image(s) Base64\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 491,\n            columnNumber: 13\n          }, this)]\n        }, \"markdown\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 9\n        }, this);\n      }\n    case 'html':\n      {\n        console.log('üîß SWITCH - Vue HTML');\n        const htmlDisplayContent = formatHtmlForSource(getCollapsedContent(content));\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative\",\n          children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n            ref: el => {\n              editorRef.current = el;\n            },\n            value: htmlDisplayContent,\n            onChange: e => {\n              const newValue = e.target.value;\n              const originalWithCollapse = formatHtmlForSource(getCollapsedContent(content));\n              if (newValue !== originalWithCollapse) {\n                onInput({\n                  ...e,\n                  target: {\n                    ...e.target,\n                    value: newValue\n                  }\n                });\n              }\n            },\n            onClick: handleBase64Toggle,\n            className: \"w-full h-full p-2 focus:outline-none resize-none\",\n            style: {\n              fontFamily: 'Monaco, \"Cascadia Code\", \"Roboto Mono\", monospace',\n              overflow: 'auto',\n              wordWrap: 'break-word',\n              whiteSpace: 'pre-wrap',\n              border: '1px solid #e5e7eb',\n              paddingBottom: '2rem'\n            },\n            placeholder: \"Code source HTML...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 505,\n            columnNumber: 11\n          }, this), detectBase64(content).length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-2 right-2 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\",\n            children: [\"\\uD83D\\uDCF7 \", detectBase64(content).length, \" image(s) Base64\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 13\n          }, this)]\n        }, \"html\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 9\n        }, this);\n      }\n    default:\n      console.log('‚ùå SWITCH - AUCUNE VUE CORRESPONDANTE, viewMode:', viewMode);\n      return null;\n  }\n};\n_s(Editor, \"8AzFQouxQ+jRxfXNWUJlJOX/268=\");\n_c = Editor;\nexport default Editor;\nvar _c;\n$RefreshReg$(_c, \"Editor\");","map":{"version":3,"names":["React","useCallback","useEffect","useState","detectBase64","applyBase64Collapse","convertAllPromptoDysUrlsToBlobs","getCurrentProject","jsxDEV","_jsxDEV","Editor","viewMode","content","editorRef","onInput","onSelectionChange","currentFormat","_s","expandedBase64","setExpandedBase64","handleTextareaResize","textarea","style","height","Math","max","scrollHeight","handleBase64Toggle","e","clickedText","target","value","cursorPos","selectionStart","beforeCursor","substring","toggleMatch","match","base64Matches","length","toggleIndex","prev","getCollapsedContent","originalContent","formatHtmlForSource","html","indentLevel","indentSize","replace","startsWith","result","repeat","split","map","line","index","trim","currentIndent","join","handleChange","current","cleanContent","newContent","innerHTML","window","MathJax","typesetPromise","catch","err","console","warn","requestAnimationFrame","document","activeElement","handleSelectionChange","hasFocus","hasSelection","getSelection","rangeCount","handleCopy","selection","range","getRangeAt","selectedContent","cloneContents","tempDiv","createElement","appendChild","htmlContent","textContent","clipboardData","setData","preventDefault","_editorRef$current","addEventListener","_editorRef$current2","removeEventListener","addResizeHandlesToImages","images","querySelectorAll","forEach","img","setAttribute","wrapper","className","width","offsetWidth","offsetHeight","parentNode","insertBefore","corner","handle","dataset","stopPropagation","startX","clientX","startY","clientY","startWidth","startHeight","aspectRatio","handleMouseMove","deltaX","deltaY","newWidth","newHeight","round","handleMouseUp","event","Event","bubbles","dispatchEvent","observer","MutationObserver","setTimeout","observe","childList","subtree","disconnect","log","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","contentEditable","spellCheck","suppressContentEditableWarning","fontFamily","fontSize","lineHeight","color","backgroundColor","overflow","wordWrap","whiteSpace","border","paddingBottom","displayContent","el","onChange","newValue","originalWithCollapse","onClick","placeholder","htmlDisplayContent","_c","$RefreshReg$"],"sources":["C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/src/components/Editor.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { detectBase64, applyBase64Collapse } from '../utils/base64Collapse';\nimport { convertAllPromptoDysUrlsToBlobs, getCurrentProject } from '../utils/promptoDysManager';\n\nconst Editor = ({ \n  viewMode,  \n  content, \n  editorRef, \n  onInput, \n  onSelectionChange,\n  currentFormat\n}) => {\n  \n  // √âtat pour g√©rer l'expansion des donn√©es Base64\n  const [expandedBase64, setExpandedBase64] = useState({});\n  \n  // Gestionnaire pour l'auto-redimensionnement (toujours d√©clar√©)\n  const handleTextareaResize = useCallback((textarea) => {\n    if (textarea) {\n      textarea.style.height = 'auto';\n      textarea.style.height = Math.max(384, textarea.scrollHeight) + 'px';\n    }\n  }, []);\n\n  // Gestionnaire pour toggle Base64\n  const handleBase64Toggle = useCallback((e) => {\n    const clickedText = e.target.value;\n    const cursorPos = e.target.selectionStart;\n    \n    // Chercher si on a cliqu√© sur un bouton \"üëÅÔ∏è Voir\"\n    const beforeCursor = clickedText.substring(Math.max(0, cursorPos - 100), cursorPos + 20);\n    const toggleMatch = beforeCursor.match(/üëÅÔ∏è Voir/);\n    \n    if (toggleMatch) {\n      // Trouver l'index du Base64 correspondant\n      const base64Matches = detectBase64(content);\n      \n      // Pour simplifier, on toggle le premier Base64 trouv√©\n      // Dans une version plus avanc√©e, on pourrait calculer l'index exact\n      if (base64Matches.length > 0) {\n        const toggleIndex = 0; // Simplifi√© pour cette version\n        setExpandedBase64(prev => ({\n          ...prev,\n          [toggleIndex]: !prev[toggleIndex]\n        }));\n      }\n    }\n  }, [content]);\n\n  // Fonction pour obtenir le contenu avec Base64 collaps√©s\n  const getCollapsedContent = useCallback((originalContent) => {\n    if (viewMode === 'wysiwyg') {\n      return originalContent; // Pas de collapse en WYSIWYG\n    }\n    return applyBase64Collapse(originalContent, expandedBase64);\n  }, [viewMode, expandedBase64]);\n\n  // Fonction pour formater le HTML avec des retours √† la ligne et indentation\n  const formatHtmlForSource = useCallback((html) => {\n    let indentLevel = 0;\n    const indentSize = 2; // 2 espaces par niveau\n    \n    return html\n      .replace(/<br\\s*\\/?>/gi, '<br>\\n')\n      .replace(/<\\/?(h[1-6]|p|div|ul|ol|li|strong|em|span)[^>]*>/gi, (match) => {\n        if (match.startsWith('</')) {\n          // Balise fermante : diminuer l'indentation puis ajouter la balise\n          indentLevel = Math.max(0, indentLevel - 1);\n          return match + '\\n';\n        } else {\n          // Balise ouvrante : ajouter la balise puis augmenter l'indentation\n          const result = '\\n' + ' '.repeat(indentLevel * indentSize) + match;\n          // Augmenter l'indentation pour les balises conteneurs\n          if (match.match(/<(ul|ol|li|div|p|h[1-6])[^>]*>/i)) {\n            indentLevel++;\n          }\n          return result;\n        }\n      })\n      .split('\\n')\n      .map((line, index) => {\n        if (index === 0) return line.trim(); // Premi√®re ligne sans indentation\n        if (line.trim() === '') return ''; // Ligne vide\n        if (line.trim().startsWith('</')) {\n          // Balise fermante : r√©duire l'indentation\n          const currentIndent = Math.max(0, indentLevel - 1);\n          return ' '.repeat(currentIndent * indentSize) + line.trim();\n        }\n        // Contenu texte : utiliser l'indentation actuelle\n        return line.startsWith(' ') ? line : ' '.repeat(indentLevel * indentSize) + line.trim();\n      })\n      .join('\\n')\n      .replace(/^\\n+/, '') // Supprimer les retours √† la ligne en d√©but\n      .replace(/\\n{2,}/g, '\\n') // Supprimer toutes les lignes vides multiples\n      .trim();\n  }, []);\n\n  // Gestionnaire unifi√© pour tous les changements\n  const handleChange = useCallback((e) => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      // Nettoyer les spans vides et les &nbsp; en trop\n      const cleanContent = (html) => {\n        return html\n          .replace(/<span(?![^>]*style=\"[^\"]*color:)[^>]*>\\s*<\\/span>/g, '') // Supprimer spans vides SAUF les spans color√©s\n          .replace(/(&nbsp;\\s*){2,}/g, '&nbsp;') // R√©duire les &nbsp; multiples\n          .replace(/<font[^>]*color=\"([^\"]*)\"[^>]*>(.*?)<\\/font>/g, '<span style=\"color: $1;\">$2</span>') // Convertir font en span\n          .replace(/<b\\b[^>]*>(.*?)<\\/b>/g, '<strong>$1</strong>') // Convertir b en strong\n          .replace(/<i\\b[^>]*>(.*?)<\\/i>/g, '<em>$1</em>'); // Convertir i en em\n      };\n      \n      const newContent = cleanContent(editorRef.current.innerHTML);\n      \n      // √âviter les boucles infinies avec une v√©rification plus stricte\n      if (newContent !== content && newContent.trim() !== content.trim()) {\n        onInput({ target: { innerHTML: newContent, value: newContent } });\n      }\n      \n      // Re-rendre MathJax apr√®s modification du contenu\n      if (window.MathJax && window.MathJax.typesetPromise) {\n        window.MathJax.typesetPromise([editorRef.current]).catch((err) => {\n          console.warn('Erreur MathJax:', err);\n        });\n      }\n      \n      // Mettre √† jour l'√©tat de formatage avec un d√©lai pour √©viter les conflits\n      requestAnimationFrame(() => {\n        if (document.activeElement === editorRef.current) {\n          onSelectionChange();\n        }\n      });\n    }\n  }, [viewMode, editorRef, onInput, onSelectionChange, content]);\n\n  // Gestionnaire pour les √©v√©nements de s√©lection/curseur\n  const handleSelectionChange = useCallback(() => {\n    if (viewMode === 'wysiwyg' && document.activeElement === editorRef.current) {\n      onSelectionChange();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, onSelectionChange]);\n\n  // Initialiser le contenu uniquement si n√©cessaire\n  useEffect(() => {\n    if (viewMode === 'wysiwyg' && editorRef.current && editorRef.current.innerHTML !== content) {\n      // Ne pas modifier le contenu si l'utilisateur interagit activement\n      const hasFocus = document.activeElement === editorRef.current;\n      const hasSelection = window.getSelection().rangeCount > 0;\n      \n      // √âviter les mises √† jour pendant l'interaction utilisateur\n      if (hasFocus && hasSelection) {\n        return; // Ne pas perturber l'utilisateur\n      }\n      \n      // Mise √† jour simple sans restauration de curseur\n      editorRef.current.innerHTML = content;\n      \n      // Re-rendre MathJax apr√®s mise √† jour du contenu\n      if (window.MathJax && window.MathJax.typesetPromise) {\n        window.MathJax.typesetPromise([editorRef.current]).catch((err) => {\n          console.warn('Erreur MathJax:', err);\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, content]);\n\n  // Gestionnaire pour la copie - convertir HTML en texte propre\n  const handleCopy = useCallback((e) => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      const selection = window.getSelection();\n      if (selection.rangeCount > 0) {\n        const range = selection.getRangeAt(0);\n        const selectedContent = range.cloneContents();\n        const tempDiv = document.createElement('div');\n        tempDiv.appendChild(selectedContent);\n        \n        // Convertir HTML en texte avec retours √† la ligne pr√©serv√©s\n        const htmlContent = tempDiv.innerHTML;\n        const textContent = htmlContent\n          .replace(/<div[^>]*>/gi, '')\n          .replace(/<\\/div>/gi, '\\n')\n          .replace(/<br\\s*\\/?>/gi, '\\n')\n          .replace(/<p[^>]*>/gi, '')\n          .replace(/<\\/p>/gi, '\\n')\n          .replace(/<[^>]+>/g, '') // Supprimer toutes les autres balises\n          .replace(/&nbsp;/g, ' ')\n          .replace(/&amp;/g, '&')\n          .replace(/&lt;/g, '<')\n          .replace(/&gt;/g, '>')\n          .replace(/&quot;/g, '\"')\n          .replace(/&#39;/g, \"'\")\n          .replace(/\\n+$/, ''); // Supprimer les retours √† la ligne en fin\n        \n        // Mettre le texte propre dans le presse-papier\n        e.clipboardData.setData('text/plain', textContent);\n        e.preventDefault();\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode]);\n\n  // √âcouter les changements de s√©lection et la copie\n  useEffect(() => {\n    if (viewMode === 'wysiwyg') {\n      document.addEventListener('selectionchange', handleSelectionChange);\n      editorRef.current?.addEventListener('copy', handleCopy);\n      \n      return () => {\n        document.removeEventListener('selectionchange', handleSelectionChange);\n        editorRef.current?.removeEventListener('copy', handleCopy);\n      };\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, handleSelectionChange, handleCopy]);\n\n  // Effect pour redimensionner au changement de contenu (toujours d√©clar√©)\n  useEffect(() => {\n    if (viewMode !== 'wysiwyg' && editorRef.current) {\n      handleTextareaResize(editorRef.current);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [content, viewMode, handleTextareaResize]);\n\n  // Effect pour ajouter les poign√©es de redimensionnement aux images\n  useEffect(() => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      const addResizeHandlesToImages = () => {\n        const images = editorRef.current.querySelectorAll('img:not([data-resizable])');\n        \n        images.forEach((img) => {\n          img.setAttribute('data-resizable', 'true');\n          \n          // Wrapper l'image dans un conteneur redimensionnable\n          const wrapper = document.createElement('div');\n          wrapper.className = 'resizable-image';\n          wrapper.style.width = img.offsetWidth + 'px';\n          wrapper.style.height = img.offsetHeight + 'px';\n          \n          // Ins√©rer le wrapper\n          img.parentNode.insertBefore(wrapper, img);\n          wrapper.appendChild(img);\n          \n          // Cr√©er les 4 poign√©es\n          ['nw', 'ne', 'sw', 'se'].forEach((corner) => {\n            const handle = document.createElement('div');\n            handle.className = `resize-handle ${corner}`;\n            handle.dataset.corner = corner;\n            \n            handle.addEventListener('mousedown', (e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              \n              const startX = e.clientX;\n              const startY = e.clientY;\n              const startWidth = wrapper.offsetWidth;\n              const startHeight = wrapper.offsetHeight;\n              const aspectRatio = startWidth / startHeight;\n              \n              const handleMouseMove = (e) => {\n                const deltaX = e.clientX - startX;\n                const deltaY = e.clientY - startY;\n                \n                let newWidth = startWidth;\n                let newHeight = startHeight;\n                \n                // Calculer les nouvelles dimensions selon le coin\n                switch(corner) {\n                  case 'se': // Sud-Est\n                    newWidth = Math.max(50, startWidth + deltaX);\n                    newHeight = newWidth / aspectRatio;\n                    break;\n                  case 'sw': // Sud-Ouest\n                    newWidth = Math.max(50, startWidth - deltaX);\n                    newHeight = newWidth / aspectRatio;\n                    break;\n                  case 'ne': // Nord-Est\n                    newWidth = Math.max(50, startWidth + deltaX);\n                    newHeight = newWidth / aspectRatio;\n                    break;\n                  case 'nw': // Nord-Ouest\n                    newWidth = Math.max(50, startWidth - deltaX);\n                    newHeight = newWidth / aspectRatio;\n                    break;\n                }\n                \n                // Appliquer les nouvelles dimensions\n                wrapper.style.width = newWidth + 'px';\n                wrapper.style.height = newHeight + 'px';\n                img.style.width = '100%';\n                img.style.height = '100%';\n                \n                // Ajouter les attributs HTML width/height pour persistance lors des conversions\n                img.setAttribute('width', Math.round(newWidth) + 'px');\n                img.setAttribute('height', Math.round(newHeight) + 'px');\n              };\n              \n              const handleMouseUp = () => {\n                document.removeEventListener('mousemove', handleMouseMove);\n                document.removeEventListener('mouseup', handleMouseUp);\n                \n                // D√©clencher l'√©v√©nement de changement pour sauvegarder\n                if (onInput) {\n                  const event = new Event('input', { bubbles: true });\n                  editorRef.current.dispatchEvent(event);\n                }\n              };\n              \n              document.addEventListener('mousemove', handleMouseMove);\n              document.addEventListener('mouseup', handleMouseUp);\n            });\n            \n            wrapper.appendChild(handle);\n          });\n        });\n      };\n      \n      // Observer les mutations DOM pour les nouvelles images\n      const observer = new MutationObserver(() => {\n        setTimeout(addResizeHandlesToImages, 100);\n      });\n      \n      observer.observe(editorRef.current, {\n        childList: true,\n        subtree: true\n      });\n      \n      // Ajouter les poign√©es aux images existantes\n      setTimeout(addResizeHandlesToImages, 100);\n      \n      return () => observer.disconnect();\n    }\n  }, [viewMode, content, onInput]);\n\n  // Rendu conditionnel avec switch/case pour garantir une seule vue\n  console.log('üîÑ Editor.js - Rendu switch/case, viewMode:', viewMode);\n  \n  switch (viewMode) {\n    case 'wysiwyg':\n      console.log('üéØ SWITCH - Vue WYSIWYG');\n      return (\n        <div key=\"wysiwyg\">\n          <style>{`\n            .editor-content h1 { \n              font-size: 2em; \n              font-weight: bold; \n              margin: 0.67em 0; \n              line-height: 1.2;\n            }\n            .editor-content h2 { \n              font-size: 1.5em; \n              font-weight: bold; \n              margin: 0.75em 0; \n              line-height: 1.3;\n            }\n            .editor-content h3 { \n              font-size: 1.17em; \n              font-weight: bold; \n              margin: 0.83em 0; \n              line-height: 1.4;\n            }\n            .editor-content p {\n              margin: 0.5em 0;\n            }\n            .editor-content ul {\n              margin: 0.5em 0;\n              padding-left: 2em;\n              list-style-type: disc;\n            }\n            .editor-content ol {\n              margin: 0.5em 0;\n              padding-left: 2em;\n              list-style-type: decimal;\n            }\n            .editor-content ol[style*=\"lower-alpha\"] {\n              list-style-type: lower-alpha;\n            }\n            .editor-content li {\n              margin: 0.25em 0;\n            }\n            \n            /* Styles pour images redimensionnables */\n            .editor-content img {\n              max-width: 100%;\n              height: auto;\n              position: relative;\n              cursor: pointer;\n            }\n            \n            .resizable-image {\n              position: relative;\n              display: inline-block;\n              border: 2px solid transparent;\n            }\n            \n            .resizable-image:hover {\n              border: 2px solid #3b82f6;\n            }\n            \n            .resizable-image .resize-handle {\n              position: absolute;\n              width: 10px;\n              height: 10px;\n              background: #3b82f6;\n              border: 2px solid white;\n              border-radius: 50%;\n              opacity: 0;\n              cursor: nw-resize;\n              transition: opacity 0.2s;\n            }\n            \n            .resizable-image:hover .resize-handle {\n              opacity: 1;\n            }\n            \n            .resize-handle.nw { top: -6px; left: -6px; cursor: nw-resize; }\n            .resize-handle.ne { top: -6px; right: -6px; cursor: ne-resize; }\n            .resize-handle.sw { bottom: -6px; left: -6px; cursor: sw-resize; }\n            .resize-handle.se { bottom: -6px; right: -6px; cursor: se-resize; }\n          `}</style>\n          <div\n            ref={editorRef}\n            contentEditable\n            spellCheck={false}\n            onInput={handleChange}\n            suppressContentEditableWarning={true}\n            className=\"editor-content p-2 focus:outline-none h-full\"\n            style={{ \n              fontFamily: 'var(--dys-font-family)',\n              fontSize: 'var(--dys-font-size)',\n              lineHeight: 'var(--dys-line-height)',\n              color: 'var(--dys-text-color)',\n              backgroundColor: 'var(--dys-bg-color)',\n              overflow: 'auto',\n              wordWrap: 'break-word',\n              whiteSpace: 'pre-wrap',\n              border: '1px solid #e5e7eb',\n              paddingBottom: '2rem'\n            }}\n          />\n        </div>\n      );\n\n    case 'markdown': {\n      console.log('üìù SWITCH - Vue MARKDOWN');\n      const displayContent = getCollapsedContent(content);\n      \n      return (\n        <div key=\"markdown\" className=\"relative\">\n          <textarea\n            ref={(el) => {\n              editorRef.current = el;\n            }}\n            value={displayContent}\n            onChange={(e) => {\n              const newValue = e.target.value;\n              const originalWithCollapse = getCollapsedContent(content);\n              \n              if (newValue !== originalWithCollapse) {\n                onInput({ ...e, target: { ...e.target, value: newValue } });\n              }\n            }}\n            onClick={handleBase64Toggle}\n            className=\"editor-content p-2 w-full h-full border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n            style={{\n              fontFamily: 'var(--dys-font-family)',\n              fontSize: 'var(--dys-font-size)',\n              lineHeight: 'var(--dys-line-height)',\n              color: 'var(--dys-text-color)',\n              backgroundColor: 'var(--dys-bg-color)',\n              overflow: 'auto',\n              wordWrap: 'break-word',\n              whiteSpace: 'pre-wrap',\n              paddingBottom: '2rem'\n            }}\n            placeholder=\"√âcrivez en Markdown...\n\n# Titre 1\n## Titre 2\n### Titre 3\n\n**Gras** *Italique*\n\n- Liste √† puces\n1. Liste num√©rot√©e\na. Liste alphab√©tique\n\n$E = mc^2$ (formule inline)\n$$\\\\int_{-\\\\infty}^{\\\\infty} e^{-x^2} dx = \\\\sqrt{\\\\pi}$$ (formule block)\"\n          />\n          {detectBase64(content).length > 0 && (\n            <div className=\"absolute top-2 right-2 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\">\n              üì∑ {detectBase64(content).length} image(s) Base64\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    case 'html': {\n      console.log('üîß SWITCH - Vue HTML');\n      const htmlDisplayContent = formatHtmlForSource(getCollapsedContent(content));\n    \n      return (\n        <div key=\"html\" className=\"relative\">\n          <textarea\n            ref={(el) => {\n              editorRef.current = el;\n            }}\n            value={htmlDisplayContent}\n            onChange={(e) => {\n              const newValue = e.target.value;\n              const originalWithCollapse = formatHtmlForSource(getCollapsedContent(content));\n              \n              if (newValue !== originalWithCollapse) {\n                onInput({ ...e, target: { ...e.target, value: newValue } });\n              }\n            }}\n            onClick={handleBase64Toggle}\n            className=\"w-full h-full p-2 focus:outline-none resize-none\"\n            style={{ \n              fontFamily: 'Monaco, \"Cascadia Code\", \"Roboto Mono\", monospace',\n              overflow: 'auto',\n              wordWrap: 'break-word',\n              whiteSpace: 'pre-wrap',\n              border: '1px solid #e5e7eb',\n              paddingBottom: '2rem'\n            }}\n            placeholder=\"Code source HTML...\"\n          />\n          {detectBase64(content).length > 0 && (\n            <div className=\"absolute top-2 right-2 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\">\n              üì∑ {detectBase64(content).length} image(s) Base64\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    default:\n      console.log('‚ùå SWITCH - AUCUNE VUE CORRESPONDANTE, viewMode:', viewMode);\n      return null;\n  }\n};\n\nexport default Editor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}