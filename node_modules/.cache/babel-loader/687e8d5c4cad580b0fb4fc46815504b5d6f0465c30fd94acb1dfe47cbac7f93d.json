{"ast":null,"code":"import _objectSpread from\"C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useRef,useCallback,useEffect}from'react';import{htmlToMarkdown,markdownToHtml}from'../utils/markdownConverter';export const useEditor=()=>{const[content,setContent]=useState(()=>{const savedContent=localStorage.getItem('editor-content');return savedContent||'<p>Bienvenue dans votre éditeur WYSIWYG</p><p>Commencez à écrire votre <strong>document</strong> ici.</p><p>Le contenu est automatiquement sauvegardé.</p>';});// Remplacer isWysiwyg par viewMode avec 3 options\nconst[viewMode,setViewMode]=useState(()=>{// Force le mode 'wysiwyg' par défaut - toujours démarrer en mode visuel\nreturn'wysiwyg';});const[currentFormat,setCurrentFormat]=useState(()=>{// Récupérer la police sauvegardée depuis localStorage\nconst savedFont=localStorage.getItem('editor-font')||'system-ui, -apple-system, sans-serif';return{bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:savedFont,heading:null,list:null};});// État pour gérer l'image sélectionnée\nconst[selectedImage,setSelectedImage]=useState(null);// Mémoriser le dernier formatage appliqué pour les débuts de ligne\nconst lastAppliedFormatRef=useRef(null);const editorRef=useRef(null);const selectionRef=useRef(null);const ignoreSelectionChangeRef=useRef(false);// Sauvegarder la sélection\nconst saveSelection=useCallback(()=>{if(window.getSelection&&editorRef.current){const selection=window.getSelection();if(selection.rangeCount>0){selectionRef.current=selection.getRangeAt(0).cloneRange();}}},[]);// Restaurer la sélection\nconst restoreSelection=useCallback(()=>{if(selectionRef.current&&editorRef.current){const selection=window.getSelection();selection.removeAllRanges();selection.addRange(selectionRef.current);editorRef.current.focus();}},[]);// Détecter l'état de formatage à la position du curseur\nconst updateCurrentFormat=useCallback(()=>{if(!editorRef.current)return;const selection=window.getSelection();if(!selection.rangeCount)return;const range=selection.getRangeAt(0);let element=range.startContainer;// Si c'est un nœud texte, prendre le parent\nif(element.nodeType===Node.TEXT_NODE){element=element.parentElement;}// Si pas d'élément ou curseur en début de ligne, utiliser l'état mémorisé\nif(!element||element===editorRef.current){if(lastAppliedFormatRef.current){setCurrentFormat(lastAppliedFormatRef.current);return;}}// Si on vient d'appliquer un formatage Normal, le préserver\nif(lastAppliedFormatRef.current&&lastAppliedFormatRef.current.heading===null&&lastAppliedFormatRef.current.bold===false&&lastAppliedFormatRef.current.italic===false){setCurrentFormat(lastAppliedFormatRef.current);return;}// Parcourir vers le haut pour trouver les styles\nlet currentElement=element;const newFormat={bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:'system-ui',heading:null,list:null};while(currentElement&&currentElement!==editorRef.current){var _currentElement$tagNa,_currentElement$style,_currentElement$style2;const computedStyle=window.getComputedStyle(currentElement);const tagName=(_currentElement$tagNa=currentElement.tagName)===null||_currentElement$tagNa===void 0?void 0:_currentElement$tagNa.toLowerCase();// Vérifier les balises de formatage\nif(tagName==='strong'||tagName==='b'||computedStyle.fontWeight==='bold'||parseInt(computedStyle.fontWeight)>=700){newFormat.bold=true;}if(tagName==='em'||tagName==='i'||computedStyle.fontStyle==='italic'){newFormat.italic=true;}if(tagName!==null&&tagName!==void 0&&tagName.match(/^h[1-6]$/)){newFormat.heading=tagName;}if(tagName==='li'){// Trouver le parent ul ou ol\nlet listParent=currentElement.parentElement;while(listParent&&!['ul','ol'].includes((_listParent$tagName=listParent.tagName)===null||_listParent$tagName===void 0?void 0:_listParent$tagName.toLowerCase())){var _listParent$tagName;listParent=listParent.parentElement;}if(listParent){const parentTag=listParent.tagName.toLowerCase();const listStyle=listParent.style.listStyleType;if(parentTag==='ul'){newFormat.list=listStyle==='lower-alpha'?'letter':'bullet';}else if(parentTag==='ol'){newFormat.list=listStyle==='lower-alpha'?'letter':'number';}}}if(tagName==='ul'){const listStyle=currentElement.style.listStyleType;newFormat.list=listStyle==='lower-alpha'?'letter':'bullet';}if(tagName==='ol'){const listStyle=currentElement.style.listStyleType;newFormat.list=listStyle==='lower-alpha'?'letter':'number';}// Vérifier les styles inline et computed\nif((_currentElement$style=currentElement.style)!==null&&_currentElement$style!==void 0&&_currentElement$style.color){newFormat.color=currentElement.style.color;}else if(computedStyle.color&&computedStyle.color!=='rgb(0, 0, 0)'){newFormat.color=computedStyle.color;}if((_currentElement$style2=currentElement.style)!==null&&_currentElement$style2!==void 0&&_currentElement$style2.fontSize){newFormat.fontSize=currentElement.style.fontSize;}currentElement=currentElement.parentElement;}// Convertir rgb en hex si nécessaire\nif(newFormat.color.startsWith('rgb')){newFormat.color=rgbToHex(newFormat.color);}setCurrentFormat(newFormat);},[]);// Convertir RGB en HEX\nconst rgbToHex=rgb=>{const result=rgb.match(/\\d+/g);if(!result||result.length<3)return'#000000';const r=parseInt(result[0]);const g=parseInt(result[1]);const b=parseInt(result[2]);return\"#\".concat(((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1));};// Gérer les changements de contenu\nconst handleInput=useCallback(e=>{if(viewMode==='wysiwyg'){setContent(e.target.innerHTML);// Laisser selectionchange gérer la synchronisation\n}else{setContent(e.target.value);}},[viewMode]);// Gérer les changements de sélection\nconst handleSelectionChange=useCallback(()=>{if(ignoreSelectionChangeRef.current){console.log('selectionchange IGNORED');return;}if(viewMode==='wysiwyg'&&document.activeElement===editorRef.current){console.log('selectionchange PROCESSING');updateCurrentFormat();saveSelection();}},[viewMode,updateCurrentFormat,saveSelection]);// Fonction pour changer de vue avec conversion automatique\nconst changeViewMode=useCallback(newMode=>{if(newMode===viewMode)return;let newContent=content;// Conversions entre les vues\nif(viewMode==='wysiwyg'&&newMode==='markdown'){newContent=htmlToMarkdown(content);}else if(viewMode==='markdown'&&newMode==='wysiwyg'){newContent=markdownToHtml(content);}else if(viewMode==='html'&&newMode==='markdown'){newContent=htmlToMarkdown(content);}else if(viewMode==='markdown'&&newMode==='html'){newContent=markdownToHtml(content);}// wysiwyg -> html : nettoyer les data-attributes\nif(viewMode==='wysiwyg'&&newMode==='html'){newContent=content.replace(/ data-type=\"[^\"]*\"/g,'').replace(/ data-number=\"[^\"]*\"/g,'').replace(/ data-letter=\"[^\"]*\"/g,'');}// html -> wysiwyg : pas de conversion nécessaire\nsetContent(newContent);setViewMode(newMode);},[viewMode,content]);// Écouter les changements de sélection\nuseEffect(()=>{document.addEventListener('selectionchange',handleSelectionChange);return()=>{document.removeEventListener('selectionchange',handleSelectionChange);};},[handleSelectionChange]);// Sauvegarder la police sélectionnée dans localStorage\nuseEffect(()=>{if(currentFormat.fontFamily){localStorage.setItem('editor-font',currentFormat.fontFamily);}},[currentFormat.fontFamily]);// Fonction pour sauvegarder l'état appliqué\nconst saveAppliedFormat=useCallback(format=>{lastAppliedFormatRef.current=_objectSpread({},format);},[]);// Gestionnaire pour sélectionner une image\nconst handleImageClick=useCallback(imageElement=>{if(viewMode==='wysiwyg'){setSelectedImage(imageElement);// Déselectionner le texte pour éviter les conflits\nwindow.getSelection().removeAllRanges();}},[viewMode]);// Gestionnaire pour désélectionner l'image si clic ailleurs\nconst handleEditorClick=useCallback(e=>{if(viewMode==='wysiwyg'&&selectedImage){// Si le clic n'est pas sur l'image sélectionnée, la désélectionner\nif(e.target!==selectedImage&&!selectedImage.contains(e.target)){setSelectedImage(null);}}},[viewMode,selectedImage]);// Gestionnaire pour supprimer l'image sélectionnée\nconst handleDeleteSelectedImage=useCallback(e=>{if(viewMode==='wysiwyg'&&selectedImage&&(e.key==='Delete'||e.key==='Backspace')){e.preventDefault();// Supprimer l'image du DOM (wrapper complet si présent)\nconst wrapper=selectedImage.closest('.resizable-image');const elementToRemove=wrapper||selectedImage;elementToRemove.remove();setSelectedImage(null);// Déclencher la sauvegarde\nif(editorRef.current){const event=new Event('input',{bubbles:true});editorRef.current.dispatchEvent(event);}}},[viewMode,selectedImage]);return{content,setContent,viewMode,setViewMode,changeViewMode,// Compatibilité avec l'ancien système\nisWysiwyg:viewMode==='wysiwyg',setIsWysiwyg:value=>changeViewMode(value?'wysiwyg':'html'),currentFormat,setCurrentFormat,editorRef,handleInput,saveSelection,restoreSelection,updateCurrentFormat,saveAppliedFormat,ignoreSelectionChangeRef,// Gestion de sélection d'images\nselectedImage,setSelectedImage,handleImageClick,handleEditorClick,handleDeleteSelectedImage};};","map":{"version":3,"names":["useState","useRef","useCallback","useEffect","htmlToMarkdown","markdownToHtml","useEditor","content","setContent","savedContent","localStorage","getItem","viewMode","setViewMode","currentFormat","setCurrentFormat","savedFont","bold","italic","color","fontSize","fontFamily","heading","list","selectedImage","setSelectedImage","lastAppliedFormatRef","editorRef","selectionRef","ignoreSelectionChangeRef","saveSelection","window","getSelection","current","selection","rangeCount","getRangeAt","cloneRange","restoreSelection","removeAllRanges","addRange","focus","updateCurrentFormat","range","element","startContainer","nodeType","Node","TEXT_NODE","parentElement","currentElement","newFormat","_currentElement$tagNa","_currentElement$style","_currentElement$style2","computedStyle","getComputedStyle","tagName","toLowerCase","fontWeight","parseInt","fontStyle","match","listParent","includes","_listParent$tagName","parentTag","listStyle","style","listStyleType","startsWith","rgbToHex","rgb","result","length","r","g","b","concat","toString","slice","handleInput","e","target","innerHTML","value","handleSelectionChange","console","log","document","activeElement","changeViewMode","newMode","newContent","replace","addEventListener","removeEventListener","setItem","saveAppliedFormat","format","_objectSpread","handleImageClick","imageElement","handleEditorClick","contains","handleDeleteSelectedImage","key","preventDefault","wrapper","closest","elementToRemove","remove","event","Event","bubbles","dispatchEvent","isWysiwyg","setIsWysiwyg"],"sources":["C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/src/hooks/useEditor.js"],"sourcesContent":["import { useState, useRef, useCallback, useEffect } from 'react';\nimport { htmlToMarkdown, markdownToHtml } from '../utils/markdownConverter';\n\nexport const useEditor = () => {\n  const [content, setContent] = useState(() => {\n    const savedContent = localStorage.getItem('editor-content');\n    return savedContent || '<p>Bienvenue dans votre éditeur WYSIWYG</p><p>Commencez à écrire votre <strong>document</strong> ici.</p><p>Le contenu est automatiquement sauvegardé.</p>';\n  });\n  \n  // Remplacer isWysiwyg par viewMode avec 3 options\n  const [viewMode, setViewMode] = useState(() => {\n    // Force le mode 'wysiwyg' par défaut - toujours démarrer en mode visuel\n    return 'wysiwyg';\n  });\n  \n  const [currentFormat, setCurrentFormat] = useState(() => {\n    // Récupérer la police sauvegardée depuis localStorage\n    const savedFont = localStorage.getItem('editor-font') || 'system-ui, -apple-system, sans-serif';\n    return {\n      bold: false,\n      italic: false,\n      color: '#000000',\n      fontSize: '16px',\n      fontFamily: savedFont,\n      heading: null,\n      list: null\n    };\n  });\n\n  // État pour gérer l'image sélectionnée\n  const [selectedImage, setSelectedImage] = useState(null);\n\n  // Mémoriser le dernier formatage appliqué pour les débuts de ligne\n  const lastAppliedFormatRef = useRef(null);\n  \n  const editorRef = useRef(null);\n  const selectionRef = useRef(null);\n  const ignoreSelectionChangeRef = useRef(false);\n\n  // Sauvegarder la sélection\n  const saveSelection = useCallback(() => {\n    if (window.getSelection && editorRef.current) {\n      const selection = window.getSelection();\n      if (selection.rangeCount > 0) {\n        selectionRef.current = selection.getRangeAt(0).cloneRange();\n      }\n    }\n  }, []);\n\n  // Restaurer la sélection\n  const restoreSelection = useCallback(() => {\n    if (selectionRef.current && editorRef.current) {\n      const selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(selectionRef.current);\n      editorRef.current.focus();\n    }\n  }, []);\n\n  // Détecter l'état de formatage à la position du curseur\n  const updateCurrentFormat = useCallback(() => {\n    if (!editorRef.current) return;\n\n    const selection = window.getSelection();\n    if (!selection.rangeCount) return;\n\n    const range = selection.getRangeAt(0);\n    let element = range.startContainer;\n\n    // Si c'est un nœud texte, prendre le parent\n    if (element.nodeType === Node.TEXT_NODE) {\n      element = element.parentElement;\n    }\n\n    // Si pas d'élément ou curseur en début de ligne, utiliser l'état mémorisé\n    if (!element || element === editorRef.current) {\n      if (lastAppliedFormatRef.current) {\n        setCurrentFormat(lastAppliedFormatRef.current);\n        return;\n      }\n    }\n\n    // Si on vient d'appliquer un formatage Normal, le préserver\n    if (lastAppliedFormatRef.current && \n        lastAppliedFormatRef.current.heading === null && \n        lastAppliedFormatRef.current.bold === false &&\n        lastAppliedFormatRef.current.italic === false) {\n      setCurrentFormat(lastAppliedFormatRef.current);\n      return;\n    }\n\n    // Parcourir vers le haut pour trouver les styles\n    let currentElement = element;\n    const newFormat = {\n      bold: false,\n      italic: false,\n      color: '#000000',\n      fontSize: '16px',\n      fontFamily: 'system-ui',\n      heading: null,\n      list: null\n    };\n\n    while (currentElement && currentElement !== editorRef.current) {\n      const computedStyle = window.getComputedStyle(currentElement);\n      const tagName = currentElement.tagName?.toLowerCase();\n\n\n      // Vérifier les balises de formatage\n      if (tagName === 'strong' || tagName === 'b' || computedStyle.fontWeight === 'bold' || parseInt(computedStyle.fontWeight) >= 700) {\n        newFormat.bold = true;\n      }\n      if (tagName === 'em' || tagName === 'i' || computedStyle.fontStyle === 'italic') {\n        newFormat.italic = true;\n      }\n      if (tagName?.match(/^h[1-6]$/)) {\n        newFormat.heading = tagName;\n      }\n      if (tagName === 'li') {\n        // Trouver le parent ul ou ol\n        let listParent = currentElement.parentElement;\n        while (listParent && !['ul', 'ol'].includes(listParent.tagName?.toLowerCase())) {\n          listParent = listParent.parentElement;\n        }\n        if (listParent) {\n          const parentTag = listParent.tagName.toLowerCase();\n          const listStyle = listParent.style.listStyleType;\n          if (parentTag === 'ul') {\n            newFormat.list = listStyle === 'lower-alpha' ? 'letter' : 'bullet';\n          } else if (parentTag === 'ol') {\n            newFormat.list = listStyle === 'lower-alpha' ? 'letter' : 'number';\n          }\n        }\n      }\n      if (tagName === 'ul') {\n        const listStyle = currentElement.style.listStyleType;\n        newFormat.list = listStyle === 'lower-alpha' ? 'letter' : 'bullet';\n      }\n      if (tagName === 'ol') {\n        const listStyle = currentElement.style.listStyleType;\n        newFormat.list = listStyle === 'lower-alpha' ? 'letter' : 'number';\n      }\n\n      // Vérifier les styles inline et computed\n      if (currentElement.style?.color) {\n        newFormat.color = currentElement.style.color;\n      } else if (computedStyle.color && computedStyle.color !== 'rgb(0, 0, 0)') {\n        newFormat.color = computedStyle.color;\n      }\n      if (currentElement.style?.fontSize) {\n        newFormat.fontSize = currentElement.style.fontSize;\n      }\n\n      currentElement = currentElement.parentElement;\n    }\n\n    // Convertir rgb en hex si nécessaire\n    if (newFormat.color.startsWith('rgb')) {\n      newFormat.color = rgbToHex(newFormat.color);\n    }\n\n    setCurrentFormat(newFormat);\n  }, []);\n\n  // Convertir RGB en HEX\n  const rgbToHex = (rgb) => {\n    const result = rgb.match(/\\d+/g);\n    if (!result || result.length < 3) return '#000000';\n    \n    const r = parseInt(result[0]);\n    const g = parseInt(result[1]);\n    const b = parseInt(result[2]);\n    \n    return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)}`;\n  };\n\n  // Gérer les changements de contenu\n  const handleInput = useCallback((e) => {\n    if (viewMode === 'wysiwyg') {\n      setContent(e.target.innerHTML);\n      // Laisser selectionchange gérer la synchronisation\n    } else {\n      setContent(e.target.value);\n    }\n  }, [viewMode]);\n\n  // Gérer les changements de sélection\n  const handleSelectionChange = useCallback(() => {\n    if (ignoreSelectionChangeRef.current) {\n      console.log('selectionchange IGNORED');\n      return;\n    }\n    if (viewMode === 'wysiwyg' && document.activeElement === editorRef.current) {\n      console.log('selectionchange PROCESSING');\n      updateCurrentFormat();\n      saveSelection();\n    }\n  }, [viewMode, updateCurrentFormat, saveSelection]);\n\n  // Fonction pour changer de vue avec conversion automatique\n  const changeViewMode = useCallback((newMode) => {\n    if (newMode === viewMode) return;\n    \n    let newContent = content;\n    \n    // Conversions entre les vues\n    if (viewMode === 'wysiwyg' && newMode === 'markdown') {\n      newContent = htmlToMarkdown(content);\n    } else if (viewMode === 'markdown' && newMode === 'wysiwyg') {\n      newContent = markdownToHtml(content);\n    } else if (viewMode === 'html' && newMode === 'markdown') {\n      newContent = htmlToMarkdown(content);\n    } else if (viewMode === 'markdown' && newMode === 'html') {\n      newContent = markdownToHtml(content);\n    }\n    // wysiwyg -> html : nettoyer les data-attributes\n    if (viewMode === 'wysiwyg' && newMode === 'html') {\n      newContent = content.replace(/ data-type=\"[^\"]*\"/g, '')\n                         .replace(/ data-number=\"[^\"]*\"/g, '')\n                         .replace(/ data-letter=\"[^\"]*\"/g, '');\n    }\n    // html -> wysiwyg : pas de conversion nécessaire\n    \n    setContent(newContent);\n    setViewMode(newMode);\n  }, [viewMode, content]);\n\n  // Écouter les changements de sélection\n  useEffect(() => {\n    document.addEventListener('selectionchange', handleSelectionChange);\n    return () => {\n      document.removeEventListener('selectionchange', handleSelectionChange);\n    };\n  }, [handleSelectionChange]);\n\n  // Sauvegarder la police sélectionnée dans localStorage\n  useEffect(() => {\n    if (currentFormat.fontFamily) {\n      localStorage.setItem('editor-font', currentFormat.fontFamily);\n    }\n  }, [currentFormat.fontFamily]);\n\n  // Fonction pour sauvegarder l'état appliqué\n  const saveAppliedFormat = useCallback((format) => {\n    lastAppliedFormatRef.current = { ...format };\n  }, []);\n\n  // Gestionnaire pour sélectionner une image\n  const handleImageClick = useCallback((imageElement) => {\n    if (viewMode === 'wysiwyg') {\n      setSelectedImage(imageElement);\n      // Déselectionner le texte pour éviter les conflits\n      window.getSelection().removeAllRanges();\n    }\n  }, [viewMode]);\n\n  // Gestionnaire pour désélectionner l'image si clic ailleurs\n  const handleEditorClick = useCallback((e) => {\n    if (viewMode === 'wysiwyg' && selectedImage) {\n      // Si le clic n'est pas sur l'image sélectionnée, la désélectionner\n      if (e.target !== selectedImage && !selectedImage.contains(e.target)) {\n        setSelectedImage(null);\n      }\n    }\n  }, [viewMode, selectedImage]);\n\n  // Gestionnaire pour supprimer l'image sélectionnée\n  const handleDeleteSelectedImage = useCallback((e) => {\n    if (viewMode === 'wysiwyg' && selectedImage && (e.key === 'Delete' || e.key === 'Backspace')) {\n      e.preventDefault();\n      // Supprimer l'image du DOM (wrapper complet si présent)\n      const wrapper = selectedImage.closest('.resizable-image');\n      const elementToRemove = wrapper || selectedImage;\n      elementToRemove.remove();\n      setSelectedImage(null);\n      \n      // Déclencher la sauvegarde\n      if (editorRef.current) {\n        const event = new Event('input', { bubbles: true });\n        editorRef.current.dispatchEvent(event);\n      }\n    }\n  }, [viewMode, selectedImage]);\n\n  return {\n    content,\n    setContent,\n    viewMode,\n    setViewMode,\n    changeViewMode,\n    // Compatibilité avec l'ancien système\n    isWysiwyg: viewMode === 'wysiwyg',\n    setIsWysiwyg: (value) => changeViewMode(value ? 'wysiwyg' : 'html'),\n    currentFormat,\n    setCurrentFormat,\n    editorRef,\n    handleInput,\n    saveSelection,\n    restoreSelection,\n    updateCurrentFormat,\n    saveAppliedFormat,\n    ignoreSelectionChangeRef,\n    // Gestion de sélection d'images\n    selectedImage,\n    setSelectedImage,\n    handleImageClick,\n    handleEditorClick,\n    handleDeleteSelectedImage\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}