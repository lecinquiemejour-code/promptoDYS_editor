{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\JEAN-NOELLEFEBVRE-SA\\\\CascadeProjects\\\\editor\\\\src\\\\components\\\\Editor.js\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { detectBase64, applyBase64Collapse } from '../utils/base64Collapse';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Editor = ({\n  viewMode,\n  content,\n  editorRef,\n  onInput,\n  onSelectionChange,\n  currentFormat\n}) => {\n  _s();\n  // √âtat pour g√©rer l'expansion des donn√©es Base64\n  const [expandedBase64, setExpandedBase64] = useState({});\n\n  // Gestionnaire pour l'auto-redimensionnement (toujours d√©clar√©)\n  const handleTextareaResize = useCallback(textarea => {\n    if (textarea) {\n      textarea.style.height = 'auto';\n      textarea.style.height = Math.max(384, textarea.scrollHeight) + 'px';\n    }\n  }, []);\n\n  // Gestionnaire unifi√© pour tous les changements\n  const handleChange = useCallback(e => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      // Nettoyer les spans vides et les &nbsp; en trop\n      const cleanContent = html => {\n        return html.replace(/<span(?![^>]*style=\"[^\"]*color:)[^>]*>\\s*<\\/span>/g, '') // Supprimer spans vides SAUF les spans color√©s\n        .replace(/(&nbsp;\\s*){2,}/g, '&nbsp;') // R√©duire les &nbsp; multiples\n        .replace(/<font[^>]*color=\"([^\"]*)\"[^>]*>(.*?)<\\/font>/g, '<span style=\"color: $1;\">$2</span>') // Convertir font en span\n        .replace(/<b\\b[^>]*>(.*?)<\\/b>/g, '<strong>$1</strong>') // Convertir b en strong\n        .replace(/<i\\b[^>]*>(.*?)<\\/i>/g, '<em>$1</em>'); // Convertir i en em\n      };\n      const newContent = cleanContent(editorRef.current.innerHTML);\n\n      // √âviter les boucles infinies avec une v√©rification plus stricte\n      if (newContent !== content && newContent.trim() !== content.trim()) {\n        onInput({\n          target: {\n            innerHTML: newContent,\n            value: newContent\n          }\n        });\n      }\n\n      // Re-rendre MathJax apr√®s modification du contenu\n      if (window.MathJax && window.MathJax.typesetPromise) {\n        window.MathJax.typesetPromise([editorRef.current]).catch(err => {\n          console.warn('Erreur MathJax:', err);\n        });\n      }\n\n      // Mettre √† jour l'√©tat de formatage avec un d√©lai pour √©viter les conflits\n      requestAnimationFrame(() => {\n        if (document.activeElement === editorRef.current) {\n          onSelectionChange();\n        }\n      });\n    }\n  }, [viewMode, editorRef, onInput, onSelectionChange, content]);\n\n  // Gestionnaire pour les √©v√©nements de s√©lection/curseur\n  const handleSelectionChange = useCallback(() => {\n    if (viewMode === 'wysiwyg' && document.activeElement === editorRef.current) {\n      onSelectionChange();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, onSelectionChange]);\n\n  // Initialiser le contenu uniquement si n√©cessaire\n  useEffect(() => {\n    if (viewMode === 'wysiwyg' && editorRef.current && editorRef.current.innerHTML !== content) {\n      // Ne pas modifier le contenu si l'utilisateur interagit activement\n      const hasFocus = document.activeElement === editorRef.current;\n      const hasSelection = window.getSelection().rangeCount > 0;\n\n      // √âviter les mises √† jour pendant l'interaction utilisateur\n      if (hasFocus && hasSelection) {\n        return; // Ne pas perturber l'utilisateur\n      }\n\n      // Mise √† jour simple sans restauration de curseur\n      editorRef.current.innerHTML = content;\n\n      // Re-rendre MathJax apr√®s mise √† jour du contenu\n      if (window.MathJax && window.MathJax.typesetPromise) {\n        window.MathJax.typesetPromise([editorRef.current]).catch(err => {\n          console.warn('Erreur MathJax:', err);\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, content]);\n\n  // Gestionnaire pour la copie - convertir HTML en texte propre\n  const handleCopy = useCallback(e => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      const selection = window.getSelection();\n      if (selection.rangeCount > 0) {\n        const range = selection.getRangeAt(0);\n        const selectedContent = range.cloneContents();\n        const tempDiv = document.createElement('div');\n        tempDiv.appendChild(selectedContent);\n\n        // Convertir HTML en texte avec retours √† la ligne pr√©serv√©s\n        const htmlContent = tempDiv.innerHTML;\n        const textContent = htmlContent.replace(/<div[^>]*>/gi, '').replace(/<\\/div>/gi, '\\n').replace(/<br\\s*\\/?>/gi, '\\n').replace(/<p[^>]*>/gi, '').replace(/<\\/p>/gi, '\\n').replace(/<[^>]+>/g, '') // Supprimer toutes les autres balises\n        .replace(/&nbsp;/g, ' ').replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&#39;/g, \"'\").replace(/\\n+$/, ''); // Supprimer les retours √† la ligne en fin\n\n        // Mettre le texte propre dans le presse-papier\n        e.clipboardData.setData('text/plain', textContent);\n        e.preventDefault();\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode]);\n\n  // √âcouter les changements de s√©lection et la copie\n  useEffect(() => {\n    if (viewMode === 'wysiwyg') {\n      var _editorRef$current;\n      document.addEventListener('selectionchange', handleSelectionChange);\n      (_editorRef$current = editorRef.current) === null || _editorRef$current === void 0 ? void 0 : _editorRef$current.addEventListener('copy', handleCopy);\n      return () => {\n        var _editorRef$current2;\n        document.removeEventListener('selectionchange', handleSelectionChange);\n        (_editorRef$current2 = editorRef.current) === null || _editorRef$current2 === void 0 ? void 0 : _editorRef$current2.removeEventListener('copy', handleCopy);\n      };\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, handleSelectionChange, handleCopy]);\n\n  // Effect pour redimensionner au changement de contenu (toujours d√©clar√©)\n  useEffect(() => {\n    if (viewMode !== 'wysiwyg' && editorRef.current) {\n      handleTextareaResize(editorRef.current);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [content, viewMode, handleTextareaResize]);\n\n  // Vue WYSIWYG\n  if (viewMode === 'wysiwyg') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"style\", {\n        children: `\n          .editor-content h1 { \n            font-size: 2em; \n            font-weight: bold; \n            margin: 0.67em 0; \n            line-height: 1.2;\n          }\n          .editor-content h2 { \n            font-size: 1.5em; \n            font-weight: bold; \n            margin: 0.75em 0; \n            line-height: 1.3;\n          }\n          .editor-content h3 { \n            font-size: 1.17em; \n            font-weight: bold; \n            margin: 0.83em 0; \n            line-height: 1.4;\n          }\n          .editor-content p {\n            margin: 0.5em 0;\n          }\n          .editor-content ul {\n            margin: 0.5em 0;\n            padding-left: 2em;\n            list-style-type: disc;\n          }\n          .editor-content ol {\n            margin: 0.5em 0;\n            padding-left: 2em;\n            list-style-type: decimal;\n          }\n          .editor-content ol[style*=\"lower-alpha\"] {\n            list-style-type: lower-alpha;\n          }\n          .editor-content li {\n            margin: 0.25em 0;\n          }\n        `\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: editorRef,\n        contentEditable: true,\n        spellCheck: false,\n        onInput: handleChange,\n        suppressContentEditableWarning: true,\n        className: \"editor-content p-2 focus:outline-none h-full\",\n        style: {\n          fontFamily: 'var(--dys-font-family)',\n          fontSize: 'var(--dys-font-size)',\n          lineHeight: 'var(--dys-line-height)',\n          color: 'var(--dys-text-color)',\n          backgroundColor: 'var(--dys-bg-color)',\n          overflow: 'auto',\n          wordWrap: 'break-word',\n          whiteSpace: 'pre-wrap',\n          border: '1px solid #e5e7eb'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Gestionnaire pour toggle Base64\n  const handleBase64Toggle = useCallback(e => {\n    const clickedText = e.target.value;\n    const cursorPos = e.target.selectionStart;\n\n    // Chercher si on a cliqu√© sur un bouton \"üëÅÔ∏è Voir\"\n    const beforeCursor = clickedText.substring(Math.max(0, cursorPos - 100), cursorPos + 20);\n    const toggleMatch = beforeCursor.match(/üëÅÔ∏è Voir/);\n    if (toggleMatch) {\n      // Trouver l'index du Base64 correspondant\n      const base64Matches = detectBase64(content);\n\n      // Pour simplifier, on toggle le premier Base64 trouv√©\n      // Dans une version plus avanc√©e, on pourrait calculer l'index exact\n      if (base64Matches.length > 0) {\n        const toggleIndex = 0; // Simplifi√© pour cette version\n        setExpandedBase64(prev => ({\n          ...prev,\n          [toggleIndex]: !prev[toggleIndex]\n        }));\n      }\n    }\n  }, [content]);\n\n  // Fonction pour obtenir le contenu avec Base64 collaps√©s\n  const getCollapsedContent = useCallback(originalContent => {\n    if (viewMode === 'wysiwyg') {\n      return originalContent; // Pas de collapse en WYSIWYG\n    }\n    return applyBase64Collapse(originalContent, expandedBase64);\n  }, [viewMode, expandedBase64]);\n\n  // Vue Markdown\n  if (viewMode === 'markdown') {\n    const displayContent = getCollapsedContent(content);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        ref: el => {\n          editorRef.current = el;\n        },\n        value: displayContent,\n        onChange: e => {\n          // Si le contenu a √©t√© modifi√© de mani√®re significative, on utilise la nouvelle valeur\n          const newValue = e.target.value;\n          const originalWithCollapse = getCollapsedContent(content);\n          if (newValue !== originalWithCollapse) {\n            onInput({\n              ...e,\n              target: {\n                ...e.target,\n                value: newValue\n              }\n            });\n          }\n        },\n        onClick: handleBase64Toggle,\n        className: \"w-full h-full p-2 focus:outline-none resize-none\",\n        style: {\n          fontFamily: 'var(--dys-font-family)',\n          fontSize: 'var(--dys-font-size)',\n          lineHeight: 'var(--dys-line-height)',\n          color: 'var(--dys-text-color)',\n          backgroundColor: 'var(--dys-bg-color)',\n          overflow: 'auto',\n          wordWrap: 'break-word',\n          whiteSpace: 'pre-wrap',\n          border: '1px solid #e5e7eb'\n        },\n        placeholder: \"\\xC9crivez en Markdown... # Titre 1\\n## Titre 2\\n### Titre 3 **Gras** *Italique* - Liste \\xE0 puces\\n1. Liste num\\xE9rot\\xE9e\\na. Liste alphab\\xE9tique $E = mc^2$ (formule inline)\\n$$\\\\\\\\int_{-\\\\\\\\infty}^{\\\\\\\\infty} e^{-x^2} dx = \\\\\\\\sqrt{\\\\\\\\pi}$$ (formule block)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, this), detectBase64(content).length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute top-2 right-2 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\",\n        children: [\"\\uD83D\\uDCF7 \", detectBase64(content).length, \" image(s) Base64\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Fonction pour formater le HTML avec des retours √† la ligne et indentation\n  const formatHtmlForSource = html => {\n    let indentLevel = 0;\n    const indentSize = 2; // 2 espaces par niveau\n\n    return html.replace(/<br\\s*\\/?>/gi, '<br>\\n').replace(/<\\/?(h[1-6]|p|div|ul|ol|li|strong|em|span)[^>]*>/gi, match => {\n      if (match.startsWith('</')) {\n        // Balise fermante : diminuer l'indentation puis ajouter la balise\n        indentLevel = Math.max(0, indentLevel - 1);\n        return match + '\\n';\n      } else {\n        // Balise ouvrante : ajouter la balise puis augmenter l'indentation\n        const result = '\\n' + ' '.repeat(indentLevel * indentSize) + match;\n        // Augmenter l'indentation pour les balises conteneurs\n        if (match.match(/<(ul|ol|li|div|p|h[1-6])[^>]*>/i)) {\n          indentLevel++;\n        }\n        return result;\n      }\n    }).split('\\n').map((line, index) => {\n      if (index === 0) return line.trim(); // Premi√®re ligne sans indentation\n      if (line.trim() === '') return ''; // Ligne vide\n      if (line.trim().startsWith('</')) {\n        // Balise fermante : r√©duire l'indentation\n        const currentIndent = Math.max(0, indentLevel - 1);\n        return ' '.repeat(currentIndent * indentSize) + line.trim();\n      }\n      // Contenu texte : utiliser l'indentation actuelle\n      return line.startsWith(' ') ? line : ' '.repeat(indentLevel * indentSize) + line.trim();\n    }).join('\\n').replace(/^\\n+/, '') // Supprimer les retours √† la ligne en d√©but\n    .replace(/\\n{2,}/g, '\\n') // Supprimer toutes les lignes vides multiples\n    .trim();\n  };\n\n  // Vue HTML (par d√©faut)\n  const htmlDisplayContent = formatHtmlForSource(getCollapsedContent(content));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative\",\n    children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n      ref: el => {\n        editorRef.current = el;\n      },\n      value: htmlDisplayContent,\n      onChange: e => {\n        const newValue = e.target.value;\n        const originalWithCollapse = formatHtmlForSource(getCollapsedContent(content));\n        if (newValue !== originalWithCollapse) {\n          onInput({\n            ...e,\n            target: {\n              ...e.target,\n              value: newValue\n            }\n          });\n        }\n      },\n      onClick: handleBase64Toggle,\n      className: \"w-full h-full p-2 focus:outline-none resize-none\",\n      style: {\n        fontFamily: 'Monaco, \"Cascadia Code\", \"Roboto Mono\", monospace',\n        overflow: 'auto',\n        wordWrap: 'break-word',\n        whiteSpace: 'pre-wrap',\n        border: '1px solid #e5e7eb'\n      },\n      placeholder: \"Code source HTML...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 7\n    }, this), detectBase64(content).length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute top-2 right-2 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\",\n      children: [\"\\uD83D\\uDCF7 \", detectBase64(content).length, \" image(s) Base64\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 351,\n    columnNumber: 5\n  }, this);\n};\n_s(Editor, \"rFC2KbSHPE7M5PkJTKwADuEfQ8M=\");\n_c = Editor;\nexport default Editor;\nvar _c;\n$RefreshReg$(_c, \"Editor\");","map":{"version":3,"names":["React","useCallback","useEffect","useState","detectBase64","applyBase64Collapse","jsxDEV","_jsxDEV","Editor","viewMode","content","editorRef","onInput","onSelectionChange","currentFormat","_s","expandedBase64","setExpandedBase64","handleTextareaResize","textarea","style","height","Math","max","scrollHeight","handleChange","e","current","cleanContent","html","replace","newContent","innerHTML","trim","target","value","window","MathJax","typesetPromise","catch","err","console","warn","requestAnimationFrame","document","activeElement","handleSelectionChange","hasFocus","hasSelection","getSelection","rangeCount","handleCopy","selection","range","getRangeAt","selectedContent","cloneContents","tempDiv","createElement","appendChild","htmlContent","textContent","clipboardData","setData","preventDefault","_editorRef$current","addEventListener","_editorRef$current2","removeEventListener","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","contentEditable","spellCheck","suppressContentEditableWarning","className","fontFamily","fontSize","lineHeight","color","backgroundColor","overflow","wordWrap","whiteSpace","border","handleBase64Toggle","clickedText","cursorPos","selectionStart","beforeCursor","substring","toggleMatch","match","base64Matches","length","toggleIndex","prev","getCollapsedContent","originalContent","displayContent","el","onChange","newValue","originalWithCollapse","onClick","placeholder","formatHtmlForSource","indentLevel","indentSize","startsWith","result","repeat","split","map","line","index","currentIndent","join","htmlDisplayContent","_c","$RefreshReg$"],"sources":["C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/src/components/Editor.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { detectBase64, applyBase64Collapse } from '../utils/base64Collapse';\n\nconst Editor = ({ \n  viewMode,  \n  content, \n  editorRef, \n  onInput, \n  onSelectionChange,\n  currentFormat\n}) => {\n  \n  // √âtat pour g√©rer l'expansion des donn√©es Base64\n  const [expandedBase64, setExpandedBase64] = useState({});\n  \n  // Gestionnaire pour l'auto-redimensionnement (toujours d√©clar√©)\n  const handleTextareaResize = useCallback((textarea) => {\n    if (textarea) {\n      textarea.style.height = 'auto';\n      textarea.style.height = Math.max(384, textarea.scrollHeight) + 'px';\n    }\n  }, []);\n\n  // Gestionnaire unifi√© pour tous les changements\n  const handleChange = useCallback((e) => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      // Nettoyer les spans vides et les &nbsp; en trop\n      const cleanContent = (html) => {\n        return html\n          .replace(/<span(?![^>]*style=\"[^\"]*color:)[^>]*>\\s*<\\/span>/g, '') // Supprimer spans vides SAUF les spans color√©s\n          .replace(/(&nbsp;\\s*){2,}/g, '&nbsp;') // R√©duire les &nbsp; multiples\n          .replace(/<font[^>]*color=\"([^\"]*)\"[^>]*>(.*?)<\\/font>/g, '<span style=\"color: $1;\">$2</span>') // Convertir font en span\n          .replace(/<b\\b[^>]*>(.*?)<\\/b>/g, '<strong>$1</strong>') // Convertir b en strong\n          .replace(/<i\\b[^>]*>(.*?)<\\/i>/g, '<em>$1</em>'); // Convertir i en em\n      };\n      \n      const newContent = cleanContent(editorRef.current.innerHTML);\n      \n      // √âviter les boucles infinies avec une v√©rification plus stricte\n      if (newContent !== content && newContent.trim() !== content.trim()) {\n        onInput({ target: { innerHTML: newContent, value: newContent } });\n      }\n      \n      // Re-rendre MathJax apr√®s modification du contenu\n      if (window.MathJax && window.MathJax.typesetPromise) {\n        window.MathJax.typesetPromise([editorRef.current]).catch((err) => {\n          console.warn('Erreur MathJax:', err);\n        });\n      }\n      \n      // Mettre √† jour l'√©tat de formatage avec un d√©lai pour √©viter les conflits\n      requestAnimationFrame(() => {\n        if (document.activeElement === editorRef.current) {\n          onSelectionChange();\n        }\n      });\n    }\n  }, [viewMode, editorRef, onInput, onSelectionChange, content]);\n\n  // Gestionnaire pour les √©v√©nements de s√©lection/curseur\n  const handleSelectionChange = useCallback(() => {\n    if (viewMode === 'wysiwyg' && document.activeElement === editorRef.current) {\n      onSelectionChange();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, onSelectionChange]);\n\n  // Initialiser le contenu uniquement si n√©cessaire\n  useEffect(() => {\n    if (viewMode === 'wysiwyg' && editorRef.current && editorRef.current.innerHTML !== content) {\n      // Ne pas modifier le contenu si l'utilisateur interagit activement\n      const hasFocus = document.activeElement === editorRef.current;\n      const hasSelection = window.getSelection().rangeCount > 0;\n      \n      // √âviter les mises √† jour pendant l'interaction utilisateur\n      if (hasFocus && hasSelection) {\n        return; // Ne pas perturber l'utilisateur\n      }\n      \n      // Mise √† jour simple sans restauration de curseur\n      editorRef.current.innerHTML = content;\n      \n      // Re-rendre MathJax apr√®s mise √† jour du contenu\n      if (window.MathJax && window.MathJax.typesetPromise) {\n        window.MathJax.typesetPromise([editorRef.current]).catch((err) => {\n          console.warn('Erreur MathJax:', err);\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, content]);\n\n  // Gestionnaire pour la copie - convertir HTML en texte propre\n  const handleCopy = useCallback((e) => {\n    if (viewMode === 'wysiwyg' && editorRef.current) {\n      const selection = window.getSelection();\n      if (selection.rangeCount > 0) {\n        const range = selection.getRangeAt(0);\n        const selectedContent = range.cloneContents();\n        const tempDiv = document.createElement('div');\n        tempDiv.appendChild(selectedContent);\n        \n        // Convertir HTML en texte avec retours √† la ligne pr√©serv√©s\n        const htmlContent = tempDiv.innerHTML;\n        const textContent = htmlContent\n          .replace(/<div[^>]*>/gi, '')\n          .replace(/<\\/div>/gi, '\\n')\n          .replace(/<br\\s*\\/?>/gi, '\\n')\n          .replace(/<p[^>]*>/gi, '')\n          .replace(/<\\/p>/gi, '\\n')\n          .replace(/<[^>]+>/g, '') // Supprimer toutes les autres balises\n          .replace(/&nbsp;/g, ' ')\n          .replace(/&amp;/g, '&')\n          .replace(/&lt;/g, '<')\n          .replace(/&gt;/g, '>')\n          .replace(/&quot;/g, '\"')\n          .replace(/&#39;/g, \"'\")\n          .replace(/\\n+$/, ''); // Supprimer les retours √† la ligne en fin\n        \n        // Mettre le texte propre dans le presse-papier\n        e.clipboardData.setData('text/plain', textContent);\n        e.preventDefault();\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode]);\n\n  // √âcouter les changements de s√©lection et la copie\n  useEffect(() => {\n    if (viewMode === 'wysiwyg') {\n      document.addEventListener('selectionchange', handleSelectionChange);\n      editorRef.current?.addEventListener('copy', handleCopy);\n      \n      return () => {\n        document.removeEventListener('selectionchange', handleSelectionChange);\n        editorRef.current?.removeEventListener('copy', handleCopy);\n      };\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [viewMode, handleSelectionChange, handleCopy]);\n\n  // Effect pour redimensionner au changement de contenu (toujours d√©clar√©)\n  useEffect(() => {\n    if (viewMode !== 'wysiwyg' && editorRef.current) {\n      handleTextareaResize(editorRef.current);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [content, viewMode, handleTextareaResize]);\n\n  // Vue WYSIWYG\n  if (viewMode === 'wysiwyg') {\n    return (\n      <div>\n        <style>{`\n          .editor-content h1 { \n            font-size: 2em; \n            font-weight: bold; \n            margin: 0.67em 0; \n            line-height: 1.2;\n          }\n          .editor-content h2 { \n            font-size: 1.5em; \n            font-weight: bold; \n            margin: 0.75em 0; \n            line-height: 1.3;\n          }\n          .editor-content h3 { \n            font-size: 1.17em; \n            font-weight: bold; \n            margin: 0.83em 0; \n            line-height: 1.4;\n          }\n          .editor-content p {\n            margin: 0.5em 0;\n          }\n          .editor-content ul {\n            margin: 0.5em 0;\n            padding-left: 2em;\n            list-style-type: disc;\n          }\n          .editor-content ol {\n            margin: 0.5em 0;\n            padding-left: 2em;\n            list-style-type: decimal;\n          }\n          .editor-content ol[style*=\"lower-alpha\"] {\n            list-style-type: lower-alpha;\n          }\n          .editor-content li {\n            margin: 0.25em 0;\n          }\n        `}</style>\n        <div\n          ref={editorRef}\n          contentEditable\n          spellCheck={false}\n          onInput={handleChange}\n          suppressContentEditableWarning={true}\n          className=\"editor-content p-2 focus:outline-none h-full\"\n          style={{ \n            fontFamily: 'var(--dys-font-family)',\n            fontSize: 'var(--dys-font-size)',\n            lineHeight: 'var(--dys-line-height)',\n            color: 'var(--dys-text-color)',\n            backgroundColor: 'var(--dys-bg-color)',\n            overflow: 'auto',\n            wordWrap: 'break-word',\n            whiteSpace: 'pre-wrap',\n            border: '1px solid #e5e7eb'\n          }}\n        />\n      </div>\n    );\n  }\n\n  // Gestionnaire pour toggle Base64\n  const handleBase64Toggle = useCallback((e) => {\n    const clickedText = e.target.value;\n    const cursorPos = e.target.selectionStart;\n    \n    // Chercher si on a cliqu√© sur un bouton \"üëÅÔ∏è Voir\"\n    const beforeCursor = clickedText.substring(Math.max(0, cursorPos - 100), cursorPos + 20);\n    const toggleMatch = beforeCursor.match(/üëÅÔ∏è Voir/);\n    \n    if (toggleMatch) {\n      // Trouver l'index du Base64 correspondant\n      const base64Matches = detectBase64(content);\n      \n      // Pour simplifier, on toggle le premier Base64 trouv√©\n      // Dans une version plus avanc√©e, on pourrait calculer l'index exact\n      if (base64Matches.length > 0) {\n        const toggleIndex = 0; // Simplifi√© pour cette version\n        setExpandedBase64(prev => ({\n          ...prev,\n          [toggleIndex]: !prev[toggleIndex]\n        }));\n      }\n    }\n  }, [content]);\n\n  // Fonction pour obtenir le contenu avec Base64 collaps√©s\n  const getCollapsedContent = useCallback((originalContent) => {\n    if (viewMode === 'wysiwyg') {\n      return originalContent; // Pas de collapse en WYSIWYG\n    }\n    return applyBase64Collapse(originalContent, expandedBase64);\n  }, [viewMode, expandedBase64]);\n\n  // Vue Markdown\n  if (viewMode === 'markdown') {\n    const displayContent = getCollapsedContent(content);\n    \n    return (\n      <div className=\"relative\">\n        <textarea\n          ref={(el) => {\n            editorRef.current = el;\n          }}\n          value={displayContent}\n          onChange={(e) => {\n            // Si le contenu a √©t√© modifi√© de mani√®re significative, on utilise la nouvelle valeur\n            const newValue = e.target.value;\n            const originalWithCollapse = getCollapsedContent(content);\n            \n            if (newValue !== originalWithCollapse) {\n              onInput({ ...e, target: { ...e.target, value: newValue } });\n            }\n          }}\n          onClick={handleBase64Toggle}\n        className=\"w-full h-full p-2 focus:outline-none resize-none\"\n        style={{ \n          fontFamily: 'var(--dys-font-family)',\n          fontSize: 'var(--dys-font-size)',\n          lineHeight: 'var(--dys-line-height)',\n          color: 'var(--dys-text-color)',\n          backgroundColor: 'var(--dys-bg-color)',\n          overflow: 'auto',\n          wordWrap: 'break-word',\n          whiteSpace: 'pre-wrap',\n          border: '1px solid #e5e7eb'\n        }}\n        placeholder=\"√âcrivez en Markdown...\n\n# Titre 1\n## Titre 2\n### Titre 3\n\n**Gras** *Italique*\n\n- Liste √† puces\n1. Liste num√©rot√©e\na. Liste alphab√©tique\n\n$E = mc^2$ (formule inline)\n$$\\\\int_{-\\\\infty}^{\\\\infty} e^{-x^2} dx = \\\\sqrt{\\\\pi}$$ (formule block)\"\n      />\n      {/* Indicateur Base64 */}\n      {detectBase64(content).length > 0 && (\n        <div className=\"absolute top-2 right-2 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\">\n          üì∑ {detectBase64(content).length} image(s) Base64\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Fonction pour formater le HTML avec des retours √† la ligne et indentation\nconst formatHtmlForSource = (html) => {\n  let indentLevel = 0;\n  const indentSize = 2; // 2 espaces par niveau\n  \n  return html\n    .replace(/<br\\s*\\/?>/gi, '<br>\\n')\n    .replace(/<\\/?(h[1-6]|p|div|ul|ol|li|strong|em|span)[^>]*>/gi, (match) => {\n      if (match.startsWith('</')) {\n        // Balise fermante : diminuer l'indentation puis ajouter la balise\n        indentLevel = Math.max(0, indentLevel - 1);\n        return match + '\\n';\n      } else {\n        // Balise ouvrante : ajouter la balise puis augmenter l'indentation\n        const result = '\\n' + ' '.repeat(indentLevel * indentSize) + match;\n        // Augmenter l'indentation pour les balises conteneurs\n        if (match.match(/<(ul|ol|li|div|p|h[1-6])[^>]*>/i)) {\n          indentLevel++;\n        }\n        return result;\n      }\n    })\n    .split('\\n')\n    .map((line, index) => {\n      if (index === 0) return line.trim(); // Premi√®re ligne sans indentation\n      if (line.trim() === '') return ''; // Ligne vide\n      if (line.trim().startsWith('</')) {\n        // Balise fermante : r√©duire l'indentation\n        const currentIndent = Math.max(0, indentLevel - 1);\n        return ' '.repeat(currentIndent * indentSize) + line.trim();\n      }\n      // Contenu texte : utiliser l'indentation actuelle\n      return line.startsWith(' ') ? line : ' '.repeat(indentLevel * indentSize) + line.trim();\n    })\n    .join('\\n')\n    .replace(/^\\n+/, '') // Supprimer les retours √† la ligne en d√©but\n    .replace(/\\n{2,}/g, '\\n') // Supprimer toutes les lignes vides multiples\n    .trim();\n  };\n\n  // Vue HTML (par d√©faut)\n  const htmlDisplayContent = formatHtmlForSource(getCollapsedContent(content));\n  \n  return (\n    <div className=\"relative\">\n      <textarea\n        ref={(el) => {\n          editorRef.current = el;\n        }}\n        value={htmlDisplayContent}\n        onChange={(e) => {\n          const newValue = e.target.value;\n          const originalWithCollapse = formatHtmlForSource(getCollapsedContent(content));\n          \n          if (newValue !== originalWithCollapse) {\n            onInput({ ...e, target: { ...e.target, value: newValue } });\n          }\n        }}\n        onClick={handleBase64Toggle}\n        className=\"w-full h-full p-2 focus:outline-none resize-none\"\n        style={{ \n          fontFamily: 'Monaco, \"Cascadia Code\", \"Roboto Mono\", monospace',\n          overflow: 'auto',\n          wordWrap: 'break-word',\n          whiteSpace: 'pre-wrap',\n          border: '1px solid #e5e7eb'\n        }}\n        placeholder=\"Code source HTML...\"\n      />\n      {/* Indicateur Base64 */}\n      {detectBase64(content).length > 0 && (\n        <div className=\"absolute top-2 right-2 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\">\n          üì∑ {detectBase64(content).length} image(s) Base64\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Editor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}