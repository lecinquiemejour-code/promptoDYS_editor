{"ast":null,"code":"import _objectSpread from\"C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useRef,useCallback,useEffect}from'react';import{htmlToMarkdown,markdownToHtml}from'../utils/markdownConverter';export const useEditor=()=>{const[content,setContent]=useState(()=>{const savedContent=localStorage.getItem('editor-content');return savedContent||'<p>Bienvenue dans votre éditeur WYSIWYG</p><p>Commencez à écrire votre <strong>document</strong> ici.</p><p>Le contenu est automatiquement sauvegardé.</p>';});// Remplacer isWysiwyg par viewMode avec 3 options\nconst[viewMode,setViewMode]=useState(()=>{// Force le mode 'wysiwyg' par défaut - toujours démarrer en mode visuel\nreturn'wysiwyg';});const[currentFormat,setCurrentFormat]=useState(()=>{// Récupérer la police sauvegardée depuis localStorage\nconst savedFont=localStorage.getItem('editor-font')||'system-ui, -apple-system, sans-serif';return{bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:savedFont,heading:null,list:null};});// Mémoriser le dernier formatage appliqué pour les débuts de ligne\nconst lastAppliedFormatRef=useRef(null);const editorRef=useRef(null);const selectionRef=useRef(null);// Sauvegarder la sélection\nconst saveSelection=useCallback(()=>{if(window.getSelection&&editorRef.current){const selection=window.getSelection();if(selection.rangeCount>0){selectionRef.current=selection.getRangeAt(0).cloneRange();}}},[]);// Restaurer la sélection\nconst restoreSelection=useCallback(()=>{if(selectionRef.current&&editorRef.current){const selection=window.getSelection();selection.removeAllRanges();selection.addRange(selectionRef.current);editorRef.current.focus();}},[]);// Détecter l'état de formatage à la position du curseur\nconst updateCurrentFormat=useCallback(()=>{if(!editorRef.current)return;const selection=window.getSelection();if(!selection.rangeCount)return;const range=selection.getRangeAt(0);let element=range.startContainer;// Si c'est un nœud texte, prendre le parent\nif(element.nodeType===Node.TEXT_NODE){element=element.parentElement;}// Si pas d'élément ou curseur en début de ligne, utiliser l'état mémorisé\nif(!element||element===editorRef.current){if(lastAppliedFormatRef.current){setCurrentFormat(lastAppliedFormatRef.current);return;}}// Si on vient d'appliquer un formatage Normal, le préserver\nif(lastAppliedFormatRef.current&&lastAppliedFormatRef.current.heading===null&&lastAppliedFormatRef.current.bold===false&&lastAppliedFormatRef.current.italic===false){setCurrentFormat(lastAppliedFormatRef.current);return;}// Parcourir vers le haut pour trouver les styles\nlet currentElement=element;const newFormat={bold:false,italic:false,color:'#000000',fontSize:'16px',fontFamily:'system-ui',heading:null,list:null};while(currentElement&&currentElement!==editorRef.current){var _currentElement$tagNa,_currentElement$style,_currentElement$style2;const computedStyle=window.getComputedStyle(currentElement);const tagName=(_currentElement$tagNa=currentElement.tagName)===null||_currentElement$tagNa===void 0?void 0:_currentElement$tagNa.toLowerCase();// Vérifier les balises de formatage\nif(tagName==='strong'||tagName==='b'||computedStyle.fontWeight==='bold'||parseInt(computedStyle.fontWeight)>=700){newFormat.bold=true;}if(tagName==='em'||tagName==='i'||computedStyle.fontStyle==='italic'){newFormat.italic=true;}if(tagName!==null&&tagName!==void 0&&tagName.match(/^h[1-6]$/)){newFormat.heading=tagName;}if(tagName==='li'){// Trouver le parent ul ou ol\nlet listParent=currentElement.parentElement;while(listParent&&!['ul','ol'].includes((_listParent$tagName=listParent.tagName)===null||_listParent$tagName===void 0?void 0:_listParent$tagName.toLowerCase())){var _listParent$tagName;listParent=listParent.parentElement;}if(listParent){const parentTag=listParent.tagName.toLowerCase();const listStyle=listParent.style.listStyleType;if(parentTag==='ul'){newFormat.list=listStyle==='lower-alpha'?'letter':'bullet';}else if(parentTag==='ol'){newFormat.list=listStyle==='lower-alpha'?'letter':'number';}}}if(tagName==='ul'){const listStyle=currentElement.style.listStyleType;newFormat.list=listStyle==='lower-alpha'?'letter':'bullet';}if(tagName==='ol'){const listStyle=currentElement.style.listStyleType;newFormat.list=listStyle==='lower-alpha'?'letter':'number';}// Vérifier les styles inline et computed\nif((_currentElement$style=currentElement.style)!==null&&_currentElement$style!==void 0&&_currentElement$style.color){newFormat.color=currentElement.style.color;}else if(computedStyle.color&&computedStyle.color!=='rgb(0, 0, 0)'){newFormat.color=computedStyle.color;}if((_currentElement$style2=currentElement.style)!==null&&_currentElement$style2!==void 0&&_currentElement$style2.fontSize){newFormat.fontSize=currentElement.style.fontSize;}currentElement=currentElement.parentElement;}// Convertir rgb en hex si nécessaire\nif(newFormat.color.startsWith('rgb')){newFormat.color=rgbToHex(newFormat.color);}setCurrentFormat(newFormat);},[]);// Convertir RGB en HEX\nconst rgbToHex=rgb=>{const result=rgb.match(/\\d+/g);if(!result||result.length<3)return'#000000';const r=parseInt(result[0]);const g=parseInt(result[1]);const b=parseInt(result[2]);return\"#\".concat(((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1));};// Gérer les changements de contenu\nconst handleInput=useCallback(e=>{if(viewMode==='wysiwyg'){setContent(e.target.innerHTML);// Laisser selectionchange gérer la synchronisation\n}else{setContent(e.target.value);}},[viewMode]);// Gérer les changements de sélection\nconst handleSelectionChange=useCallback(()=>{if(viewMode==='wysiwyg'&&document.activeElement===editorRef.current){updateCurrentFormat();saveSelection();}},[viewMode,updateCurrentFormat,saveSelection]);// Fonction pour changer de vue avec conversion automatique\nconst changeViewMode=useCallback(newMode=>{if(newMode===viewMode)return;let newContent=content;// Conversions entre les vues\nif(viewMode==='wysiwyg'&&newMode==='markdown'){newContent=htmlToMarkdown(content);}else if(viewMode==='markdown'&&newMode==='wysiwyg'){newContent=markdownToHtml(content);}else if(viewMode==='html'&&newMode==='markdown'){newContent=htmlToMarkdown(content);}else if(viewMode==='markdown'&&newMode==='html'){newContent=markdownToHtml(content);}// wysiwyg -> html : nettoyer les data-attributes\nif(viewMode==='wysiwyg'&&newMode==='html'){newContent=content.replace(/ data-type=\"[^\"]*\"/g,'').replace(/ data-number=\"[^\"]*\"/g,'').replace(/ data-letter=\"[^\"]*\"/g,'');}// html -> wysiwyg : pas de conversion nécessaire\nsetContent(newContent);setViewMode(newMode);},[viewMode,content]);// Écouter les changements de sélection\nuseEffect(()=>{document.addEventListener('selectionchange',handleSelectionChange);return()=>{document.removeEventListener('selectionchange',handleSelectionChange);};},[handleSelectionChange]);// Sauvegarder la police sélectionnée dans localStorage\nuseEffect(()=>{if(currentFormat.fontFamily){localStorage.setItem('editor-font',currentFormat.fontFamily);}},[currentFormat.fontFamily]);// Fonction pour sauvegarder l'état appliqué\nconst saveAppliedFormat=useCallback(format=>{lastAppliedFormatRef.current=_objectSpread({},format);},[]);return{content,setContent,viewMode,setViewMode,changeViewMode,// Compatibilité avec l'ancien système\nisWysiwyg:viewMode==='wysiwyg',setIsWysiwyg:value=>changeViewMode(value?'wysiwyg':'html'),currentFormat,setCurrentFormat,editorRef,handleInput,saveSelection,restoreSelection,updateCurrentFormat,saveAppliedFormat};};","map":{"version":3,"names":["useState","useRef","useCallback","useEffect","htmlToMarkdown","markdownToHtml","useEditor","content","setContent","savedContent","localStorage","getItem","viewMode","setViewMode","currentFormat","setCurrentFormat","savedFont","bold","italic","color","fontSize","fontFamily","heading","list","lastAppliedFormatRef","editorRef","selectionRef","saveSelection","window","getSelection","current","selection","rangeCount","getRangeAt","cloneRange","restoreSelection","removeAllRanges","addRange","focus","updateCurrentFormat","range","element","startContainer","nodeType","Node","TEXT_NODE","parentElement","currentElement","newFormat","_currentElement$tagNa","_currentElement$style","_currentElement$style2","computedStyle","getComputedStyle","tagName","toLowerCase","fontWeight","parseInt","fontStyle","match","listParent","includes","_listParent$tagName","parentTag","listStyle","style","listStyleType","startsWith","rgbToHex","rgb","result","length","r","g","b","concat","toString","slice","handleInput","e","target","innerHTML","value","handleSelectionChange","document","activeElement","changeViewMode","newMode","newContent","replace","addEventListener","removeEventListener","setItem","saveAppliedFormat","format","_objectSpread","isWysiwyg","setIsWysiwyg"],"sources":["C:/Users/JEAN-NOELLEFEBVRE-SA/CascadeProjects/editor/src/hooks/useEditor.js"],"sourcesContent":["import { useState, useRef, useCallback, useEffect } from 'react';\nimport { htmlToMarkdown, markdownToHtml } from '../utils/markdownConverter';\n\nexport const useEditor = () => {\n  const [content, setContent] = useState(() => {\n    const savedContent = localStorage.getItem('editor-content');\n    return savedContent || '<p>Bienvenue dans votre éditeur WYSIWYG</p><p>Commencez à écrire votre <strong>document</strong> ici.</p><p>Le contenu est automatiquement sauvegardé.</p>';\n  });\n  \n  // Remplacer isWysiwyg par viewMode avec 3 options\n  const [viewMode, setViewMode] = useState(() => {\n    // Force le mode 'wysiwyg' par défaut - toujours démarrer en mode visuel\n    return 'wysiwyg';\n  });\n  \n  const [currentFormat, setCurrentFormat] = useState(() => {\n    // Récupérer la police sauvegardée depuis localStorage\n    const savedFont = localStorage.getItem('editor-font') || 'system-ui, -apple-system, sans-serif';\n    return {\n      bold: false,\n      italic: false,\n      color: '#000000',\n      fontSize: '16px',\n      fontFamily: savedFont,\n      heading: null,\n      list: null\n    };\n  });\n\n  // Mémoriser le dernier formatage appliqué pour les débuts de ligne\n  const lastAppliedFormatRef = useRef(null);\n  \n  const editorRef = useRef(null);\n  const selectionRef = useRef(null);\n\n  // Sauvegarder la sélection\n  const saveSelection = useCallback(() => {\n    if (window.getSelection && editorRef.current) {\n      const selection = window.getSelection();\n      if (selection.rangeCount > 0) {\n        selectionRef.current = selection.getRangeAt(0).cloneRange();\n      }\n    }\n  }, []);\n\n  // Restaurer la sélection\n  const restoreSelection = useCallback(() => {\n    if (selectionRef.current && editorRef.current) {\n      const selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(selectionRef.current);\n      editorRef.current.focus();\n    }\n  }, []);\n\n  // Détecter l'état de formatage à la position du curseur\n  const updateCurrentFormat = useCallback(() => {\n    if (!editorRef.current) return;\n\n    const selection = window.getSelection();\n    if (!selection.rangeCount) return;\n\n    const range = selection.getRangeAt(0);\n    let element = range.startContainer;\n\n    // Si c'est un nœud texte, prendre le parent\n    if (element.nodeType === Node.TEXT_NODE) {\n      element = element.parentElement;\n    }\n\n    // Si pas d'élément ou curseur en début de ligne, utiliser l'état mémorisé\n    if (!element || element === editorRef.current) {\n      if (lastAppliedFormatRef.current) {\n        setCurrentFormat(lastAppliedFormatRef.current);\n        return;\n      }\n    }\n\n    // Si on vient d'appliquer un formatage Normal, le préserver\n    if (lastAppliedFormatRef.current && \n        lastAppliedFormatRef.current.heading === null && \n        lastAppliedFormatRef.current.bold === false &&\n        lastAppliedFormatRef.current.italic === false) {\n      setCurrentFormat(lastAppliedFormatRef.current);\n      return;\n    }\n\n    // Parcourir vers le haut pour trouver les styles\n    let currentElement = element;\n    const newFormat = {\n      bold: false,\n      italic: false,\n      color: '#000000',\n      fontSize: '16px',\n      fontFamily: 'system-ui',\n      heading: null,\n      list: null\n    };\n\n    while (currentElement && currentElement !== editorRef.current) {\n      const computedStyle = window.getComputedStyle(currentElement);\n      const tagName = currentElement.tagName?.toLowerCase();\n\n\n      // Vérifier les balises de formatage\n      if (tagName === 'strong' || tagName === 'b' || computedStyle.fontWeight === 'bold' || parseInt(computedStyle.fontWeight) >= 700) {\n        newFormat.bold = true;\n      }\n      if (tagName === 'em' || tagName === 'i' || computedStyle.fontStyle === 'italic') {\n        newFormat.italic = true;\n      }\n      if (tagName?.match(/^h[1-6]$/)) {\n        newFormat.heading = tagName;\n      }\n      if (tagName === 'li') {\n        // Trouver le parent ul ou ol\n        let listParent = currentElement.parentElement;\n        while (listParent && !['ul', 'ol'].includes(listParent.tagName?.toLowerCase())) {\n          listParent = listParent.parentElement;\n        }\n        if (listParent) {\n          const parentTag = listParent.tagName.toLowerCase();\n          const listStyle = listParent.style.listStyleType;\n          if (parentTag === 'ul') {\n            newFormat.list = listStyle === 'lower-alpha' ? 'letter' : 'bullet';\n          } else if (parentTag === 'ol') {\n            newFormat.list = listStyle === 'lower-alpha' ? 'letter' : 'number';\n          }\n        }\n      }\n      if (tagName === 'ul') {\n        const listStyle = currentElement.style.listStyleType;\n        newFormat.list = listStyle === 'lower-alpha' ? 'letter' : 'bullet';\n      }\n      if (tagName === 'ol') {\n        const listStyle = currentElement.style.listStyleType;\n        newFormat.list = listStyle === 'lower-alpha' ? 'letter' : 'number';\n      }\n\n      // Vérifier les styles inline et computed\n      if (currentElement.style?.color) {\n        newFormat.color = currentElement.style.color;\n      } else if (computedStyle.color && computedStyle.color !== 'rgb(0, 0, 0)') {\n        newFormat.color = computedStyle.color;\n      }\n      if (currentElement.style?.fontSize) {\n        newFormat.fontSize = currentElement.style.fontSize;\n      }\n\n      currentElement = currentElement.parentElement;\n    }\n\n    // Convertir rgb en hex si nécessaire\n    if (newFormat.color.startsWith('rgb')) {\n      newFormat.color = rgbToHex(newFormat.color);\n    }\n\n    setCurrentFormat(newFormat);\n  }, []);\n\n  // Convertir RGB en HEX\n  const rgbToHex = (rgb) => {\n    const result = rgb.match(/\\d+/g);\n    if (!result || result.length < 3) return '#000000';\n    \n    const r = parseInt(result[0]);\n    const g = parseInt(result[1]);\n    const b = parseInt(result[2]);\n    \n    return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)}`;\n  };\n\n  // Gérer les changements de contenu\n  const handleInput = useCallback((e) => {\n    if (viewMode === 'wysiwyg') {\n      setContent(e.target.innerHTML);\n      // Laisser selectionchange gérer la synchronisation\n    } else {\n      setContent(e.target.value);\n    }\n  }, [viewMode]);\n\n  // Gérer les changements de sélection\n  const handleSelectionChange = useCallback(() => {\n    if (viewMode === 'wysiwyg' && document.activeElement === editorRef.current) {\n      updateCurrentFormat();\n      saveSelection();\n    }\n  }, [viewMode, updateCurrentFormat, saveSelection]);\n\n  // Fonction pour changer de vue avec conversion automatique\n  const changeViewMode = useCallback((newMode) => {\n    if (newMode === viewMode) return;\n    \n    let newContent = content;\n    \n    // Conversions entre les vues\n    if (viewMode === 'wysiwyg' && newMode === 'markdown') {\n      newContent = htmlToMarkdown(content);\n    } else if (viewMode === 'markdown' && newMode === 'wysiwyg') {\n      newContent = markdownToHtml(content);\n    } else if (viewMode === 'html' && newMode === 'markdown') {\n      newContent = htmlToMarkdown(content);\n    } else if (viewMode === 'markdown' && newMode === 'html') {\n      newContent = markdownToHtml(content);\n    }\n    // wysiwyg -> html : nettoyer les data-attributes\n    if (viewMode === 'wysiwyg' && newMode === 'html') {\n      newContent = content.replace(/ data-type=\"[^\"]*\"/g, '')\n                         .replace(/ data-number=\"[^\"]*\"/g, '')\n                         .replace(/ data-letter=\"[^\"]*\"/g, '');\n    }\n    // html -> wysiwyg : pas de conversion nécessaire\n    \n    setContent(newContent);\n    setViewMode(newMode);\n  }, [viewMode, content]);\n\n  // Écouter les changements de sélection\n  useEffect(() => {\n    document.addEventListener('selectionchange', handleSelectionChange);\n    return () => {\n      document.removeEventListener('selectionchange', handleSelectionChange);\n    };\n  }, [handleSelectionChange]);\n\n  // Sauvegarder la police sélectionnée dans localStorage\n  useEffect(() => {\n    if (currentFormat.fontFamily) {\n      localStorage.setItem('editor-font', currentFormat.fontFamily);\n    }\n  }, [currentFormat.fontFamily]);\n\n  // Fonction pour sauvegarder l'état appliqué\n  const saveAppliedFormat = useCallback((format) => {\n    lastAppliedFormatRef.current = { ...format };\n  }, []);\n\n  return {\n    content,\n    setContent,\n    viewMode,\n    setViewMode,\n    changeViewMode,\n    // Compatibilité avec l'ancien système\n    isWysiwyg: viewMode === 'wysiwyg',\n    setIsWysiwyg: (value) => changeViewMode(value ? 'wysiwyg' : 'html'),\n    currentFormat,\n    setCurrentFormat,\n    editorRef,\n    handleInput,\n    saveSelection,\n    restoreSelection,\n    updateCurrentFormat,\n    saveAppliedFormat\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}